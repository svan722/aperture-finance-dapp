"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9103],{98793:function(n,t,e){e.d(t,{M:function(){return r}});var i=e(62942),o=e(60152),a=e(28388),l=e(2303);let r=function(n){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{networkId:e,ammEnum:r}=(0,i.L)();return(0,l.Z)(!t&&"UNISWAP_V3"===r&&e?"position-rebalance-history-".concat(r,"-").concat(e,"-").concat(n):null,async()=>{var t;return(0,o.p)(e)&&null!==(t=await a.viem.getPositionRebalanceHistory(r,e,n,(0,o.p)(e)))&&void 0!==t?t:[]})}},83165:function(n,t,e){e.d(t,{B:function(){return h}});var i=e(62942),o=e(24002),a=e(60152),l=e(64953),r=e(9489),d=e(12948),c=e(89011),s=e(28388),u=e(33504),v=e(65195),f=e(16405),p=e(2303),m=e(45796);function h(n){let{amm:t,isChainSupported:e}=(0,i.L)(),{data:a}=(0,m.b)(n),{state:{rawAllTokenPriceMap:h}}=(0,o.jB)(),g=(0,l.mP)(),y=(0,f.useMemo)(()=>(0,u.C7)(t).map(n=>(0,c.$D)(n)),[t]),b=(0,p.Z)(g&&t&&n&&e?"user-all-chains-analytics-".concat(t.name,"-").concat(n):null,()=>(0,r.j)(y,e=>I((0,u.GP)(t),e,n))),k=(0,f.useMemo)(()=>{if(!a||!b.data||!h)return{};let n={};return y.map(t=>{let e=(0,v.keyBy)(a[t],"positionId"),i=h[t],o=s.viem.getNativeCurrency(t);n[t]=(0,v.keyBy)(b.data[t].map(n=>{var t,a,l;let r=e[n.id];return r&&(0,d.Q)(n,r,o.decimals,null==i?void 0:null===(t=i[o.wrapped.address])||void 0===t?void 0:t.price,null==i?void 0:null===(a=i[r.tokenA.address])||void 0===a?void 0:a.price,null==i?void 0:null===(l=i[r.tokenB.address])||void 0===l?void 0:l.price)}).filter(Boolean),"positionId")}),n},[a,y,b.data,h]);return{...b,data:k}}let I=async(n,t,e)=>{if(!(0,a.p)(t))return[];try{let o=[];for(let l=0;;l+=1e3){var i;let r=null!==(i=await s.viem.getPositionAnalytics(n,t,e,l,(0,a.p)(t)))&&void 0!==i?i:[],d=r.length;if(d>0&&(o=o.concat(r)),d<1e3)break}return 0===o.length&&console.log("No analytics data for wallet address ".concat(e)),o}catch(n){return console.error("fetchAnalysicsByChainId",n),[]}}},40770:function(n,t,e){e.d(t,{y:function(){return u}});var i=e(62942),o=e(89011),a=e(87066),l=e(44850),r=e.n(l),d=e(2303),c=e(17035),s=e(45796);function u(n,t){let{ammEnum:e,isChainSupported:o}=(0,i.L)(),{data:a}=(0,s.b)(t),{data:l}=(0,c.q)(t),r=n&&t&&o&&"UNISWAP_V3"===e&&(null==l?void 0:l.length)>0&&!!a;return(0,d.Z)(r?"user-all-chains-closed-lps-".concat(t):null,()=>v(t,l,a))}let v=async(n,t,e)=>{let i={};return await Promise.all(t.map(async t=>{let a=(0,o.bf)(t);if(a){let o=e[t].filter(n=>n.closed);if(o.length)for(let e=0;e<o.length;e+=500){let l=o.slice(e,e+500),r=l.map(t=>f(a,n,t.positionId));await Promise.all(r).then(n=>{let e=Object.assign({},...n);i[t]?i[t]={...i[t],...e}:i[t]=e}).catch(n=>{console.error("Error in batch",n)}),e+500<o.length&&await new Promise(n=>setTimeout(n,2e3))}}})),i};async function f(n,t,e){let i=[];for(let o=0;;o+=1e3){let l=(await a.Z.post("https://beta.archiveprotocol.com/graphql",{operationName:"partialAndFullExits",variables:{},query:'\n            query partialAndFullExits {\n              snapshotIntervalData( \n                blueprintId: "'.concat(n,'"\n                userIdentifier: "').concat(t,'"\n                positionIdentifier: "').concat(e,'"\n                first: 1000\n                skip: ').concat(o,"\n                exitRatioGte: 0.0001\n                orderDirection: DESC \n              ) \n              {\n                requestId\n                indexingStatus {\n                  headBlock\n                  lastSyncedBlock\n                }\n                items { \n                  date \n                  timestamp \n                  blockNumber \n                  positionIdentifier \n                  exitRatio \n                  exitedValueUsd \n                  exitedCollectedIncomeUsd\n                } \n              }\n            }\n          ")},{headers:{"api-key":"f818f4d5-d80d-4d6f-bf13-9806c6d8bf2f"}})).data.data.snapshotIntervalData.items,r=l.length;if(r>0&&(i=i.concat(l)),r<1e3)break}0===i.length&&console.log("No valid exit data from APY.vision for position = ".concat(e," on ").concat(n));let o={};if(o[e]={...i[0]},i.length>1){let n=i.reduce((n,t)=>r().add(n,t.exitedCollectedIncomeUsd),"0");o[e]={...o[e],exitedCollectedIncomeUsd:n}}return o}},65391:function(n,t,e){e.d(t,{i:function(){return l}});var i=e(62942),o=e(28388),a=e(2303);function l(n){var t;let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{ammEnum:o,networkId:l,publicClient:d,isChainSupported:c}=(0,i.L)(),s=!e&&"UNISWAP_V3"===o&&c&&l===(null===(t=d.chain)||void 0===t?void 0:t.id);return(0,a.Z)(s?"nft-url-".concat(l,"-").concat(n):null,()=>r(o,l,n,d))}async function r(n,t,e,i){return i.readContract({address:(0,o.getChainInfo)(t).amms[n].nonfungiblePositionManager,abi:o.ICommonNonfungiblePositionManager__factory.abi,functionName:"tokenURI",args:[BigInt(e)]})}},43805:function(n,t,e){e.d(t,{I:function(){return g}});var i=e(79570),o=e(62942),a=e(64953),l=e(48803),r=e(87076),d=e(23609),c=e(98793),s=e(83165),u=e(48747),v=e(65391),f=e(69987),p=e(5685),m=e(16405),h=e(64252);let I=n=>{var t,e,I;let{sm:g,walletAddress:y,currentChain:b,isExplorer:k,onClick:w,...P}=n,{positionId:x,chainId:C,tokenA:N,tokenB:A,tickSpacing:B,feeTier:L}=P.position,{ammEnum:S}=(0,o.L)(),[U,E]=(0,m.useState)(!1),{isLoading:_,data:j}=(0,s.B)(y),M=(0,a.mP)(),R=(0,a.JU)(),{data:T,isLoading:Z}=(0,v.i)(x,!U),{currentTokenPrice:D}=(0,r.P)(b),{positionMap:V}=(0,d.d)(y),{data:W,isLoading:q}=(0,c.M)(x,!k||!U),H="SLIPSTREAM"===S?B:L,{data:O}=(0,u.m)(N.address,A.address,[H],k&&U),F=(0,m.useMemo)(()=>{if(D&&(null==W?void 0:W.length)>0){let n=W[W.length-1];return V[n.tokenId]}},[D,C,W]),z=null==j?void 0:null===(t=j[C])||void 0===t?void 0:t[x],G=(0,h.C)(P,b,z,M),Y=k&&R?{...G,onClick:n=>E(n),overview:{...(0,l.cH)(P.position,D),nftURL:"UNISWAP_V3"===S?T:void 0,isNFTLoading:"UNISWAP_V3"===S&&Z},analytics:z?{...(0,l.Pu)(P.position,z)}:void 0,rebalanceHistoryLoading:q,rebalanceHistory:{...(0,l.fo)(P.position,F,null!=W?W:[],D,P.position.chainId)},marketPrice:null!==(I=null==O?void 0:null===(e=O[H])||void 0===e?void 0:e.tokenA)&&void 0!==I?I:"0"}:void 0;return M&&z?!_&&(k?(0,i.jsx)(p.uB,{...Y}):(0,i.jsx)(p.U1,{...G,sm:g,onClick:w})):(0,i.jsx)(f.U1m,{...G,sm:g,onClick:w})},g=(0,m.memo)(I)},92285:function(n,t,e){e.d(t,{m:function(){return p}});var i=e(92228),o=e(79570),a=e(62942),l=e(2656),r=e(85464),d=e(69987),c=e(16405),s=e(58694),u=e(43805);function v(){let n=(0,i.Z)(["\n  width: 100%;\n  min-height: 276px;\n  overflow-x: auto;\n  overflow-y: auto;\n  scrollbar-width: none;\n  gap: ",";\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  margin-top: 8px;\n\n  > div {\n    width: 100%;\n    min-width: 395px;\n  }\n"]);return v=function(){return n},n}let f=s.ZP.div.withConfig({componentId:"sc-632c0fb3-0"})(v(),n=>{let{theme:t}=n;return t.spacing.md}),p=n=>{var t;let{walletAddress:e,positions:i,stakePositionIds:s,triggerObj:v,limitOrders:p,closedPositionResults:m,isExplorer:h}=n,{networkId:I}=(0,a.L)(),{drawerOpen:g,intentDrawerOpen:y}=(0,d.yT4)(),b=y||g,[k,w]=(0,c.useState)(!1),{selected:P,setSelected:x}=(0,l.v)(r.EM.PID),C=i.length>30?400:0,N=(0,c.useRef)(null);return(0,d.YBt)(()=>{function n(){setTimeout(()=>{N.current&&w(N.current.offsetWidth<605)},C)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[b]),(0,o.jsx)(f,{ref:N,drawerOpen:b,children:i.map(n=>{var i,a,l;return(0,o.jsx)(u.I,{isExplorer:h,walletAddress:e,sm:k,position:n,currentChain:I,triggerObj:h||n.closed?void 0:null==v?void 0:v[n.chainId],limitOrder:!!(!h&&(null==p?void 0:null===(i=p[n.chainId])||void 0===i?void 0:i.includes(n.positionId)))||void 0,closedPositionResult:null==m?void 0:null===(a=m[n.chainId])||void 0===a?void 0:a[n.positionId],onClick:n=>!h&&x(n),isSelected:P==="".concat(n.chainId,"-").concat(n.positionId),atStake:null===(l=null!==(t=null==s?void 0:s[n.chainId])&&void 0!==t?t:[])||void 0===l?void 0:l.includes(n.positionIdBN)},"Position-".concat(n.positionId,"-").concat(n.chainId))})})}}}]);
//# sourceMappingURL=9103-7438cc6261c6b266.js.map