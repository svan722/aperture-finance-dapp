"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4455],{44455:function(e,t,o){o.d(t,{de:function(){return G},qo:function(){return z},z6:function(){return ef},LO:function(){return eC},TH:function(){return B},R$:function(){return ey},gC:function(){return R}});var n=o(79570),i=o(24002),r=o(62942),a=o(16405),l=o(70502);let u=(e,t)=>{let o=(0,l.$)(t);(0,a.useEffect)(()=>{e&&o()},[o,e])};var c=o(59426),d=o(69987),s=o(84401),p=o(87076),g=o(66360),f=o(48747),m=o(65195),b=o.n(m),v=o(92321),k=o(47521),h=o(28388),C=o(5112),x=o(34244),y=o.n(x),P=o(44850),A=o.n(P);function w(e,t,o,n){let i=(0,h.priceToClosestUsableTick)((0,h.parsePrice)(new C.Token(e,o[0].address,o[0].decimals,o[0].ticker,o[0].name),new C.Token(e,o[1].address,o[1].decimals,o[1].ticker,o[1].name),n),void 0,t.tickSpacing),r=t.tickLower,a=t.tickUpper,l=t.tickUpper-t.tickLower;r>i?(r=i,a=i+l):a<i&&(r=i-l,a=i);let u=(0,k.jw)(r-i),c=(0,k.jw)(a-i),d=A().subtract(A().divide(A().multiply(n,100+Number(u)),100,18),n),s=A().subtract(A().divide(A().multiply(n,100+Number(c)),100,18),n),p=A().multiply(o[0].amount,o[0].price),g=A().multiply(o[1].amount,o[1].price),f=Number(p)+Number(g),m=(0===f?50:Number(p)/f*100).toString(),b=A().subtract(100,m);return{percentLower:u,percentUpper:c,priceLower:d,priceUpper:s,ratioLower:m,ratioUpper:b,rangeWidth:l.toString()}}function T(e,t){let{baseToken:o,triggerType:n,timeBuffer:i,above:r,below:a,timeBufferChecked:l,aboveChecked:u,belowChecked:c}=e,s={sqrtPriceX96:(0,h.priceToSqrtRatioX96)(new(y())(t.tokenA.price)).toString(),...l&&{durationSec:parseFloat(A().multiply(i,3600))}},p=u&&0===o||c&&1===o,g=c&&0===o||u&&1===o;if(n===d.zng.PRICE_PERCENTAGE)return{...s,type:"RecurringPercentage",gteTickOffset:p?0===o?(0,k.Zx)(Number(r),0):-(0,k.Zx)(-Number(a),-100,0):void 0,lteTickOffset:g?0===o?(0,k.Zx)(-Number(a),-100,0):-(0,k.Zx)(Number(r),0):void 0};if(n===d.zng.PRICE)return{...s,type:"RecurringPrice",baseToken:o,gtePriceOffset:p?r:void 0,ltePriceOffset:g?A().negate(a):void 0};if(n===d.zng.RATIO){let e=((o?100-parseFloat(a):parseFloat(r))/100).toFixed(4),t=((o?100-parseFloat(r):parseFloat(a))/100).toFixed(4);return{...s,type:"RecurringRatio",gteToken0ValueProportion:p?e:void 0,lteToken0ValueProportion:g?t:void 0}}return null}function E(e,t,o){if(e&&t){let n=S(o?e:t),i=S(o?t:e);return{type:h.ActionTypeEnum.Values.RecurringDualAction,lteAction:n,gteAction:i}}return e||t||void 0}function S(e){let t=["slippage","maxGasProportion","strategyId","type"];return Object.entries(e).reduce((e,o)=>{let[n,i]=o;return t.includes(n)||(e[n]=i),e},{})}let I=a.createContext(null),B=e=>{var t;let{children:o,position:u,...d}=e,g=(0,a.useRef)({trigger:null,autoCompound:null}),{ammEnum:m,networkId:k}=(0,r.L)(),{address:h}=(0,v.m)(),{currentTokenPrice:C}=(0,p.P)(k),x=(0,a.useMemo)(()=>{var e,t;return[{...u.tokenA,price:(null==C?void 0:null===(e=C[u.tokenA.address])||void 0===e?void 0:e.price)||"0"},{...u.tokenB,price:(null==C?void 0:null===(t=C[u.tokenB.address])||void 0===t?void 0:t.price)||"0"}]},[u,C]),y="SLIPSTREAM"===m?u.tickSpacing:u.feeTier,{data:P}=(0,f.m)(x[0].address,x[1].address,[y]),A=(0,a.useMemo)(()=>{var e;return null!==(e=null==P?void 0:P[y])&&void 0!==e?e:{tokenA:"0",tokenB:"0"}},[P,y]),[w,T]=(0,a.useState)(null),[E,S]=(0,a.useState)(null),{globalSlippage:B}=(0,i.DK)(),[R,G]=(0,a.useState)(q(k,u.liquidity,B)),[M,L]=(0,a.useState)(!1),{txnSetting:N,setTxnSetting:V,resetTxnSetting:z}=function(){let{globalSlippage:e}=(0,i.DK)(),t={slippage:null!=e?e:c.wW,deadline:"30"},[o,n]=(0,a.useState)(t);return{txnSetting:o,setTxnSetting:n,resetTxnSetting:(0,a.useCallback)(()=>n(t),[])}}(),D=(0,a.useMemo)(()=>({...E,slippage:N.slippage}),[E,N.slippage]),O=(0,a.useMemo)(()=>{var e;return b().isEqual(w,null===(e=g.current.trigger)||void 0===e?void 0:e.condition)},[w]),F=(0,a.useMemo)(()=>{var e;return b().isEqual(D,null===(e=g.current.trigger)||void 0===e?void 0:e.action)},[D]),Z=(0,a.useMemo)(()=>E&&(0,c.le)(k,E.maxGasProportion,u.liquidity)||!g.current.autoCompound&&M&&(0,c.le)(k,R.action.maxGasProportion,u.liquidity),[R,M,k,u.liquidity,E]),W=(0,l.$)(e=>{var t;let o={ownerAddr:h,chainId:k,condition:w,action:D,expiration:(0,s.Ll)()};if(e)return{...o,...M&&!g.current.autoCompound&&{autoCompound:R},amm:m,nftId:u.positionId};let n={...o,taskId:null===(t=g.current.trigger)||void 0===t?void 0:t.taskId};return O&&(n.condition=void 0),F&&(n.action=void 0),n}),X=()=>{let{trigger:e,autoCompound:t}=j(u.positionId,u.chainId);(0,a.useEffect)(()=>()=>{T(null),S(null),L(!1),G(q(k,u.liquidity,B)),z()},[]),(0,a.useEffect)(()=>{if(e){g.current.trigger=e;let t=e.action;T(e.condition),S(t),V(e=>({...e,slippage:null==t?void 0:t.slippage}))}},[e]),(0,a.useEffect)(()=>{t&&(g.current.autoCompound=t,G(b().pick(t,["condition","action"])),L(!0))},[t])};return(0,n.jsx)(I.Provider,{value:{tokens:x,tokenMarketPrice:A,triggerCondition:w,setTriggerCondition:T,triggerAction:D,setTriggerAction:S,autoCompoundExists:!!g.current.autoCompound,autoCompoundError:Z,autoCompound:R,setAutoCompound:G,position:u,txnSetting:N,setTxnSetting:V,enableAutoCompound:M,setEnableAutoCompound:L,getTriggerPayload:W,isTriggerLoaded:!!(w&&E),isStrategyNotChanged:O&&F,useInit:X,taskId:null===(t=g.current.trigger)||void 0===t?void 0:t.taskId,...d},children:o})},R=()=>a.useContext(I),j=(e,t)=>{let o=(0,g.V)(e,t),n=(0,g.X)(e,t);return{trigger:o,autoCompound:n}},q=(e,t,o)=>({condition:{feeToPrincipalRatioThreshold:.05,type:"AccruedFees"},action:{maxGasProportion:(0,c.yX)(e,t),slippage:null!=o?o:c.zI,type:"Reinvest"}}),G=e=>{let{isCreate:t,bg:o}=e,{position:l,triggerAction:s,setTriggerAction:p,autoCompound:g,autoCompoundExists:f,setAutoCompound:m,enableAutoCompound:b,setEnableAutoCompound:v,autoCompoundError:k}=R(),{networkId:h}=(0,r.L)(),{globalSlippage:C,setGlobalSlippage:x}=(0,i.DK)(),[y,P]=(0,a.useState)(!1),A=null==s?void 0:s.maxGasProportion,w=g.condition.feeToPrincipalRatioThreshold,T=g.action.maxGasProportion,E=g.action.slippage;u(t,()=>{I((0,c.yX)(h,l.liquidity))});let S=()=>{v(!b)},I=(0,a.useCallback)(e=>{p(t=>({...t,maxGasProportion:e}))},[p]),B=(0,a.useCallback)(e=>{m(t=>({...t,condition:{...t.condition,feeToPrincipalRatioThreshold:e}}))},[m]),j=(0,a.useCallback)(e=>{m(t=>({...t,action:{...t.action,maxGasProportion:e}}))},[m]),q=(0,a.useCallback)(e=>{m(t=>({...t,action:{...t.action,slippage:e}}))},[m]),G=(0,a.useCallback)(e=>(0,c.ob)(h,e,l.liquidity),[h,l.liquidity]);return(0,n.jsx)(d.DDJ,{bg:o,isCreate:t,expanded:!!k,hideAutoCompound:!t&&!b,disableAutoCompound:!t||f,autoCompound:b,handleAutoCompoundChange:S,gasCeiling:{amount:l.liquidity,percentage:A,onChange:I,onError:G},acGasCeiling:{amount:l.liquidity,percentage:w,onChange:B},acMaxGasFee:{amount:l.liquidity,percentage:T,onChange:j,onError:G},acSlippage:{defaultValue:c.zI,globalValue:C,warningValue:c.NX,value:E,onSlippageChange:q,applyGlobally:y,onApplyGlobally:e=>{P(e),e&&x(e=>({...e,[h]:E}))}}})};var M=o(92228),L=o(58694);function N(){let e=(0,M.Z)(["\n  font-weight: 500;\n  color: ",";\n  background-color: ",";\n  :hover {\n    background-color: ",";\n  }\n"]);return N=function(){return e},e}let V=(0,L.ZP)(d.zxk).withConfig({componentId:"sc-33e91e9-0"})(N(),e=>{let{theme:t,black:o}=e;return o?t.colors.global.text.T1:t.colors.global.textAlt.T1},e=>{let{theme:t,black:o}=e;return o?t.colors.global.background.BG3:t.colors.global.primary},e=>{let{theme:t,black:o}=e;return o?t.colors.global.background.BG4:t.colors.global.primary}),z=e=>{let{cancelText:t="Cancel",confirmText:o="Confirm",addConfirmWrapper:i=!0,disableConfirm:r,width:a,minWidth:l,onCancel:u,onConfirm:c}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(V,{black:!0,size:"lg",variant:"contained",width:a,minWidth:l,onClick:u,children:t}),i?(0,n.jsx)(V,{variant:"contained",color:"primary",size:"lg",width:a,minWidth:l,disabled:r,onClick:c,children:o}):o]})};var D=o(45020),O=o(30990),F=o(41738),Z=o(89700),W=o(64928),X=o(8481),_=o(5685),$=o(24262),K=o(46880),U=o(88273),Y=o(12968),J=o(24408);function H(){let e=(0,M.Z)(["\n  padding: ",";\n  border-radius: ",";\n  border: 1px solid ",";\n"]);return H=function(){return e},e}function Q(){let e=(0,M.Z)(["\n  font-size: 14px;\n  line-height: 16px;\n  font-weight: 400;\n  color: ",";\n"]);return Q=function(){return e},e}let ee={timeBufferLabel:"TWAP Duration",timeBufferPopover:"Enabling TWAP (time-weight average price) on your trigger means the average price or ratio based trigger between past specified time and now must be met before the trigger executes. This helps prevent potential price manipulation and examples are for rebalancing if 1) average ETH goes above $3,500 for past 30+ mins or 2) average pool above 80% USDC for past 2+ hrs."},et=L.ZP.div.withConfig({componentId:"sc-fc5b1023-0"})(H(),e=>{let{theme:t}=e;return t.spacing.lg},e=>{let{theme:t}=e;return t.radii.md2},e=>{let{theme:t}=e;return t.colors.global.line.Line2}),eo=L.ZP.div.withConfig({componentId:"sc-fc5b1023-1"})(Q(),e=>{let{theme:t}=e;return t.colors.global.text.T1}),en=e=>{var t,o;let{editMode:i,setEditMode:c,onDeleteStrategy:s}=e,{networkId:p}=(0,r.L)(),{triggerCondition:g,triggerAction:f,tokens:m,tokenMarketPrice:b,position:v,isTriggerLoaded:C,taskId:x,setTriggerCondition:y,setTriggerAction:P}=R(),{showModal:S,hideModal:I,modalRef:B}=(0,d.ddY)(),[j,q]=(0,a.useState)(null),[G,M]=(0,a.useState)(null),[L,N]=(0,a.useState)(),[V,z]=(0,a.useState)(),D=(0,a.useMemo)(()=>Math.floor(m[0].getTokenValueProportion().mul(1e4).toNumber()),[m]),O=(0,a.useRef)(null),F=void 0!==i||void 0!==V;u(C,()=>{q(function(e){if(!e)return null;let{durationSec:t}=e,o={timeBufferChecked:void 0!==t,timeBuffer:t?(0,d._VL)(A().divide(t,3600,8)):"0"};if(e.type===h.RecurringConditionTypeEnum.Values.RecurringPercentage){let{gteTickOffset:t,lteTickOffset:n}=e;return{...o,triggerType:d.zng.PRICE_PERCENTAGE,baseToken:0,aboveChecked:void 0!==t,belowChecked:void 0!==n,below:"".concat(n?(0,k.jw)(n,!0):0),above:"".concat(t?(0,k.jw)(t,!0):0)}}if(e.type===h.RecurringConditionTypeEnum.Values.RecurringPrice){let{gtePriceOffset:t,ltePriceOffset:n}=e;return{...o,triggerType:d.zng.PRICE,baseToken:e.baseToken,aboveChecked:void 0!==t,belowChecked:void 0!==n,below:"".concat(n?A().negate(n):0),above:"".concat(null!=t?t:0)}}if(e.type===h.RecurringConditionTypeEnum.Values.RecurringRatio){let{gteToken0ValueProportion:t,lteToken0ValueProportion:n}=e;return{...o,triggerType:d.zng.RATIO,baseToken:0,aboveChecked:void 0!==t,belowChecked:void 0!==n,below:"".concat(n?Math.floor(1e4*parseFloat(n))/100:0),above:"".concat(t?Math.floor(1e4*parseFloat(t))/100:0)}}}(g))});let Z=i===K.aW.ABOVE,[W,X]=(0,a.useState)(void 0);(0,a.useEffect)(()=>{W||"0"===b.tokenA||"0"===b.tokenB||X([b.tokenA,b.tokenB])},[b.tokenA,b.tokenB,W]),(0,a.useEffect)(()=>{if(!C||!j)return;let e=j.aboveChecked&&j.belowChecked&&f.type===h.ActionTypeEnum.Values.RecurringDualAction,{slippage:t,maxGasProportion:o,strategyId:n}=f,i={...j,aboveAction:j.aboveChecked?e?(0,J.Pw)({...f.gteAction,strategyId:n,slippage:t,maxGasProportion:o}):f:void 0,belowAction:j.belowChecked?e?(0,J.Pw)({...f.lteAction,strategyId:n,slippage:t,maxGasProportion:o}):f:void 0};M(i),N(function(e){let t=[];return(null==e?void 0:e.belowChecked)&&(null==e?void 0:e.belowAction)&&t.push({...e.belowAction,id:K.aW.BELOW}),(null==e?void 0:e.aboveChecked)&&(null==e?void 0:e.aboveAction)&&t.push({...e.aboveAction,id:K.aW.ABOVE}),t}(i))},[C,j]);let _=(0,a.useMemo)(()=>{let e=d.zng.PRICE;return(null==g?void 0:g.type)==="RecurringPercentage"&&(e=d.zng.PRICE_PERCENTAGE),(null==g?void 0:g.type)==="RecurringRatio"&&(e=d.zng.RATIO),{...Y.wM,...(0,Y.oK)(D,W?W[0]:"0",m[1].decimals,!0)[e]}},[W,m]),H=(0,l.$)(e=>{let t=e.timeBufferChecked&&0===parseFloat(e.timeBuffer||"0"),o={...G,[Z?"above":"below"]:Z?e.above:e.below,[Z?"aboveAction":"belowAction"]:Z?e.aboveAction:e.belowAction,timeBufferChecked:!t&&e.timeBufferChecked,timeBuffer:e.timeBuffer};M(o);let n=T(o,v);y(e=>({...n,...(null==e?void 0:e.sqrtPriceX96)&&{sqrtPriceX96:e.sqrtPriceX96}})),P(e=>({maxGasProportion:e.maxGasProportion,slippage:e.slippage,strategyId:e.strategyId,...E(o.aboveAction,o.belowAction)}));let r=null==L?void 0:L.map(t=>t.id===i?{id:t.id,...Z?e.aboveAction:e.belowAction}:t);N(r),c(void 0),z(void 0)}),Q=(0,a.useCallback)(e=>{let t=e===K.aW.ABOVE,o={...G,[t?"above":"below"]:_[e],[t?"aboveChecked":"belowChecked"]:!1,[t?"aboveAction":"belowAction"]:void 0};M(o);let n=T(o,v);y(e=>({...n,...(null==e?void 0:e.sqrtPriceX96)&&{sqrtPriceX96:e.sqrtPriceX96}})),P(e=>({maxGasProportion:e.maxGasProportion,slippage:e.slippage,strategyId:e.strategyId,...E(o.aboveAction,o.belowAction)}));let i=L.filter(t=>t.id!==e);N(i),c(void 0),z(void 0)},[G,L,_]),en=(0,a.useCallback)(e=>{c(e)},[]),ei=(0,a.useCallback)(e=>{let t=e===K.aW.ABOVE,o={...G,[t?"aboveChecked":"belowChecked"]:!0,[t?"above":"below"]:_[e]},n=[...L,{id:e,..._[t?"aboveAction":"belowAction"]}];M(o),z(e),N(n),c(e)},[G,L,_]),er=(0,a.useCallback)(()=>{S(d.VxM,{type:d.okG.Discard_Trigger_Edit,onCancel:()=>I(),onConfirm:()=>{I(),V?Q(V):H(G)},padding:16})},[V,Q,H,I,S]),ea=(0,a.useCallback)(e=>{let t=1===L.length;t?S($.K,{onClose:()=>I(),onDelete:()=>s(),taskId:x,isDeletingLastTrigger:!0,padding:16}):S(d.VxM,{type:t?d.okG.Delete_Last_Trigger:d.okG.Delete_Trigger,onCancel:()=>I(),onConfirm:()=>{I(),Q(e)},padding:16})},[Q,S,I]),el=e=>{B.current&&B.current.contains(e.target)||(e.stopPropagation(),er())};(0,d.O8h)([O],el);let eu=(0,a.useMemo)(()=>({...G,[Z?"belowChecked":"aboveChecked"]:!1,[Z?"belowAction":"aboveAction"]:void 0,[Z?"below":"above"]:_[Z?"below":"above"]}),[G,_,i]),ec=(0,a.useMemo)(()=>w(p,v,m,b.tokenA),[p,v,m,b]);return(0,n.jsxs)(d.tuJ,{gap:"lg",children:[(0,n.jsx)(eo,{children:"Trigger Setup"}),null==L?void 0:L.map((e,t)=>void 0!==e&&(i===e.id?(0,n.jsx)(et,{ref:O,children:(0,n.jsx)(K.cm,{triggerIdx:t+1,tokens:m,tokenSpotPrice:W,tokenRatio:D,tickSpacing:v.tickSpacing,defaultAction:ec,initForm:eu,onSave:H,onDiscard:er,isAddTrigger:!!V})},e.id):(0,n.jsx)(K.tG,{disabled:F,type:e.id,triggerIdx:t+1,tokens:m,trigger:G,onEdit:()=>en(e.id),onDelete:()=>ea(e.id),onAddTrigger:()=>ei(L[0].id===K.aW.ABOVE?K.aW.BELOW:K.aW.ABOVE)},e.id))),(0,n.jsxs)(d.kCb,{alignItems:"center",justifyContent:"space-between",children:[(0,n.jsxs)(d.kCb,{alignItems:"center",children:[(0,n.jsx)(eo,{children:ee.timeBufferLabel}),(0,n.jsx)(U.uL,{content:ee.timeBufferPopover,defaultSize:{width:500},defaultPosition:{left:-90,bottom:20}})]}),(0,n.jsx)(U.$p,{align:"left",type:"number",placeholder:"0",defaultValue:null!==(o=null==G?void 0:null===(t=G.timeBuffer)||void 0===t?void 0:t.toString())&&void 0!==o?o:"0",disabled:F,onChange:e=>H({...G,timeBufferChecked:!0,timeBuffer:e}),onBlur:()=>{A().compareTo(null==G?void 0:G.timeBuffer,Y.gx)>0&&H({...G,timeBufferChecked:!0,timeBuffer:Y.gx.toString()})},ticker:A().compareTo(null==G?void 0:G.timeBuffer,1)>0?"hrs":"hr",width:200,height:36})]}),A().compareTo(null==G?void 0:G.timeBuffer,0)>0&&(0,n.jsx)(U.HX,{variant:d.PMA.WARNING,text:(0,d.BDN)()})]})};function ei(){let e=(0,M.Z)(["\n  padding-bottom: 120px;\n"]);return ei=function(){return e},e}function er(){let e=(0,M.Z)(["\n  height: ",";\n  overflow-y: scroll;\n  scrollbar-width: none;\n"]);return er=function(){return e},e}function ea(){let e=(0,M.Z)(["\n  width: ",";\n"]);return ea=function(){return e},e}function el(){let e=(0,M.Z)(["\n  padding-top: ",";\n  display: flex;\n  align-items: center;\n  width: ",";\n  justify-content: flex-end;\n  box-sizing: border-box;\n  gap: 18px;\n"]);return el=function(){return e},e}function eu(){let e=(0,M.Z)(["\n  width: 100%;\n  margin: 0;\n  border-bottom: none;\n  border: 1px solid ",";\n"]);return eu=function(){return e},e}let ec=(0,L.ZP)(d.tuJ).withConfig({componentId:"sc-9e0f95cc-0"})(ei()),ed=L.ZP.div.withConfig({componentId:"sc-9e0f95cc-1"})(er(),e=>{let{isCreate:t}=e;return t?"100%":"calc(100vh - 220px)"}),es=(0,L.ZP)(d.tuJ).withConfig({componentId:"sc-9e0f95cc-2"})(ea(),e=>{let{isCreate:t}=e;return t?"100%":d.mTC}),ep=(0,L.ZP)(d.kCb).withConfig({componentId:"sc-9e0f95cc-3"})(el(),e=>{let{isCreate:t}=e;return t?"8px":"20px"},e=>{let{isCreate:t}=e;return t?"100%":d.mTC}),eg=L.ZP.hr.withConfig({componentId:"sc-9e0f95cc-4"})(eu(),e=>{let{theme:t}=e;return t.colors.global.line.Line1}),ef=e=>{let{isCreate:t,onSave:o,onCancel:u,navBack:s}=e,{position:p,autoCompoundError:g,txnSetting:f,isStrategyNotChanged:m,setTxnSetting:b,getTriggerPayload:v,useInit:k}=R(),{networkId:h}=(0,r.L)(),{globalSlippage:C,setGlobalSlippage:x}=(0,i.DK)(),{mutate:y}=(0,W.w)();k(),(0,F.o)(()=>{u()});let{ifAuthorized:P,isAOStatusLoading:w,safeToggleAOStatus:T}=(0,i._Y)(),{isLoading:E,signAndCreateTrigger:S,signAndUpdateTrigger:I}=(0,Z.h)(),[B,j]=(0,a.useState)(!0),[q,M]=(0,a.useState)(),{mutate:L}=(0,X.F)(),{stakePool:N,staked:V,setStaked:$}=(0,O.i)(),K=(0,l.$)(async()=>{if(!P){T();return}let e=v(t);try{t?await S({payload:e,successTip:"You have successfully set up a recurring rebalance strategy for your ".concat(p.tokenA.ticker,"-").concat(p.tokenB.ticker," position.")}):await I({payload:e,successTip:"You have successfully updated a recurring rebalance strategy for your ".concat(p.tokenA.ticker,"-").concat(p.tokenB.ticker," position.")}),y(),o()}catch(e){console.log(e)}}),U=(0,a.useCallback)(()=>s(),[s]),Y=w||E,J=(0,a.useMemo)(()=>Y?(0,n.jsx)(d.$jN,{}):(t?B:!!q)?"You need to save trigger to rebalance":g||(P?t?(0,n.jsxs)(n.Fragment,{children:["Create Strategy",(0,n.jsx)(d.rPb,{hint:"Aperture charges $".concat(c.NL," + ").concat(A().multiply(c.In,100),"% of the swapped amount + ").concat(100*c.cO,"% of the reinvested amount for each rebalance."),defaultPosition:{right:-24,bottom:36}})]}):"Update Strategy":"Authorize Operator"),[Y,B,q,g,P,t]);return(0,n.jsxs)(ec,{children:[(0,n.jsx)(ed,{isCreate:t,children:(0,n.jsxs)(es,{gap:"xl",isCreate:t,children:[(0,n.jsx)(eC,{isCreate:t}),(0,n.jsx)(eg,{}),t?(0,n.jsx)(ey,{isEditing:B,toggleEdit:()=>j(!B)}):(0,n.jsx)(en,{editMode:q,setEditMode:M,onDeleteStrategy:U}),(0,n.jsx)(eg,{}),(0,n.jsx)(G,{isCreate:t,bg:_._5.global.background.BG2})]})}),(0,n.jsxs)(ep,{isCreate:t,children:[(0,n.jsx)(d.oVd,{defaultSlippage:c.wW,globalSlippage:C,warningSlippage:c.NX,dropdownPosition:"topRight",buttonSize:"small",settingsForm:f,onFormChange:b,setGlobalSlippage:e=>x(t=>({...t,[h]:e}))}),(0,n.jsx)(z,{width:t?"250px":"100%",disableConfirm:(t?B:!!q)||Y||!!g||m&&P,addConfirmWrapper:!(N&&V),confirmText:N&&V?(0,n.jsx)(D.B,{width:t?"250px":"100%",atStake:V,gaugeAddress:N.gaugeAddress,positionId:p.positionIdBN,handleTxSuccess:()=>{$(!1),L()}},p.positionId):J,onConfirm:K,onCancel:u})]})]})};var em=o(13321),eb=o(20973),ev=o(85464),ek=o(64252),eh=o(5632);let eC=e=>{let{isCreate:t}=e,o=(0,eh.useRouter)(),{setPositionPage:i}=(0,em.q)(),{tokens:r,position:l}=R(),u=(0,a.useMemo)(()=>({...function(e,t,o){let n=(0,eb.zu)(t[0].amount,t[1].amount,t[0].price,t[1].price);return{lite:o,id:e.positionId,tokens:t,feeTier:null==e?void 0:e.feeTier,priceRange:(0,ek._)(e.minPrice,e.maxPrice),liquidity:o?void 0:e.liquidity,liquidityDetails:o?{amounts:[t[0].amount,t[1].amount],percentages:[n.token0Percent,n.token1Percent]}:void 0}}(l,r,t),goToDetail:()=>ex(o,"".concat(l.chainId,"-").concat(l.positionId)),addLiquidity:()=>{i("addLP"),ex(o,"".concat(l.chainId,"-").concat(l.positionId))}}),[t,l,o,i,r]);return(0,n.jsx)(d.Gvp,{...u})};function ex(e,t){e.push({pathname:"/liquidity-management",query:{[ev.EM.PID]:t}})}let ey=e=>{let{isEditing:t,toggleEdit:o}=e,{networkId:i}=(0,r.L)(),{setTriggerCondition:l,setTriggerAction:u,tokens:c,tokenMarketPrice:s,position:p}=R(),[g,f]=(0,a.useState)(null),[m,b]=(0,a.useState)(void 0),v=(0,a.useMemo)(()=>w(i,p,c,s.tokenA),[i,p,c,s]);(0,a.useEffect)(()=>{m||"0"===s.tokenA||"0"===s.tokenB||b([s.tokenA,s.tokenB])},[s.tokenA,s.tokenB,m]);let k=(0,a.useMemo)(()=>Math.floor(c[0].getTokenValueProportion().mul(1e4).toNumber()),[c]),h=e=>{let t=e.timeBufferChecked&&0===parseFloat(e.timeBuffer||"0"),n={...e,timeBufferChecked:!t&&e.timeBufferChecked};f(n);let i=1===e.baseToken&&e.triggerType!==d.zng.PRICE,r=T(n,p);l(e=>({...r,...(null==e?void 0:e.sqrtPriceX96)&&{sqrtPriceX96:e.sqrtPriceX96}})),u(t=>({maxGasProportion:t.maxGasProportion,slippage:t.slippage,strategyId:t.strategyId,...E(e.aboveAction,e.belowAction,i)})),o()};return t?(0,n.jsx)(K.NX,{tokens:c,tokenSpotPrice:m,tokenMarketPrice:s,tickSpacing:p.tickSpacing,defaultAction:v,tokenRatio:k,onSave:h,initForm:g}):(0,n.jsx)(d.zcb,{tokens:c,trigger:g,onEdit:o})}}}]);
//# sourceMappingURL=4455-91716bb21e7487b6.js.map