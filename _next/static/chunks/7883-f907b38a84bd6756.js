(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7883],{7883:function(n,r,t){"use strict";t.d(r,{Z:function(){return W}});var e=t(22970),i=t(16405),a=t(23255),o=function(n,r){var t=r.manual,o=r.ready,u=void 0===o||o,c=r.defaultParams,s=void 0===c?[]:c,l=r.refreshDeps,f=r.refreshDepsAction,d=(0,i.useRef)(!1);return d.current=!1,(0,a.Z)(function(){!t&&u&&(d.current=!0,n.run.apply(n,(0,e.__spreadArray)([],(0,e.__read)(s),!1)))},[u]),(0,a.Z)(function(){!d.current&&(t||(d.current=!0,f?f():n.refresh()))},(0,e.__spreadArray)([],(0,e.__read)(void 0===l?[]:l),!1)),{onBefore:function(){if(!u)return{stopNow:!0}}}};function u(n,r){var t=(0,i.useRef)({deps:r,obj:void 0,initialized:!1}).current;return(!1===t.initialized||!function(n,r){if(n===r)return!0;for(var t=0;t<n.length;t++)if(!Object.is(n[t],r[t]))return!1;return!0}(t.deps,r))&&(t.deps=r,t.obj=n(),t.initialized=!0),t.obj}o.onInit=function(n){var r=n.ready;return{loading:!n.manual&&(void 0===r||r)}};var c=t(42991),s=new Map,l=function(n,r,t){var i=s.get(n);(null==i?void 0:i.timer)&&clearTimeout(i.timer);var a=void 0;r>-1&&(a=setTimeout(function(){s.delete(n)},r)),s.set(n,(0,e.__assign)((0,e.__assign)({},t),{timer:a}))},f=new Map,d=function(n,r){f.set(n,r),r.then(function(r){return f.delete(n),r}).catch(function(){f.delete(n)})},v={},p=function(n,r){v[n]&&v[n].forEach(function(n){return n(r)})},h=function(n,r){return v[n]||(v[n]=[]),v[n].push(r),function(){var t=v[n].indexOf(r);v[n].splice(t,1)}},_=function(n,r){var t=r.cacheKey,a=r.cacheTime,o=void 0===a?3e5:a,v=r.staleTime,_=void 0===v?0:v,y=r.setCache,g=r.getCache,m=(0,i.useRef)(),b=(0,i.useRef)(),w=function(n,r){y?y(r):l(n,o,r),p(n,r.data)},A=function(n,r){return(void 0===r&&(r=[]),g)?g(r):s.get(n)};return(u(function(){if(t){var r=A(t);r&&Object.hasOwnProperty.call(r,"data")&&(n.state.data=r.data,n.state.params=r.params,(-1===_||new Date().getTime()-r.time<=_)&&(n.state.loading=!1)),m.current=h(t,function(r){n.setState({data:r})})}},[]),(0,c.Z)(function(){var n;null===(n=m.current)||void 0===n||n.call(m)}),t)?{onBefore:function(n){var r=A(t,n);return r&&Object.hasOwnProperty.call(r,"data")?-1===_||new Date().getTime()-r.time<=_?{loading:!1,data:null==r?void 0:r.data,error:void 0,returnNow:!0}:{data:null==r?void 0:r.data,error:void 0}:{}},onRequest:function(n,r){var i=f.get(t);return i&&i!==b.current||(i=n.apply(void 0,(0,e.__spreadArray)([],(0,e.__read)(r),!1)),b.current=i,d(t,i)),{servicePromise:i}},onSuccess:function(r,e){var i;t&&(null===(i=m.current)||void 0===i||i.call(m),w(t,{data:r,params:e,time:new Date().getTime()}),m.current=h(t,function(r){n.setState({data:r})}))},onMutate:function(r){var e;t&&(null===(e=m.current)||void 0===e||e.call(m),w(t,{data:r,params:n.state.params,time:new Date().getTime()}),m.current=h(t,function(r){n.setState({data:r})}))}}:{}},y=t(54073),g=t.n(y),m=function(n,r){var t=r.debounceWait,a=r.debounceLeading,o=r.debounceTrailing,u=r.debounceMaxWait,c=(0,i.useRef)(),s=(0,i.useMemo)(function(){var n={};return void 0!==a&&(n.leading=a),void 0!==o&&(n.trailing=o),void 0!==u&&(n.maxWait=u),n},[a,o,u]);return((0,i.useEffect)(function(){if(t){var r=n.runAsync.bind(n);return c.current=g()(function(n){n()},t,s),n.runAsync=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return new Promise(function(t,i){var a;null===(a=c.current)||void 0===a||a.call(c,function(){r.apply(void 0,(0,e.__spreadArray)([],(0,e.__read)(n),!1)).then(t).catch(i)})})},function(){var t;null===(t=c.current)||void 0===t||t.cancel(),n.runAsync=r}}},[t,s]),t)?{onCancel:function(){var n;null===(n=c.current)||void 0===n||n.cancel()}}:{}},b=function(n,r){var t=r.loadingDelay,e=r.ready,a=(0,i.useRef)();if(!t)return{};var o=function(){a.current&&clearTimeout(a.current)};return{onBefore:function(){return o(),!1!==e&&(a.current=setTimeout(function(){n.setState({loading:!0})},t)),{loading:!1}},onFinally:function(){o()},onCancel:function(){o()}}},w=t(97154);function A(){return!w.Z||"hidden"!==document.visibilityState}var P=[];w.Z&&window.addEventListener("visibilitychange",function(){if(A())for(var n=0;n<P.length;n++)(0,P[n])()},!1);var R=function(n,r){var t=r.pollingInterval,e=r.pollingWhenHidden,o=void 0===e||e,u=r.pollingErrorRetryCount,c=void 0===u?-1:u,s=(0,i.useRef)(),l=(0,i.useRef)(),f=(0,i.useRef)(0),d=function(){var n;s.current&&clearTimeout(s.current),null===(n=l.current)||void 0===n||n.call(l)};return((0,a.Z)(function(){t||d()},[t]),t)?{onBefore:function(){d()},onError:function(){f.current+=1},onSuccess:function(){f.current=0},onFinally:function(){-1===c||-1!==c&&f.current<=c?s.current=setTimeout(function(){if(o||A())n.refresh();else{var r;l.current=(r=function(){n.refresh()},P.push(r),function(){var n=P.indexOf(r);P.splice(n,1)})}},t):f.current=0},onCancel:function(){d()}}:{}},T=[];if(w.Z){var Z=function(){if(A()&&(!w.Z||void 0===navigator.onLine||navigator.onLine))for(var n=0;n<T.length;n++)(0,T[n])()};window.addEventListener("visibilitychange",Z,!1),window.addEventListener("focus",Z,!1)}var E=function(n,r){var t=r.refreshOnWindowFocus,a=r.focusTimespan,o=void 0===a?5e3:a,u=(0,i.useRef)(),s=function(){var n;null===(n=u.current)||void 0===n||n.call(u)};return(0,i.useEffect)(function(){if(t){var r,i,a,c=(r=n.refresh.bind(n),i=!1,function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];i||(i=!0,r.apply(void 0,(0,e.__spreadArray)([],(0,e.__read)(n),!1)),setTimeout(function(){i=!1},o))});u.current=(a=function(){c()},T.push(a),function(){var n=T.indexOf(a);n>-1&&T.splice(n,1)})}return function(){s()}},[t,o]),(0,c.Z)(function(){s()}),{}},S=function(n,r){var t=r.retryInterval,e=r.retryCount,a=(0,i.useRef)(),o=(0,i.useRef)(0),u=(0,i.useRef)(!1);return e?{onBefore:function(){u.current||(o.current=0),u.current=!1,a.current&&clearTimeout(a.current)},onSuccess:function(){o.current=0},onError:function(){if(o.current+=1,-1===e||o.current<=e){var r=null!=t?t:Math.min(1e3*Math.pow(2,o.current),3e4);a.current=setTimeout(function(){u.current=!0,n.refresh()},r)}else o.current=0},onCancel:function(){o.current=0,a.current&&clearTimeout(a.current)}}:{}},C=t(12436),O=t.n(C),j=function(n,r){var t=r.throttleWait,a=r.throttleLeading,o=r.throttleTrailing,u=(0,i.useRef)(),c={};return(void 0!==a&&(c.leading=a),void 0!==o&&(c.trailing=o),(0,i.useEffect)(function(){if(t){var r=n.runAsync.bind(n);return u.current=O()(function(n){n()},t,c),n.runAsync=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return new Promise(function(t,i){var a;null===(a=u.current)||void 0===a||a.call(u,function(){r.apply(void 0,(0,e.__spreadArray)([],(0,e.__read)(n),!1)).then(t).catch(i)})})},function(){var t;n.runAsync=r,null===(t=u.current)||void 0===t||t.cancel()}}},[t,a,o]),t)?{onCancel:function(){var n;null===(n=u.current)||void 0===n||n.cancel()}}:{}},x=t(81964),H=t(79868),B=t(78922),M=t(63177),N=function(n){M.Z&&!(0,B.mf)(n)&&console.error('useMount: parameter `fn` expected to be a function, but got "'.concat(typeof n,'".')),(0,i.useEffect)(function(){null==n||n()},[])},D=function(){var n=(0,e.__read)((0,i.useState)({}),2)[1];return(0,i.useCallback)(function(){return n({})},[])},F=function(){function n(n,r,t,i){void 0===i&&(i={}),this.serviceRef=n,this.options=r,this.subscribe=t,this.initState=i,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=(0,e.__assign)((0,e.__assign)((0,e.__assign)({},this.state),{loading:!r.manual}),i)}return n.prototype.setState=function(n){void 0===n&&(n={}),this.state=(0,e.__assign)((0,e.__assign)({},this.state),n),this.subscribe()},n.prototype.runPluginHandler=function(n){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var i=this.pluginImpls.map(function(t){var i;return null===(i=t[n])||void 0===i?void 0:i.call.apply(i,(0,e.__spreadArray)([t],(0,e.__read)(r),!1))}).filter(Boolean);return Object.assign.apply(Object,(0,e.__spreadArray)([{}],(0,e.__read)(i),!1))},n.prototype.runAsync=function(){for(var n,r,t,i,a,o,u,c,s,l,f=[],d=0;d<arguments.length;d++)f[d]=arguments[d];return(0,e.__awaiter)(this,void 0,void 0,function(){var d,v,p,h,_,y,g,m,b,w,A;return(0,e.__generator)(this,function(P){switch(P.label){case 0:if(this.count+=1,d=this.count,h=void 0!==(p=(v=this.runPluginHandler("onBefore",f)).stopNow)&&p,y=void 0!==(_=v.returnNow)&&_,g=(0,e.__rest)(v,["stopNow","returnNow"]),h)return[2,new Promise(function(){})];if(this.setState((0,e.__assign)({loading:!0,params:f},g)),y)return[2,Promise.resolve(g.data)];null===(r=(n=this.options).onBefore)||void 0===r||r.call(n,f),P.label=1;case 1:return P.trys.push([1,3,,4]),(m=this.runPluginHandler("onRequest",this.serviceRef.current,f).servicePromise)||(m=(A=this.serviceRef).current.apply(A,(0,e.__spreadArray)([],(0,e.__read)(f),!1))),[4,m];case 2:if(b=P.sent(),d!==this.count)return[2,new Promise(function(){})];return this.setState({data:b,error:void 0,loading:!1}),null===(i=(t=this.options).onSuccess)||void 0===i||i.call(t,b,f),this.runPluginHandler("onSuccess",b,f),null===(o=(a=this.options).onFinally)||void 0===o||o.call(a,f,b,void 0),d===this.count&&this.runPluginHandler("onFinally",f,b,void 0),[2,b];case 3:if(w=P.sent(),d!==this.count)return[2,new Promise(function(){})];throw this.setState({error:w,loading:!1}),null===(c=(u=this.options).onError)||void 0===c||c.call(u,w,f),this.runPluginHandler("onError",w,f),null===(l=(s=this.options).onFinally)||void 0===l||l.call(s,f,void 0,w),d===this.count&&this.runPluginHandler("onFinally",f,void 0,w),w;case 4:return[2]}})})},n.prototype.run=function(){for(var n=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this.runAsync.apply(this,(0,e.__spreadArray)([],(0,e.__read)(r),!1)).catch(function(r){n.options.onError||console.error(r)})},n.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},n.prototype.refresh=function(){this.run.apply(this,(0,e.__spreadArray)([],(0,e.__read)(this.state.params||[]),!1))},n.prototype.refreshAsync=function(){return this.runAsync.apply(this,(0,e.__spreadArray)([],(0,e.__read)(this.state.params||[]),!1))},n.prototype.mutate=function(n){var r=(0,B.mf)(n)?n(this.state.data):n;this.runPluginHandler("onMutate",r),this.setState({data:r})},n}(),L=function(n,r,t){void 0===r&&(r={}),void 0===t&&(t=[]);var i=r.manual,a=void 0!==i&&i,o=(0,e.__rest)(r,["manual"]);M.Z&&r.defaultParams&&!Array.isArray(r.defaultParams)&&console.warn("expected defaultParams is array, got ".concat(typeof r.defaultParams));var s=(0,e.__assign)({manual:a},o),l=(0,x.Z)(n),f=D(),d=u(function(){var n=t.map(function(n){var r;return null===(r=null==n?void 0:n.onInit)||void 0===r?void 0:r.call(n,s)}).filter(Boolean);return new F(l,s,f,Object.assign.apply(Object,(0,e.__spreadArray)([{}],(0,e.__read)(n),!1)))},[]);return d.options=s,d.pluginImpls=t.map(function(n){return n(d,s)}),N(function(){if(!a){var n=d.state.params||r.defaultParams||[];d.run.apply(d,(0,e.__spreadArray)([],(0,e.__read)(n),!1))}}),(0,c.Z)(function(){d.cancel()}),{loading:d.state.loading,data:d.state.data,error:d.state.error,params:d.state.params||[],cancel:(0,H.Z)(d.cancel.bind(d)),refresh:(0,H.Z)(d.refresh.bind(d)),refreshAsync:(0,H.Z)(d.refreshAsync.bind(d)),run:(0,H.Z)(d.run.bind(d)),runAsync:(0,H.Z)(d.runAsync.bind(d)),mutate:(0,H.Z)(d.mutate.bind(d))}},W=function(n,r,t){return L(n,r,(0,e.__spreadArray)((0,e.__spreadArray)([],(0,e.__read)(t||[]),!1),[m,b,R,E,j,o,_,S],!1))}},12436:function(n,r,t){var e=t(54073),i=t(15942);n.exports=function(n,r,t){var a=!0,o=!0;if("function"!=typeof n)throw TypeError("Expected a function");return i(t)&&(a="leading"in t?!!t.leading:a,o="trailing"in t?!!t.trailing:o),e(n,r,{leading:a,maxWait:r,trailing:o})}}}]);
//# sourceMappingURL=7883-f907b38a84bd6756.js.map