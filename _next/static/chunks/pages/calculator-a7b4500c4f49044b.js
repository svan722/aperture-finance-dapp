(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5481],{84649:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/calculator",function(){return n(47159)}])},16312:function(e,t,n){"use strict";n.d(t,{q:function(){return u}});var l=n(24002),o=n(62942),r=n(69758),i=n(28388),a=n(70502),c=n(42732);let u=()=>{let{networkId:e}=(0,o.L)(),{mutate:t}=(0,c.u)(),{updateTokenPriceMap:n,updateTokenMap:u}=(0,l.jB)(),s=(0,a.$)(async(l,o)=>{let r=Array.isArray(o)?o:[o];u({chainId:l,tokens:r}),await n({chainId:l,tokens:r}),l===e&&await t()}),d=(0,a.$)(async(e,t)=>{let n=Array.isArray(t)?t:[t],l=await Promise.all(n.map(async t=>i.viem.getToken(t,e,(0,r.u)(e),void 0,!0)));return s(e,l)});return{mutateWarningTokens:s,mutateWarningTokensByAddress:d}}},48747:function(e,t,n){"use strict";n.d(t,{d:function(){return s},m:function(){return u}});var l=n(62942),o=n(64953),r=n(69758),i=n(5685),a=n(28388),c=n(2303);function u(e,t){var n;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],{ammEnum:a,networkId:u,publicClient:s}=(0,l.L)();"SLIPSTREAM"!==a&&(o=i.Np[a]);let g=e&&t&&a&&r&&u===(null===(n=s.chain)||void 0===n?void 0:n.id);return(0,c.Z)(g?"tokens-market-price-".concat(a,"-").concat(u,"-").concat(e,"-").concat(t):null,()=>d(a,u,e,t,o,s),{refreshInterval:3e4})}function s(e,t,n,l){var a;let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=!(arguments.length>5)||void 0===arguments[5]||arguments[5],g=(0,o.iC)(),p=(0,r.u)(t,g);"SLIPSTREAM"!==e&&(u=i.Np[e]);let m=n&&l&&e&&s&&t===(null===(a=p.chain)||void 0===a?void 0:a.id);return(0,c.Z)(m?"calc-tokens-market-price-".concat(e,"-").concat(t,"-").concat(n,"-").concat(l):null,()=>d(e,t,n,l,u,p),{refreshInterval:3e4})}async function d(e,t,n,l,o,r){let i={};return await Promise.all(o.map(async o=>{try{let c=await a.viem.getPool(n,l,o,t,e,r);i[o]=c.token0.address===n?{tokenA:c.token0Price.toFixed(18),tokenB:c.token1Price.toFixed(18)}:{tokenA:c.token1Price.toFixed(18),tokenB:c.token0Price.toFixed(18)}}catch(e){console.debug("Error: unsupported pool: ",o,e.message)}})),i}},2706:function(e,t,n){"use strict";n.d(t,{n:function(){return a}});var l=n(62942),o=n(89011),r=n(28388),i=n(2303);function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"UNISWAP_V3",a=arguments.length>3?arguments[3]:void 0,{networkId:c}=(0,l.L)(),[u,s]=[e.toLowerCase(),t.toLowerCase()].sort(),d=n&&(0,o.B2)(null!=a?a:c)&&-1===[u,s].indexOf("0x");return(0,i.Z)(d?"fee-tier-distribution-".concat(n,"-").concat(null!=a?a:c,"-").concat(u,"-").concat(s):null,()=>r.viem.getFeeTierDistribution(null!=a?a:c,n,e,t))}},47159:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ez}});var l,o,r=n(92228),i=n(79570),a=n(62942),c=n(66886),u=n(64953),s=n(69758),d=n(85464),g=n(28388),p=n(89011),m=n(64095);(l=o||(o={})).ONE_DAY="1",l.ONE_WEEK="7",l.ONE_MONTH="30",l.THREE_MONTH="90",l.ONE_YEAR="90",l.MAX="max";let h=async function(e,t){var n,l;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.ONE_MONTH,i=(0,p.$D)(t),a=(0,m.Y8)(e,i),c=await (0,g.getTokenHistoricalPricesFromCoingecko)(a,Number(r)),u=c.map(e=>({timestamp:e[0],value:e[1]}));return{tokenId:e.id,tokenName:e.name,currentPriceUSD:null!==(l=null===(n=u[u.length-1])||void 0===n?void 0:n.value)&&void 0!==l?l:1,prices:u}};var k=n(11324),v=n(59426),x=n(47574),f=n(69987),C=n(5685),P=n(16405),S=n(17963);let b=(0,P.createContext)(void 0),T=e=>{let{children:t}=e,{amm:n,network:l}=(0,a.L)(),[o,r]=(0,P.useState)(!1),{data:c}=(0,x.GB)(),{calcDex:u,calcNetwork:s,setCalcDexUrl:d,setCalcNetworkUrl:g,selectedTokenA:p,selectedTokenB:h,feeTier:k,tickLower:v,tickUpper:T,isUrlUpdated:w,setSelectedToken:j,setFeeTierUrl:N,setTickUrl:y}=(0,S.is)(c);(0,P.useEffect)(()=>{let e=(0,m.A7)(n)?n.name:m.Rr,t=(0,m.A7)(n)?l:C.rW[e][0];u||d(e),s||g(t)},[n,l,u,s,d,g]);let A=u&&(0,m.A7)(C.bl[u])?u:(0,m.A7)(n)?n.name:m.Rr,D=s&&C.rW[A].includes(s)?s:C.rW[A][0],I=C.bl[A],L=(0,f.bt3)(D),E=e=>{d(e.name)},O=e=>{g(e.id)};return(0,i.jsx)(b.Provider,{value:{selectedDex:I,handleSelectedDex:E,selectedNetwork:L,handleSelectedNetwork:O,selectedTokenA:p,selectedTokenB:h,setSelectedToken:j,poolKey:k,setPoolKeyUrl:N,tickLower:v,tickUpper:T,setTickUrl:y,isSettingChanged:w,showDetail:o,setShowDetail:r},children:t})},w=()=>{let e=(0,P.useContext)(b);if(!e)throw Error("useCalculatorContext must be used within a CalculatorProvider");return e};var j=n(70502);let N=(0,P.createContext)(void 0),y=e=>{let{children:t}=e,[n,l]=(0,P.useState)("1000"),[o,r]=(0,P.useState)(!1),[a,c]=(0,P.useState)(!1),[u,s]=(0,P.useState)(null),[d,p]=(0,P.useState)(null),[m,h]=(0,P.useState)(null),[k,v]=(0,P.useState)(0),[x,f]=(0,P.useState)(0),[S,b]=(0,P.useState)(0),[T,w]=(0,P.useState)(null),[y,A]=(0,P.useState)(null),[D,I]=(0,P.useState)(),[L,E]=(0,P.useState)(),[O,M]=(0,P.useState)(),[_,R]=(0,P.useState)(),[F,B]=(0,P.useState)(!1),[Z,U]=(0,P.useState)(null),[K,V]=(0,P.useState)(null),H=(0,P.useCallback)(()=>{I(void 0),E(void 0),s(void 0)},[]),q=(0,P.useCallback)(e=>{let{token0:t,token1:n,pool:l,sdkPool:o,poolTicks:i,volume24H:a,token0PriceChart:c,token1PriceChart:u,poolVolumes:d,positionBreakdown:g}=e;U(t),V(n),E(l),M(o),s(i),R(a),w(d),A(g),p(c),h(u),G(l,c,u),r(!1)},[]),G=(e,t,n)=>{let l=Number(e.token0Price),o=(0,C.e0)(((null==n?void 0:n.prices)||[]).map(e=>e.value),((null==t?void 0:t.prices)||[]).map(e=>e.value)),r=(0,C.gN)(o),i=(0,C.$n)(o);(null===t||null===n)&&(r=l-.3*l,i=l+.3*l),b(l),v(r),f(i)},$=(0,j.$)(()=>{(0,g.getLogger)().info("Calculator.TogglePair"),r(e=>!e),U(K),V(Z),p(m),h(d);let e={...L,token0Price:L.token1Price,token1Price:L.token0Price};E(e),b(S?1/S:0),v(1/x),f(1/k)});return(0,i.jsx)(N.Provider,{value:{isLoading:F,setIsLoading:B,selectedTokens:D,setSelectedTokens:I,pool:L,sdkPool:O,volume24H:_,depositAmount:n,setDepositAmount:l,isPairToggled:o,isFullRange:a,handleIsPairToggled:r,handleIsFullRange:c,poolTicks:u,token0PriceChart:d,token1PriceChart:m,token0:Z,token1:K,setupPair:q,priceRangeMinValue:k,priceRangeMaxValue:x,priceAssumptionValue:S,handlePriceRangeMinValue:v,handlePriceRangeMaxValue:f,handlePriceAssumptionValue:b,poolVolumes:T,handlePoolVolumes:w,positionBreakdown:y,handlePositionBreakdown:A,resetData:H,togglePair:$},children:t})},A=()=>{let e=(0,P.useContext)(N);if(!e)throw Error("useCalculatorDetailContext must be used within a CalculatorDetailProvider");return e};var D=n(45775);let I=[C.HL.ARBITRUM,C.HL.BASE],L=e=>{var t;let{addSnackbar:n}=(0,c.D)(),l=(0,u.iC)(),{amm:o,network:r}=(0,a.L)(),{selectedDex:i,selectedNetwork:x,selectedTokenA:S,selectedTokenB:b,poolKey:T,handleSelectedDex:j,handleSelectedNetwork:N,setSelectedToken:y,setPoolKeyUrl:L,setShowDetail:O}=w(),{setSelectedTokens:M,setupPair:_}=A(),[R,F]=(0,P.useState)(i||o),[B,Z]=(0,P.useState)(x||(0,C.bt)(r)),[U,K]=(0,P.useState)(),[V,H]=(0,P.useState)(),[q,G]=(0,P.useState)(),[$,W]=(0,P.useState)(!1);(0,P.useEffect)(()=>{e&&(K(S),H(b),G(T),U&&V&&q&&et())},[S,b,T]);let z=()=>{G(void 0),K(void 0),H(void 0)},Q=e=>{F(e);let t=(0,C.pU)(e)[0];Z(t),z()},X=e=>{Z(e),z()},Y=e=>{(0,v.TD)(e,V)&&H(null),K(e),G(void 0)},J=e=>{(0,v.TD)(e,U)&&K(null),H(e),G(void 0)},ee=null===(t=m.Gh[R.name])||void 0===t?void 0:t[B.id],et=async()=>{(0,g.getLogger)().info("Calculator.ClickCalculate.Start",{selectedTokenA:null==U?void 0:U.ticker,selectedTokenB:null==V?void 0:V.ticker,poolKey:q,network:null==B?void 0:B.name,exchange:null==R?void 0:R.name}),W(!0);try{let e=await Promise.all([(0,k.LP)(ee,U.address),(0,k.LP)(ee,V.address)]),t=await (0,k.R0)(ee,e[0],e[1],I.includes(B.id)),n=t.find(e=>e.feeTier==="".concat(q));if(!n)return;let o=p.ug[B.id],r=(0,s.u)(o,l),[i,a]=(0,m.xT)(e[0],e[1]),[c,u,v,x,C,P]=await Promise.all([g.viem.getPool((0,D.K)(i.id),(0,D.K)(a.id),q,o,(0,f.GPl)(R),r),(0,k.Zd)(ee,n.id),h(i,B.id),h(a,B.id),(0,k.fl)(ee,n.id),(0,k.B8)(ee,n.id)]),S=u.length?u:(0,m.fL)(i,a,n);M([i,a]),_({token0:i,token1:a,pool:n,sdkPool:c,poolTicks:S,volume24H:C,token0PriceChart:v,token1PriceChart:x,poolVolumes:P,positionBreakdown:null}),(0,g.getLogger)().info("Calculator.ClickCalculate.Success"),O(!0),j(R),N(B),y(d.cQ.TOKEN_A,U),y(d.cQ.TOKEN_B,V),L(q)}catch(i){var e;let t=i.toString().includes("Subgraph Errors"),l=null===(e=i.message)||void 0===e?void 0:e.includes("404"),o=E(i,U,V);t?n("".concat(B.name," subgraph is down, please check other networks."),"failed"):l?n("Token ".concat(o," is not supported yet, please try another token."),"failed"):n("Something went wrong, please retry later!","failed");let r=l?(0,g.getLogger)().warn:(0,g.getLogger)().error;r("Calculator.CalculateError",{error:i.toString()})}finally{W(!1)}};return{selectedDex:R,selectedNetwork:B,tokenA:U,tokenB:V,feeTier:q,isCalculating:$,handleSelectedDex:Q,handleSelectedNetwork:X,setTokenA:Y,setTokenB:J,setFeeTier:G,onCalculate:et}},E=(e,t,n)=>{var l,o;let r=null===(l=e.request)||void 0===l?void 0:l.responseURL,i=null===(o=null==r?void 0:r.match(/contract\/(0x[a-fA-F0-9]+)\//))||void 0===o?void 0:o[1],a=(0,v.TD)(t.address,i)?"".concat(t.ticker," "):(0,v.TD)(n.address,i)?"".concat(n.ticker," "):"";return a};var O=n(48747),M=n(14122),_=n(33504),R=n(44850),F=n.n(R),B=n(58694),Z=n(2706),U=n(41910);function K(){let e=(0,r.Z)(["\n  color: ",";\n"]);return K=function(){return e},e}let V=(0,B.ZP)(C.OR).withConfig({componentId:"sc-5a776432-0"})(K(),e=>{let{theme:t}=e;return t.colors.global.text.T1}),H=e=>{var t,n;let{amm:l,network:o,tokenA:r,tokenB:a,poolKey:c,setPoolKey:u,marketPrice:s,marketPriceLoading:d,disabled:g=!1,disableClick:m=!1}=e,h=(0,f.GPl)(l),{data:k}=(0,Z.n)(null!==(t=null==r?void 0:r.address)&&void 0!==t?t:"0x",null!==(n=null==a?void 0:a.address)&&void 0!==n?n:"0x",h,(0,p.$D)(o.id)),[v,x]=(0,P.useState)(!0),S=(0,P.useMemo)(()=>{let e={};return s&&Object.keys(s).forEach(t=>{e[t]=!!(null==s?void 0:s[t])}),e},[s]),b=e=>Number(Object.entries(e).reduce((e,t)=>{let[n,l]=e,[o,r]=t;return r>l?[o,r]:[n,l]},["0",0])[0]);(0,U.i)(k,()=>{let e=b(k);v&&(x(!1),c&&k[c])||u(e||void 0)});let T=(0,P.useMemo)(()=>f.Npi[h].map(e=>({key:e,label:e})),[h]);return(null==T?void 0:T.length)||!c?(null==T?void 0:T.length)===1&&c!==T[0].key&&u(T[0].key):u(void 0),(0,i.jsxs)(C.tu,{gap:"lg",children:[(0,i.jsx)(V,{children:"Fee Tier"}),(0,i.jsx)(C.UP,{disabled:g||!r||!a||d,disableClick:m,tiers:k,createdStatus:S,selected:c,onSelect:u,disableNotCreated:!0,options:T})]})},q=(0,P.memo)(H);var G=n(60152),$=n(16312),W=n(5112),z=n(92321);function Q(){let e=(0,r.Z)(["\n  color: ",";\n"]);return Q=function(){return e},e}let X=(0,B.ZP)(C.OR).withConfig({componentId:"sc-885ec341-0"})(Q(),e=>{let{theme:t}=e;return t.colors.global.text.T1}),Y=e=>{let{commonTokens:t,selectedTokenA:n,selectedTokenB:l,handleTokenASelected:o,handleTokenBSelected:r,selectedDex:a,selectedNetwork:c,disabled:d=!1,inModal:g=!1}=e,{address:m}=(0,z.m)(),{state:h,setModalState:k}=(0,C.dd)(),{isOpen:v}=h[C.yI.TOKEN_WARNING_MODAL],[S,b]=(0,P.useState)(),T=(0,p.$D)(c.id),w=(0,u.iC)(),j=(0,P.useMemo)(()=>c&&(0,s.u)(T,w),[c,T,w]),{mutateWarningTokens:N}=(0,$.q)(),y=async e=>await (0,x.lp)(e,T,j,!1,m),A=e=>{k(C.yI.TOKEN_WARNING_MODAL,e)},D={disabled:d,tokens:t,style:{width:194},inModal:g,handleUnknownAddress:y};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(C.tu,{gap:"lg",children:[(0,i.jsx)(X,{children:"Select Pair"}),(0,i.jsxs)(C.kC,{gap:"lg",children:[(0,i.jsx)(C.qJ,{selectedToken:n,onSelectToken:o,onSelectUnknownToken:e=>{b({token:e,isTokenA:!0}),A(!0)},...D},"select-token-A-".concat(null==n?void 0:n.ticker)),(0,i.jsx)(C.qJ,{selectedToken:l,onSelectToken:r,dropdownContainerStyles:{left:"unset",right:0},onSelectUnknownToken:e=>{b({token:e,isTokenA:!1}),A(!0)},...D},"select-token-B-".concat(null==l?void 0:l.ticker))]})]}),(0,i.jsx)(C.u_,{isModalOpen:v,onClose:()=>A(!1),closeIcon:!1,children:(0,i.jsx)(f.fj1,{amm:(0,f.GPl)(a),token:null==S?void 0:S.token,exploreURL:(0,G.DI)(T),cancelClick:()=>A(!1),confirmClick:e=>{(null==S?void 0:S.isTokenA)?o(e):r(e),N(T,new W.Token(T,e.address,e.decimals,e.ticker,e.name)),A(!1)}})})]})},J=(0,P.memo)(Y);function ee(){let e=(0,r.Z)(["\n  width: 380px;\n"]);return ee=function(){return e},e}function et(){let e=(0,r.Z)(["\n  color: ",";\n"]);return et=function(){return e},e}function en(){let e=(0,r.Z)(["\n  width: 400px;\n  margin-top: ",";\n  padding: ",";\n  border-radius: 15px;\n  border: ",";\n"]);return en=function(){return e},e}function el(){let e=(0,r.Z)(["\n  svg {\n    width: 16px;\n    height: 16px;\n  }\n"]);return el=function(){return e},e}let eo=(0,B.ZP)(C.tu).withConfig({componentId:"sc-23b02023-0"})(ee()),er=(0,B.ZP)(C.H2).withConfig({componentId:"sc-23b02023-1"})(et(),e=>{let{theme:t}=e;return t.colors.global.text.T1}),ei=(0,B.ZP)(eo).withConfig({componentId:"sc-23b02023-2"})(en(),e=>{let{isModal:t}=e;return"".concat(t?0:26,"px")},e=>{let{theme:t,isModal:n}=e;return n?0:t.spacing.xl},e=>{let{theme:t,isModal:n}=e;return n?"none":"1px solid ".concat(t.colors.global.line.Line1)}),ea=(0,B.ZP)(C.zx).withConfig({componentId:"sc-23b02023-3"})(el()),ec=e=>{var t,n;let{selectedDex:l,handleSelectedDex:o,selectedNetwork:r,handleSelectedNetwork:a,tokenA:c,setTokenA:u,tokenB:s,setTokenB:d,feeTier:g,setFeeTier:m,onCalculate:h,isCalculating:k=!1,isBtnDisabled:v=!1,isModal:f=!1}=e,S=Object.values(C.TM),b=(0,P.useMemo)(()=>(0,C.pU)(l),[l]),{data:T}=(0,x.GB)((0,p.$D)(r.id)),w=(0,P.useMemo)(()=>Object.values(null!=T?T:{}).sort((e,t)=>F().compareTo(t.amount,e.amount)),[T]),{data:j,isLoading:N}=(0,O.d)((0,_.GP)(l),(0,p.$D)(r.id),null!==(t=null==c?void 0:c.address)&&void 0!==t?t:null,null!==(n=null==s?void 0:s.address)&&void 0!==n?n:null);return(0,i.jsxs)(ei,{gap:"3xl",isModal:f,children:[(0,i.jsx)(er,{children:f?"Change Pool":"Aperture Calculator"}),(0,i.jsx)(C.Si,{disabled:k,options:S,selectedOption:l,onSelect:o,inModal:f}),(0,i.jsx)(C.Xu,{disabled:k,options:b,selectedOption:r,onSelect:a,inModal:f}),(0,i.jsx)(J,{disabled:k,commonTokens:w,selectedTokenA:c,selectedTokenB:s,handleTokenASelected:u,handleTokenBSelected:d,inModal:f,selectedDex:l,selectedNetwork:r}),(0,i.jsx)(q,{disabled:k,amm:l,network:r,tokenA:c,tokenB:s,poolKey:g,setPoolKey:m,marketPrice:j,marketPriceLoading:N}),(0,i.jsx)(ea,{width:"100%",variant:"primary",onClick:h,disabled:v||k,children:k?(0,i.jsx)(M.$jN,{}):"Calculate"})]})},eu=()=>{let{selectedTokenA:e,selectedTokenB:t,poolKey:n}=w(),l=!!e&&!!t&&!!n,{tokenA:o,tokenB:r,feeTier:a,...c}=L(l);return(0,i.jsx)(ec,{...c,tokenA:o,tokenB:r,feeTier:a,isBtnDisabled:!o||!r||!a||l})},es=e=>{let{onClose:t}=e,{selectedDex:n,selectedNetwork:l,selectedTokenA:o,selectedTokenB:r,poolKey:a}=w(),{selectedDex:c,selectedNetwork:u,tokenA:s,tokenB:d,feeTier:g,onCalculate:p,isCalculating:m,...h}=L(!0),k=n.name===c.name&&l.id===u.id&&(null==o?void 0:o.address)===(null==s?void 0:s.address)&&(null==r?void 0:r.address)===(null==d?void 0:d.address)&&a===g;return(0,i.jsx)(ec,{isModal:!0,...h,selectedDex:c,selectedNetwork:u,tokenA:s,tokenB:d,feeTier:g,isCalculating:m,onCalculate:()=>p().then(()=>t()),isBtnDisabled:!s||!d||!g||k})};var ed=n(17625),eg=n(82876),ep=n(90144),em=n(1473),eh=n(5632),ek=n(75282);let ev=()=>{var e,t,n,l;let{state:o,setModalState:r}=(0,C.dd)(),{isOpen:u}=o[C.yI.SWITCH_NETWORK_MODAL],s=(0,eh.useRouter)(),{token0:m,isFullRange:h,poolTicks:k,depositAmount:x,priceAssumptionValue:f,priceRangeMaxValue:P,priceRangeMinValue:S,token0PriceChart:b,token1PriceChart:T,setDepositAmount:j}=A(),{selectedTokenA:N,selectedTokenB:y,poolKey:D,selectedDex:I,selectedNetwork:L}=w(),{amm:E,network:O}=(0,a.L)(),{switchChain:M}=(0,ek.o)(),{addSnackbar:_}=(0,c.D)(),R=S,F=P,B=(null==T?void 0:T.currentPriceUSD)||1,Z=(null==b?void 0:b.currentPriceUSD)||1,U=Number(x);if(h&&k){let e=k[0],t=k[k.length-1];R=Number(e.price0),F=Number(t.price0)}let{amount0:K,amount1:V}=(0,em.tk)(f,R,F,B,Z,U),H=V*Z,q=K*B,G=(0,v.TD)(null==m?void 0:m.id,null==N?void 0:N.address)?[N,y]:[y,N],$=e=>{r(C.yI.SWITCH_NETWORK_MODAL,e)},W=()=>{s.push({pathname:"/new-position",query:{[d.cQ.TOKEN_A]:"".concat(null==N?void 0:N.address,"-").concat(null==N?void 0:N.native),[d.cQ.TOKEN_B]:"".concat(null==y?void 0:y.address,"-").concat(null==y?void 0:y.native),[d.cQ.FEE_TIER]:D}})},z=()=>{if(!N||!y)return;(0,g.getLogger)().info("Calculator.ClickCreatePosition");let e=O===L.id,t=E.name===I.name;e&&t?W():$(!0)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.sL,{defaultAmount:x,tokens:[{ticker:null===(e=G[0])||void 0===e?void 0:e.ticker,Icon:null===(t=G[0])||void 0===t?void 0:t.Icon,value:H.toFixed(2),percentage:(U>0?H/U*100:0).toFixed(2)},{ticker:null===(n=G[1])||void 0===n?void 0:n.ticker,Icon:null===(l=G[1])||void 0===l?void 0:l.Icon,value:q.toFixed(2),percentage:(U>0?q/U*100:0).toFixed(2)}],onInputChange:j,onClick:z}),(0,i.jsx)(C.u_,{isModalOpen:u,onClose:()=>$(!1),children:(0,i.jsx)(ep.u,{switchToChain:L.id,onclose:()=>{$(!1),null==M||M({chainId:(0,p.$D)(L.id)},{onSuccess:()=>W(),onError:e=>{console.log("Failed to switch network",e),(0,g.getLogger)().error("Calculator.SwitchNetworkError",{error:e.toString()}),_("Your switch network request has failed","failed")}})}})})]})},ex=()=>{let e=A(),{selectedTokenA:t,selectedTokenB:n}=w(),{token0:l,token0PriceChart:o,token1PriceChart:r}=e,{form:a,handleInputChange:c}=eC({activeDays:"0",tokenACurrentPrice:String((null==o?void 0:o.currentPriceUSD)||"0"),tokenBCurrentPrice:String((null==r?void 0:r.currentPriceUSD)||"0"),tokenAFuturePrice:String((null==o?void 0:o.currentPriceUSD)||"0"),tokenBFuturePrice:String((null==r?void 0:r.currentPriceUSD)||"0")}),{strategyA:u,strategyB:s,impermanentLoss:d,PnL:g,days:p}=ef(a,e),m=(0,v.TD)(l.id,null==t?void 0:t.address)?[t,n]:[n,t];return(0,i.jsxs)(C.tu,{gap:"lg",children:[(0,i.jsx)(C.Uk,{tokenA:m[0],tokenB:m[1],strategyA:u,strategyB:s,impermanentLoss:d,PnL:g,days:Number(a.activeDays)}),(0,i.jsx)(C.g0,{form:a,tokenA:m[0],tokenB:m[1],daysRequired:p,handleInputChange:c})]})},ef=(e,t)=>{let n,l,o,r,i;let{pool:a,volume24H:c,isPairToggled:u,token0:s,token1:d,priceRangeMaxValue:g,priceRangeMinValue:p,depositAmount:m,isFullRange:h,poolTicks:k,token1PriceChart:v,token0PriceChart:x}=t,f=[p,g],C=[Number(e.tokenACurrentPrice),Number(e.tokenBCurrentPrice)],P=[Number(e.tokenAFuturePrice),Number(e.tokenBFuturePrice)],S=Number(e.activeDays),b=Number(m),T=(e=>{let t=e[1]/e[0],n=f[0],l=f[1];if(h&&k){let e=k[0],t=k[k.length-1];n=Number(e.price0),l=Number(t.price0)}let{amount0:o,amount1:r,liquidityDelta:i}=(0,em.tk)(t,n,l,e[1],e[0],b);return{price:t,amount0:o,amount1:r,liquidityDelta:i}})(C),w=T.liquidityDelta,j=(n=P[1]/P[0],l=f[0],o=f[1],n<l&&(n=l),n>o&&(n=o),(r=w*(Math.sqrt(n)-Math.sqrt(l)))*P[0]<0&&(r=0),n<l&&(r=0),(i=w*(1/Math.sqrt(n)-1/Math.sqrt(o)))*P[1]<0&&(i=0),{price:n,amount0:i,amount1:r}),N=T.amount1*P[0],y=T.amount0*P[1],A=N+y,D=j.amount1,I=j.amount0,L=D*P[0],E=I*P[1],O=T.price,M=f[0],_=f[1],R=(null==v?void 0:v.currentPriceUSD)||1,F=(null==x?void 0:x.currentPriceUSD)||1;if(h&&k){let e=k[0],t=k[k.length-1];M=Number(e.price0),_=Number(t.price0)}let{amount0:B,amount1:Z}=(0,em.tk)(O,M,_,R,F,b),U=(0,em.D9)(O,M,_,B,Z,Number((null==s?void 0:s.decimals)||18),Number((null==d?void 0:d.decimals)||18)),K=(0,em.t0)(O,(null==s?void 0:s.decimals)||18,(null==d?void 0:d.decimals)||18);u&&(K=-K);let V=(0,em.n9)(k||[],K),H=(null==a?void 0:a.feeTier)||"",q=O>=M&&O<=_?(0,em.uQ)(U,V,c,H):0,G=q*S,$=L+E+G,W=Math.abs(A-(L+E)),z=$-A;return{strategyA:{title:"Strategy A: HODL",amountUSD:A,strategyPL:b>0?100*(A-b)/b:0,tokenA:{amt:T.amount1,amtUSD:N},tokenB:{amt:T.amount0,amtUSD:y}},strategyB:{title:"Strategy B: LP",amountUSD:$,strategyPL:b>0?100*($-b)/b:0,tokenA:{amt:D,amtUSD:L},tokenB:{amt:I,amtUSD:E},lpYield:{percentage:100*G/b,amountUSD:G}},impermanentLoss:{percentage:Math.abs(100*W/A),amountUSD:W},PnL:{percentage:100*z/A,amountUSD:z},days:q>0?W/q:0}},eC=e=>{let[t,n]=(0,P.useState)(e),l=(0,P.useCallback)((e,t)=>{n(n=>({...n,[e]:t}))},[]);return{form:t,handleInputChange:l}},eP=()=>{let{state:e,setModalState:t}=(0,C.dd)(),{isOpen:n}=e[C.yI.IMPERMANENT_LOSS_MODAL],{priceAssumptionValue:l,priceRangeMinValue:o,priceRangeMaxValue:r,depositAmount:a,isFullRange:c,poolTicks:u,token0PriceChart:s,token1PriceChart:d,isPairToggled:p,volume24H:m,pool:h,token0:k,token1:v}=A(),{selectedTokenA:x,selectedTokenB:f}=w(),S=o,b=r,T=(null==d?void 0:d.currentPriceUSD)||1,j=(null==s?void 0:s.currentPriceUSD)||1,N=Number(a);if(c&&u){let e=u[0],t=u[u.length-1];S=Number(e.price0),b=Number(t.price0)}let{amount0:y,amount1:D}=(0,em.tk)(l,S,b,T,j,N),I=(0,em.D9)(l,S,b,y,D,Number((null==k?void 0:k.decimals)||18),Number((null==v?void 0:v.decimals)||18)),L=(0,em.t0)(l,(null==k?void 0:k.decimals)||18,(null==v?void 0:v.decimals)||18);p&&(L=-L);let E=(0,P.useMemo)(()=>(0,em.n9)(u||[],L),[u,L]),O=(null==h?void 0:h.feeTier)||"",M=l>=S&&l<=b?(0,em.uQ)(I,E,m,O):0,_=e=>{t(C.yI.IMPERMANENT_LOSS_MODAL,e)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.Hb,{amount:M.toFixed(2),monthly:{value:(30*M).toFixed(2),percentage:(N>0?100*(30*M)/N:0).toFixed(2)},yearly:{value:(365*M).toFixed(2),percentage:(N?100*(365*M)/N:0).toFixed(2)},onClick:()=>{x&&f&&(_(!0),(0,g.getLogger)().info("Calculator.ClickImpermanentLoss"))}}),(0,i.jsx)(C.u_,{disableBackgroundOnClose:!0,isModalOpen:n,onClose:()=>_(!1),padding:16,children:(0,i.jsx)(ex,{})})]})},eS=()=>{let{pool:e,isFullRange:t,token0PriceChart:n,token1PriceChart:l,priceAssumptionValue:o,priceRangeMinValue:r,token0:a,token1:c,priceRangeMaxValue:u,handleIsFullRange:s,handlePriceAssumptionValue:d,handlePriceRangeMaxValue:p,handlePriceRangeMinValue:m}=A(),h=(0,C.e0)(((null==l?void 0:l.prices)||[]).map(e=>e.value),((null==n?void 0:n.prices)||[]).map(e=>e.value)),k=Number((null==e?void 0:e.token0Price)||NaN),v=(0,C.gN)(h),x=(0,C.$n)(h);(null===n||null===l)&&(v=k-.3*k,x=k+.3*k);let f=x-v,P=Math.max(0,v-f),S=x+f;return(0,i.jsx)(C.Rd,{min:P,max:S,token0Ticker:a.symbol,token1Ticker:c.symbol,isFullRange:t,minValue:r,maxValue:u,assumptionValue:o,onFullRangeToggle:e=>{s(e),(0,g.getLogger)().info("Calculator.PriceRange.ToggleFullRange",{value:e})},updateMinValue:m,updateMaxValue:p,updateAssumptionValue:d})};function eb(){let e=(0,r.Z)(["\n  transform: rotate(-90deg);\n  path {\n    fill: ",";\n  }\n"]);return eb=function(){return e},e}function eT(){let e=(0,r.Z)(["\n  path,\n  circle {\n    stroke: ",";\n  }\n"]);return eT=function(){return e},e}function ew(){let e=(0,r.Z)(["\n  height: 28px;\n  width: 28px;\n  svg {\n    height: 28px;\n    width: 28px;\n  }\n"]);return ew=function(){return e},e}function ej(){let e=(0,r.Z)(["\n  width: 178px;\n  height: 44px;\n"]);return ej=function(){return e},e}function eN(){let e=(0,r.Z)(["\n  padding-block: 8px;\n  align-items: center;\n"]);return eN=function(){return e},e}function ey(){let e=(0,r.Z)(["\n  padding-inline: 8px;\n  height: fit-content;\n  font-size: 12px;\n  line-height: 20px;\n  border-radius: ",";\n  color: ",";\n  background-color: ",";\n"]);return ey=function(){return e},e}let eA=(0,B.ZP)(ed.l7).withConfig({componentId:"sc-9c1a71f2-0"})(eb(),e=>{let{theme:t}=e;return t.colors.global.textAlt.T1}),eD=(0,B.ZP)(ed.XX).withConfig({componentId:"sc-9c1a71f2-1"})(eT(),e=>{let{theme:t}=e;return t.colors.global.textAlt.T1}),eI=B.ZP.div.withConfig({componentId:"sc-9c1a71f2-2"})(ew()),eL=(0,B.ZP)(C.zx).withConfig({componentId:"sc-9c1a71f2-3"})(ej()),eE=(0,B.ZP)(C.kC).withConfig({componentId:"sc-9c1a71f2-4"})(eN()),eO=B.ZP.div.withConfig({componentId:"sc-9c1a71f2-5"})(ey(),e=>{let{theme:t}=e;return t.radii.sm},e=>{let{theme:t}=e;return t.colors.global.textAlt.T1},e=>{let{theme:t}=e;return t.colors.global.primary}),eM=()=>{let e=(0,B.Fg)(),{state:t,setModalState:n}=(0,C.dd)(),{isOpen:l}=t[C.yI.CHANGE_POOL_MODAL],{selectedDex:o,selectedNetwork:r,poolKey:a,handleSelectedDex:c,handleSelectedNetwork:u,setPoolKeyUrl:s,selectedTokenA:h,selectedTokenB:x,setSelectedToken:S,showDetail:b,setShowDetail:T}=w(),{togglePair:j,token0:N,token1:y,isPairToggled:D,isFullRange:I,sdkPool:L,poolTicks:E,token0PriceChart:O,token1PriceChart:M,priceRangeMinValue:_,priceRangeMaxValue:R,priceAssumptionValue:F,depositAmount:Z,poolVolumes:U,positionBreakdown:K,handlePositionBreakdown:V,resetData:H}=A(),q=(0,P.useMemo)(()=>E.map(e=>({...e,tickIdx:Number(e.tickIdx),liquidityNet:Number(e.liquidityNet)})),[E]);(0,P.useEffect)(()=>{(0,g.getLogger)().debug("InvariantFailed",{networkId:p.ug[r.id],sdkPool:L,priceAssumptionValue:F,priceRangeMinValue:I?0:_,priceRangeMaxValue:I?1e18:R,token0CurrentPrice:(null==O?void 0:O.currentPriceUSD)||1,token1CurrentPrice:(null==M?void 0:M.currentPriceUSD)||1,depositAmount:Z,token0:N,token1:y}),(0,k.d0)(p.ug[r.id],L,F,I?0:_,I?1e18:R,(null==O?void 0:O.currentPriceUSD)||1,(null==M?void 0:M.currentPriceUSD)||1,Z,N,y).then(e=>{V(e)})},[I,_,R,F]);let G=(0,eg.useSearchParams)(),$=G.get(d.cQ.CALC_NETWORK),W=G.get(d.cQ.CALC_DEX);if(b&&(!W||!$)){T(!1),c(o),u(r),S(d.cQ.TOKEN_A,null),S(d.cQ.TOKEN_B,null),s(void 0),H();return}let z=(0,m.fo)(N,O),Q=(0,m.fo)(y,M),X=(0,v.TD)(N.id,null==h?void 0:h.address)?[x,h]:[h,x],Y=e=>{n(C.yI.CHANGE_POOL_MODAL,e)},{Icon:J}=o;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(C.kC,{gap:"7xl",children:[(0,i.jsxs)(C.tu,{gap:20,children:[(0,i.jsxs)(eE,{gap:"md",children:[(0,i.jsxs)(C.kC,{gap:"sm2",alignItems:"center",children:[h&&x?(0,i.jsx)(f.FHk,{tokens:X,feeTier:a,size:28,titleSize:"lg2",padding:"0px 8px",fontSize:"12px",lineHeight:"20px",iconGap:12,tagGap:20,color:e.colors.global.textAlt.T1}):(0,i.jsx)(C.jx,{size:"180px",height:"28.13px"}),(0,i.jsx)(eO,{children:r.name})]}),(0,i.jsx)(eI,{children:(0,i.jsx)(J,{})})]}),(0,i.jsx)(eP,{}),(0,i.jsx)(ev,{}),(0,i.jsx)(eS,{})]}),(0,i.jsxs)(C.tu,{gap:20,children:[(0,i.jsxs)(C.kC,{gap:"lg",justifyContent:"flex-end",children:[(0,i.jsx)(eL,{variant:"primary",size:"lg",iconGap:10,iconPosition:"start",icon:(0,i.jsx)(eA,{}),onClick:j,children:"Toggle Pair"}),(0,i.jsx)(eL,{variant:"secondary",size:"lg",iconGap:10,iconPosition:"start",icon:(0,i.jsx)(eD,{}),onClick:()=>{Y(!0),(0,g.getLogger)().info("Calculator.ClickChangePool")},children:"Change Pool"})]}),(0,i.jsx)(C.k$,{isPairToggled:D,isFullRange:I,poolTicks:q,token0:z,token1:Q,token0PriceChart:O.prices,token1PriceChart:M.prices,priceRangeValue:[_,R],priceAssumptionValue:F}),(0,i.jsx)(C.VE,{isFullRange:I,token0:z,token1:Q,token0PriceChart:O.prices,token1PriceChart:M.prices,priceRangeValue:[_,R],priceAssumptionValue:F,poolDayDatas:U}),(0,i.jsx)(C.ep,{isFullRange:I,token0:z,token1:Q,token0PriceChart:O.prices,token1PriceChart:M.prices,priceRangeValue:[_,R],priceAssumptionValue:F,positionBreakDown:K})]})]}),(0,i.jsx)(C.u_,{disableBackgroundOnClose:!0,isModalOpen:l,onClose:()=>Y(!1),padding:16,children:(0,i.jsx)(es,{onClose:()=>Y(!1)})})]})};var e_=n(80631);function eR(){let e=(0,r.Z)(["\n  max-width: 1080px;\n  margin-top: 20px;\n"]);return eR=function(){return e},e}function eF(){let e=(0,r.Z)(["\n  color: ",";\n"]);return eF=function(){return e},e}function eB(){let e=(0,r.Z)(["\n  white-space: pre-line;\n  color: ",";\n"]);return eB=function(){return e},e}function eZ(){let e=(0,r.Z)(["\n  width: 380px;\n"]);return eZ=function(){return e},e}function eU(){let e=(0,r.Z)(["\n  svg {\n    width: 16px;\n    height: 16px;\n  }\n"]);return eU=function(){return e},e}let eK=(0,B.ZP)(e_._z).withConfig({componentId:"sc-95bd8c52-0"})(eR()),eV=(0,B.ZP)(C.H1).withConfig({componentId:"sc-95bd8c52-1"})(eF(),e=>{let{theme:t}=e;return t.colors.global.text.T1}),eH=(0,B.ZP)(C.OR).withConfig({componentId:"sc-95bd8c52-2"})(eB(),e=>{let{theme:t}=e;return t.colors.global.text.T2}),eq=(0,B.ZP)(C.tu).withConfig({componentId:"sc-95bd8c52-3"})(eZ()),eG=(0,B.ZP)(C.zx).withConfig({componentId:"sc-95bd8c52-4"})(eU()),e$=()=>(0,i.jsx)(T,{children:(0,i.jsx)(y,{children:(0,i.jsx)(eK,{children:(0,i.jsx)(eW,{})})})}),eW=()=>{let e=(0,B.Fg)(),t=(0,eg.useRouter)(),{showDetail:n}=w();return n?(0,i.jsx)(eM,{}):(0,i.jsxs)(C.kC,{gap:60,justifyContent:"space-between",children:[(0,i.jsxs)(eq,{gap:"3xl",children:[(0,i.jsxs)(C.tu,{gap:"md2",children:[(0,i.jsx)(eH,{children:"Welcome to"}),(0,i.jsx)(eV,{children:"Aperture Calculator"})]}),(0,i.jsx)(eH,{children:"Aperture Calculator is your one-stop solution for simulating Concentrated Liquidity positions, allowing you to calculate, analyze, manage, and track everything in one place.".concat("\n\nHead to our Pool Discovery page to find the best performing pools.","\n\nReady to dive in? Start by selecting an exchange, network, pair, and fee tier then hit calculate.")}),(0,i.jsx)(eG,{onClick:()=>t.push("/calculator/pools"),width:"224px",variant:"default",icon:(0,i.jsx)(ed.$D,{stroke:e.colors.global.primary}),iconPosition:"end",children:(0,i.jsx)(C.hE,{children:"ApertureSwap Top Pools"})})]}),(0,i.jsx)(eu,{})]})};var ez=e$}},function(e){e.O(0,[9458,2089,1324,2888,179],function(){return e(e.s=84649)}),_N_E=e.O()}]);
//# sourceMappingURL=calculator-a7b4500c4f49044b.js.map