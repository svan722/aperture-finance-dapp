(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5103],{83833:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/liquidity-management",function(){return t(89090)}])},89090:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return rA}});var i=t(92228),o=t(79570),r=t(62942),a=t(2656),l=t(85464),c=t(89011),s=t(30990),d=t(13321),u=t(66886),p=t(48803),g=t(76793),m=t(11141),f=t(70502),h=t(64928),x=t(40770),v=t(45796),k=t(8481),b=t(31900),w=t(17625),I=t(69987),j=t(16405),A=t(58694),P=t(92321),y=t(75282),C=t(24002),T=t(41738),S=t(84401),Z=t(47521),R=t(87076),B=t(57916),L=t(47574),N=t(28388),M=t(2303);function D(e){let{isConnected:n}=(0,P.m)(),{ammEnum:t,networkId:i,publicClient:o,isChainSupported:a}=(0,r.L)();return(0,M.Z)(n&&t&&a?"user-lp-".concat(t,"-").concat(i,"-").concat(e):null,()=>N.viem.PositionDetails.fromPositionId(i,t,BigInt(e),o))}var F=t(59426),E=t(61029),q=t(9485),O=t(12968),z=t(3344),_=t(34244),U=t.n(_),W=t(44850),Y=t.n(W),X=t(65195),G=t.n(X),H=t(19034),V=t.n(H);let J=j.createContext(null),K=e=>{var n,t,i,a,l,c,d,u,p,m,f,x,v,k,b,w,A,y,M,_;let{children:W,position:X,trigger:H,tabs:K}=e,{address:$}=(0,P.m)(),{ammEnum:Q,networkId:ee}=(0,r.L)(),en=X.tokenA,et=X.tokenB,{data:ei}=D(X.positionId),{currentTokenPrice:eo}=(0,R.P)(ee),{data:er}=(0,h.w)(),{data:ea}=(0,L.GB)(),{globalSlippage:el}=(0,C.DK)(),[ec,es]=(0,j.useState)(0===K?"Rebalance":"Automated Rebalance"),[ed,eu]=(0,j.useState)({amount0:"0",amount1:"0"}),[ep,eg]=(0,j.useState)({slippage:(null==H?void 0:H.action.type)==="Rebalance"&&H.action.slippage||(null!=el?el:F.wW),deadline:"30"}),[em,ef]=(0,j.useState)(""),[eh,ex]=(0,j.useState)(),[ev,ek]=(0,j.useState)(),[eb,ew]=(0,j.useState)(),eI=(0,g.nZ)(null==er?void 0:er[ee],"Rebalance",X.positionId).length,ej=!H&&eI>=F.u6,eA=()=>H?(0,g.s2)(H):"Price",eP=e=>(0,q.tickToPrice)(X.positionDataRaw.pool.token0,X.positionDataRaw.pool.token1,e),[ey,eC]=(0,j.useState)({gasCeiling:(null==H?void 0:null===(n=H.action)||void 0===n?void 0:n.maxGasProportion)||(0,F.yX)(ee,X.liquidity),trigger:{type:eA(),Price:{token:"Price"===eA()&&(null==H?void 0:null===(t=H.condition)||void 0===t?void 0:t.singleToken)===1?et:en,aboveOrBelow:"Price"===eA()&&(null==H?void 0:null===(i=H.condition)||void 0===i?void 0:i.lte)!==void 0?"Below":"Above",amount:"Price"===eA()&&(null==H?void 0:null===(a=H.condition)||void 0===a?void 0:a.singleToken)===void 0&&((null==H?void 0:null===(l=H.condition)||void 0===l?void 0:l.gte)||(null==H?void 0:null===(c=H.condition)||void 0===c?void 0:c.lte))||"0",timeBuffer:(null==H?void 0:null===(d=H.condition)||void 0===d?void 0:d.type)==="Price"&&(null==H?void 0:null===(u=H.condition)||void 0===u?void 0:u.durationSec)?parseFloat((0,E._V)(Y().divide(null==H?void 0:null===(p=H.condition)||void 0===p?void 0:p.durationSec,3600,8))):O.wH,timeBufferChecked:!!((null==H?void 0:null===(m=H.condition)||void 0===m?void 0:m.type)==="Price"&&(null==H?void 0:null===(f=H.condition)||void 0===f?void 0:f.durationSec))},Ratio:{token:en,aboveOrBelow:"Ratio"===eA()&&(null==H?void 0:null===(x=H.condition)||void 0===x?void 0:x.lte)!==void 0?"Above":"Below",percentage:"Ratio"===eA()?(()=>{let e=new(U())(H.condition.lte||H.condition.gte||"0");try{let n=(0,N.getTokenValueProportionFromPriceRatio)(X.tickLower,X.tickUpper,e).toFixed(4);return parseFloat(n)}catch(e){return console.log(e),0}})():.5,timeBuffer:(null==H?void 0:null===(v=H.condition)||void 0===v?void 0:v.type)==="Price"&&(null==H?void 0:null===(k=H.condition)||void 0===k?void 0:k.durationSec)?parseFloat((0,E._V)(Y().divide(null==H?void 0:null===(b=H.condition)||void 0===b?void 0:b.durationSec,3600,8))):O.wH,timeBufferChecked:!!((null==H?void 0:null===(w=H.condition)||void 0===w?void 0:w.type)==="Price"&&(null==H?void 0:null===(A=H.condition)||void 0===A?void 0:A.durationSec))},Time:{dateTime:V()((null==H?void 0:null===(y=H.condition)||void 0===y?void 0:y.type)==="Time"?1e3*H.condition.timeAfterEpochSec:new Date().setDate(new Date().getDate()+7)).format("MMMM DD, yyyy hh:mm a")}},priceRange:(()=>{let e=H&&!H.action.isCurrentTickOffset?H.action.tickLower:X.tickLower,n=H&&!H.action.isCurrentTickOffset?H.action.tickUpper:X.tickUpper,t=eP(e),i=eP(n);return{min:t.toFixed(18),max:i.toFixed(18),swapMin:i.invert().toFixed(18),swapMax:t.invert().toFixed(18),tickLower:e,tickUpper:n}})(),percentageRange:(()=>{let e=H&&H.action.isCurrentTickOffset?H.action.tickLower:(0,Z.Zx)(-20,-100,0),n=H&&H.action.isCurrentTickOffset?H.action.tickUpper:(0,Z.Zx)(20,0);return{min:(0,Z.jw)(e),max:(0,Z.jw)(n),swapMin:(0,Z.jw)(-1*n),swapMax:(0,Z.jw)(-1*e),tickLower:e,tickUpper:n}})(),useFutureSpot:!!H&&H.action.isCurrentTickOffset,futureSpotTab:I.bR2.PERCENTAGES}),eT=(0,j.useMemo)(()=>{var e,n;return[null!==(M=null==eo?void 0:null===(e=eo[en.address])||void 0===e?void 0:e.price)&&void 0!==M?M:"0",null!==(_=null==eo?void 0:null===(n=eo[et.address])||void 0===n?void 0:n.price)&&void 0!==_?_:"0"]},[eo,en,et]),eS=(0,j.useMemo)(()=>X.tickLower!==ey.priceRange.tickLower||X.tickUpper!==ey.priceRange.tickUpper,[ey.priceRange.tickLower,ey.priceRange.tickUpper,X.tickLower,X.tickUpper]),[eZ,eR]=(0,j.useState)(!!H);(0,j.useEffect)(()=>{if("Automated Rebalance"===ec){let{trigger:e}=ey;ej?ef("Maximum number of triggers"):"Price"===e.type&&"0"===e.Price.amount?ef("Price Amount Is Required"):"Time"!==e.type||ey.trigger.Time.dateTime?"Time"===e.type&&V()(ey.trigger.Time.dateTime).valueOf()<V()().valueOf()?ef("Trigger Time Is Before Current Time"):ef((0,F.le)(ee,ey.gasCeiling,"-"!==X.liquidity?X.liquidity:"0")):ef("Trigger Time Is Required")}else ef("")},[ec,ey,ej]),(0,j.useEffect)(()=>{"Rebalance"!==ec&&(()=>{let e={ownerAddr:$,chainId:ee,action:{type:"Rebalance",tickLower:ey.useFutureSpot&&ey.futureSpotTab===I.bR2.PERCENTAGES?ey.percentageRange.tickLower:ey.priceRange.tickLower,tickUpper:ey.useFutureSpot&&ey.futureSpotTab===I.bR2.PERCENTAGES?ey.percentageRange.tickUpper:ey.priceRange.tickUpper,slippage:ep.slippage,maxGasProportion:ey.gasCeiling,isCurrentTickOffset:ey.useFutureSpot},condition:(0,g.$W)(ey.trigger,X.tokenA,X.tokenB,X.tickLower,X.tickUpper,ee),expiration:(0,S.Ll)()};if(H){for(let n in e.taskId=null==H?void 0:H.taskId,e.condition)void 0===e.condition[n]&&delete e.condition[n];let n=G().cloneDeep(e);"Price"===n.condition.type&&"RELATIVE_PRICE"===n.condition.frontendType&&(n.condition.lte?n.condition.lte=(0,I.nOQ)(n.condition.lte,[X.tokenA,X.tokenB]):n.condition.gte&&(n.condition.gte=(0,I.nOQ)(n.condition.gte,[X.tokenA,X.tokenB])));let t=G().isEqual(e.action,H.action),i=G().isEqual(n.condition,H.condition);eR(t&&i),t&&(e.action=void 0),i&&(e.condition=void 0)}else e.amm=Q,e.nftId=X.positionId;ex(e)})()},[ey,ep]);let eB=(0,z.Z)(ey.priceRange,{wait:500}),{swapInfo:eL,selectedSolver:eN,suggestedSolver:eM,setSelectedSolver:eD}=(0,C.Dn)(),{isSyncing:eF,runSwapInfo:eE,cancelSwapInfo:eq,swapInfoError:eO}=(0,B.o)(),{staked:ez}=(0,s.i)();return(0,j.useEffect)(()=>{if("Rebalance"===ec){if(eS){let e="".concat(Q,"-").concat(ee,"-").concat($,"-").concat(X.positionId)+":[".concat(eB.tickLower,",").concat(eB.tickUpper,"]_").concat(ep.slippage);eE({type:"Rebalance",positionId:X.positionId,slippage:ep.slippage,tokenMap:ea,fetchKey:e,options:{tickLower:eB.tickLower,tickUpper:eB.tickUpper,tokenPrices:eT}})}else eq()}},[ec,eB,ep,eS,ez,X.positionId]),(0,T.o)(()=>{eq()}),(0,o.jsx)(J.Provider,{value:{tab:ec,position:X,trigger:H,tokenPrice:eT,positionDetails:ei,form:ey,projectedAmount:ed,maxTriggersCreated:ej,txForm:ep,error:em,isAutoBtnDisabled:eZ,isRebalanceChanged:eS,automatedRebalancePayload:eh,isSyncing:eF,swapInfo:eL,swapInfoError:eO,suggestedSolver:eM,selectedSolver:eN,permitInfo:ev,gasEstimated:eb,setTab:es,setForm:eC,setTxForm:eg,setProjectedAmount:eu,setPermitInfo:ek,setGasEstimated:ew,setError:ef,setSelectedSolver:eD},children:W})},$=()=>j.useContext(J);var Q=t(27947),ee=t(20973),en=t(94865),et=t(48747),ei=t(33841),eo=t(80631),er=t(15229);function ea(){let e=(0,i.Z)(["\n  color: ",";\n  span:first-child {\n    margin-right: 4px;\n  }\n"]);return ea=function(){return e},e}function el(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  gap: ",";\n"]);return el=function(){return e},e}function ec(){let e=(0,i.Z)(["\n  justify-content: space-between;\n  align-items: center;\n  gap: ",";\n"]);return ec=function(){return e},e}function es(){let e=(0,i.Z)(["\n  color: ",";\n"]);return es=function(){return e},e}function ed(){let e=(0,i.Z)(["\n  margin-top: ",";\n"]);return ed=function(){return e},e}function eu(){let e=(0,i.Z)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: ",";\n"]);return eu=function(){return e},e}function ep(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return ep=function(){return e},e}function eg(){let e=(0,i.Z)(["\n  color: ",";\n  gap: ",";\n"]);return eg=function(){return e},e}let em=(0,A.ZP)(I.Bpc).withConfig({componentId:"sc-bdabc299-0"})(ea(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),ef=A.ZP.div.withConfig({componentId:"sc-bdabc299-1"})(el(),e=>{let{theme:n}=e;return n.spacing.xl}),eh=(0,A.ZP)(I.kCb).withConfig({componentId:"sc-bdabc299-2"})(ec(),e=>{let{theme:n}=e;return n.spacing.md}),ex=(0,A.ZP)(I.Bpc).withConfig({componentId:"sc-bdabc299-3"})(es(),e=>{let{theme:n}=e;return n.colors.global.text.T2}),ev=(0,A.ZP)(I.oXX).withConfig({componentId:"sc-bdabc299-4"})(ed(),e=>{let{theme:n}=e;return n.spacing.xl}),ek=A.ZP.div.withConfig({componentId:"sc-bdabc299-5"})(eu(),e=>{let{theme:n}=e;return n.spacing.md}),eb=(0,A.ZP)(eo._r).withConfig({componentId:"sc-bdabc299-6"})(ep(),e=>{let{theme:n}=e;return n.spacing.xl}),ew=(0,A.ZP)(I.T59).withConfig({componentId:"sc-bdabc299-7"})(eg(),e=>{let{theme:n}=e;return n.colors.global.text.T1},e=>{let{theme:n}=e;return n.spacing.lg});function eI(e){return e}let ej=()=>{var e,n,t,i,a,l,d,u,g,m;let{networkId:f,ammEnum:h}=(0,r.L)(),x=(0,A.Fg)(),{tab:v,position:k,positionDetails:b,tokenPrice:w,form:P,setForm:y,maxTriggersCreated:C,isSyncing:T,swapInfo:S,swapInfoError:R,suggestedSolver:B,selectedSolver:L,isRebalanceChanged:M}=$(),{staked:D}=(0,s.i)(),{handleChangeAPI:E}=(0,Q.nK)(),O=k.tokenA.ticker,z=k.tokenB.ticker,[_,U]=(0,j.useState)("tokenA"),[W,X]=(0,j.useState)(P.priceRange.tickLower),[G,H]=(0,j.useState)(P.priceRange.tickUpper),[V,J]=(0,j.useState)(P.percentageRange.tickLower),[K,ea]=(0,j.useState)(P.percentageRange.tickUpper),[el,ec]=(0,j.useState)(!1),[es,ed]=(0,j.useState)(P.useFutureSpot),[eu,ep]=(0,j.useState)(P.futureSpotTab),eg=f?(0,ee.UZ)(k.tokenA,k.tokenB,f):null,ej=(0,j.useMemo)(()=>{var e,n,t,i;if(!R&&(null==S?void 0:null===(e=S[L])||void 0===e?void 0:e.finalAmount0)!==void 0&&(null==S?void 0:null===(n=S[L])||void 0===n?void 0:n.finalAmount1)!==void 0&&b){let e=(0,er.b)(null==S?void 0:null===(t=S[L])||void 0===t?void 0:t.finalAmount0,b.token0.decimals),n=(0,er.b)(null==S?void 0:null===(i=S[L])||void 0===i?void 0:i.finalAmount1,b.token1.decimals);return{token0Amount:e,token1Amount:n,...(0,ee.zu)(e,n,w[0],w[1])}}if(!b||!(W<G))return{token0Amount:k.tokenA.amount,token1Amount:k.tokenB.amount,...(0,ee.zu)(k.tokenA.amount,k.tokenB.amount,w[0],w[1])};{(0,N.getLogger)().debug("InvariantFailed",{tab:v,networkId:f,position:k,positionDetails:b.position,tickLower:W,tickUpper:G,tokenPrice:w,trigger:"Automated Rebalance"===v?P.trigger:void 0});let e=(0,p.UA)(f,k,b.position,W,G,w,"Automated Rebalance"===v?P.trigger:void 0);return{token0Amount:e[0].amount,token1Amount:e[1].amount,token0Percent:e[0].percent,token1Percent:e[1].percent}}},[P.trigger,v,W,G,R,S,L,b]),eA=(0,j.useMemo)(()=>"Automated Rebalance"===v&&es,[v,es]),eP="SLIPSTREAM"===h?k.tickSpacing:k.feeTier,{data:ey,isLoading:eC,error:eT}=(0,en.M)(k.tokenA.address,k.tokenB.address,eP),{data:eS}=(0,et.m)(k.tokenA.address,k.tokenB.address,[eP]),eZ=Number(null!==(m=null==eS?void 0:null===(e=eS[eP])||void 0===e?void 0:e[_])&&void 0!==m?m:0),eR=e=>{y({...P,priceRange:e})},eB=e=>{y({...P,percentageRange:e})},eL=(0,j.useCallback)((e,n)=>[(0,q.tickToPrice)(eg.token0,eg.token1,e),(0,q.tickToPrice)(eg.token0,eg.token1,n)],[eg]),eN=(e,n)=>{if(eg&&_){let t=(0,p.eX)(eg.token0,eg.token1,e,k.tickSpacing,"tokenA"===_);"Min"===n?"tokenA"===_?X(t):H(t):"tokenA"===_?H(t):X(t)}},eM=(e,n)=>{if(eg&&_){let t=(0,Z.Zx)(Math.abs(parseFloat(e))*("Min"===n?-1:1),"Min"===n?-100:0,"Min"===n?0:void 0);"Min"===n?"tokenA"===_?J(t):ea(-1*t):"tokenA"===_?ea(t):J(-1*t)}},eD=e=>{var n;let t=(0,Z.Tp)(e,W,G,"tokenB"===_,k.tickSpacing,null===(n=k.positionDataRaw)||void 0===n?void 0:n.pool);"getDecrementLower"===e||"getIncrementLower"===e?"tokenA"===_?X(t):H(t):"tokenA"===_?H(t):X(t)},eF=e=>{let n=0,t=0;if("tokenA"===_)switch(e){case"getDecrementLower":(t=eE(n=parseFloat(P.percentageRange.min)-1,-100))===V&&-100!==parseFloat(P.percentageRange.min)&&(t-=q.TICK_SPACINGS[k.feeTier]),J(t);break;case"getIncrementLower":(t=eE(n=parseFloat(P.percentageRange.min)+1,-100))===V&&0!==parseFloat(P.percentageRange.min)&&(t+=q.TICK_SPACINGS[k.feeTier]),J(t);break;case"getDecrementUpper":(t=eE(n=parseFloat(P.percentageRange.max)-1,0))===K&&0!==parseFloat(P.percentageRange.max)&&(t-=q.TICK_SPACINGS[k.feeTier]),ea(t);break;case"getIncrementUpper":(t=eE(n=parseFloat(P.percentageRange.max)+1,0))===K&&(t+=q.TICK_SPACINGS[k.feeTier]),ea(t)}else switch(e){case"getDecrementLower":(t=-1*eE(n=parseFloat(P.percentageRange.swapMin)-1,-100))===K&&-100!==parseFloat(P.percentageRange.swapMin)&&(t+=q.TICK_SPACINGS[k.feeTier]),ea(t);break;case"getIncrementLower":(t=-1*eE(n=parseFloat(P.percentageRange.swapMin)+1,-100))===K&&0!==parseFloat(P.percentageRange.swapMin)&&(t-=q.TICK_SPACINGS[k.feeTier]),ea(t);break;case"getDecrementUpper":(t=-1*eE(n=parseFloat(P.percentageRange.swapMax)-1,0))===V&&0!==parseFloat(P.percentageRange.swapMax)&&(t+=q.TICK_SPACINGS[k.feeTier]),J(t);break;case"getIncrementUpper":(t=-1*eE(n=parseFloat(P.percentageRange.swapMax)+1,0))===V&&(t-=q.TICK_SPACINGS[k.feeTier]),J(t)}},eE=(e,n)=>(0,Z.Zx)(e,n,-100===n?0:void 0);(0,j.useEffect)(()=>{if(eg){let[e,n]=eL(W,G);eR({min:e.toFixed(18),max:n.toFixed(18),swapMin:n.invert().toFixed(18),swapMax:e.invert().toFixed(18),tickLower:W,tickUpper:G})}},[W,G]),(0,j.useEffect)(()=>{eg&&el&&eB({min:(0,Z.jw)(V),max:(0,Z.jw)(K),swapMin:(0,Z.jw)(-1*K),swapMax:(0,Z.jw)(-1*V),tickLower:V,tickUpper:K})},[V,K]),(0,j.useEffect)(()=>{let e=setTimeout(()=>{ec(!0)},1e3);return()=>{clearTimeout(e)}},[]),(0,j.useEffect)(()=>{eg&&y({...P,useFutureSpot:es})},[es]),(0,j.useEffect)(()=>{eg&&y({...P,futureSpotTab:eu})},[eu]);let eq=(0,j.useMemo)(()=>{if(eg&&_){let[e,n]=eL(k.tickLower,k.tickUpper);return"tokenA"===_?[Number(e.toFixed(18)),Number(n.toFixed(18))]:[Number(n.invert().toFixed(18)),Number(e.invert().toFixed(18))]}},[_]);return"Automated Rebalance"===v&&(0,c.TN)(f)?(0,o.jsx)(eo.cs,{height:"320px",children:(0,o.jsx)(I.Bpc,{children:"Automation tool on ApertureSwap is coming soon!"})}):(0,o.jsxs)(eo.W2,{children:["Automated Rebalance"===v&&(0,o.jsx)(I.T50,{errorMsg:C?"You have already set up the maximum number of triggers (".concat(F.u6,")."):void 0,tooltip:"Use triggers to automatically rebalance your position based on asset prices, pool ratios, or time. Users can set up to 3 triggers for automated rebalancing.",initForm:P.trigger,tokens:[k.tokenA,k.tokenB],expireDays:N.AUTOMATION_EXPIRATION_IN_DAYS,onFormChange:e=>{y({...P,trigger:e})}}),!(0,F.H0)()&&(0,o.jsxs)(ew,{children:[(0,o.jsxs)("div",{children:["tickLower:",P.priceRange.tickLower," tickUpper:"," ",P.priceRange.tickUpper]}),(0,o.jsxs)("div",{children:["percentageTickLower: ",P.percentageRange.tickLower," ","percentageTickUpper: ",P.percentageRange.tickUpper]})]}),(0,o.jsx)(eo.mK,{gap:x.spacing.xl,children:(0,o.jsxs)(eb,{width:"100%",children:[(0,o.jsx)(ef,{children:(0,o.jsx)(em,{lineHeight:"20px",children:"Set New Price Range"})}),(0,o.jsxs)(eh,{children:[(0,o.jsx)(ei.aW,{menu:[O,z],defaultSelected:"tokenA"===_?0:1,onSelect:e=>U(e===O?"tokenA":"tokenB"),width:140}),"Automated Rebalance"===v&&(0,o.jsxs)(ek,{children:[(0,o.jsx)(I.mGS,{noText:!0,onStatus:es,onChange:e=>{ed(e)}}),(0,o.jsx)(ex,{children:"Price range based on future spot price"})]})]}),eA?(0,o.jsx)(I.CEI,{price:eZ,priceLower:"tokenA"===_?P.percentageRange.min:P.percentageRange.swapMin,priceUpper:"tokenA"===_?P.percentageRange.max:P.percentageRange.swapMax,getDecrementLower:()=>{eF("getDecrementLower")},getIncrementLower:()=>{eF("getIncrementLower")},getDecrementUpper:()=>{eF("getDecrementUpper")},getIncrementUpper:()=>{eF("getIncrementUpper")},onLeftRangeInput:e=>{eM(e,"Min")},onRightRangeInput:e=>{eM(e,"Max")},feeAmount:k.feeTier,currencyA:k[_].ticker,currencyB:"tokenB"===_?O:z,ticksAtLimit:{LOWER:!0,UPPER:!0},interactive:!0,chartHeight:200,futureSpotTab:eu,onSwitchFutureSpotTab:ep}):(0,o.jsx)(I.Yyu,{price:eZ,priceLower:"tokenA"===_?P.priceRange.min:P.priceRange.swapMin,priceUpper:"tokenA"===_?P.priceRange.max:P.priceRange.swapMax,warningMsg:Y().compareTo("tokenA"===_?P.priceRange.min:P.priceRange.swapMin,"tokenA"===_?P.priceRange.max:P.priceRange.swapMax)>=0?"Invalid range selected. The min price must be lower than the max price.":"Rebalance"===v?"Your position will not earn fees or be used in trades until the market price moves into your range.":void 0,validate:eI,getDecrementLower:()=>{eD("getDecrementLower")},getIncrementLower:()=>{eD("getIncrementLower")},getDecrementUpper:()=>{eD("getDecrementUpper")},getIncrementUpper:()=>{eD("getIncrementUpper")},onLeftRangeInput:e=>eN(e,"Min"),onRightRangeInput:e=>eN(e,"Max"),feeAmount:k.feeTier,currencyA:k[_].ticker,currencyB:"tokenB"===_?O:z,ticksAtLimit:{LOWER:!0,UPPER:!0},interactive:!0,chartHeight:200,dataState:{isLoading:eC,error:eT,formattedData:ey&&ey[_]},currentRange:eq}),"Rebalance"===v&&M&&(T||R&&!S||(null==S?void 0:S[L]))&&(0,o.jsx)(ev,{loading:T,priceImpact:null==S?void 0:null===(n=S[L])||void 0===n?void 0:n.priceImpact,api:null==S?void 0:null===(t=S[L])||void 0===t?void 0:t.api,fromToken:null==S?void 0:null===(i=S[L])||void 0===i?void 0:i.fromToken,swapData:null==S?void 0:null===(a=S[L])||void 0===a?void 0:a.swapData,swapRoutes:null==S?void 0:null===(l=S[L])||void 0===l?void 0:l.swapRoutes,showSwapRoutes:(null==S?void 0:null===(d=S[L])||void 0===d?void 0:null===(u=d.swapRoutes)||void 0===u?void 0:u.length)>0,errorMsg:R&&!S,maxSwapRouteWidth:562,onBtnClick:E,suggested:L===B,gasFeeUSD:null==S?void 0:null===(g=S[L])||void 0===g?void 0:g.gasFeeUSD,atStake:D})]})}),!eA&&(0,o.jsxs)(I.kCb,{justifyContent:"space-between",children:[(0,o.jsxs)(eb,{width:"Automated Rebalance"===v?"463px":"100%",children:[(0,o.jsx)(em,{children:"Projected Liquidity Position"}),(0,o.jsx)(I.sXs,{Icon:k.tokenA.Icon,ticker:k.tokenA.ticker,address:k.tokenA.address,native:k.tokenA.native,decimals:k.tokenA.decimals,amount:ej.token0Amount,price:w[0],tag:"".concat(ej.token0Percent,"%"),maxWidth:500,marginBottom:0},k.tokenA.address),(0,o.jsx)(I.sXs,{Icon:k.tokenB.Icon,ticker:k.tokenB.ticker,address:k.tokenB.address,native:k.tokenB.native,decimals:k.tokenA.decimals,amount:ej.token1Amount,price:w[1],maxWidth:500,marginBottom:0,tag:"".concat(ej.token1Percent,"%")},k.tokenB.address),(0,o.jsx)(I.Fgq,{text:"Any uncollected fees will be collected and reinvested into the new position after rebalance."})]}),"Automated Rebalance"===v&&(0,o.jsxs)(eo.WA,{children:[(0,o.jsx)(em,{children:"Expires In"}),(0,o.jsx)(I.ayo,{children:"".concat(N.AUTOMATION_EXPIRATION_IN_DAYS," Days")})]})]}),"Automated Rebalance"===v&&(0,o.jsxs)(I.kCb,{justifyContent:"space-between",children:[(0,o.jsxs)(eb,{width:eA?"463px":"100%",children:[(0,o.jsxs)(em,{fontSize:16,lineHeight:"20px",children:[(0,o.jsx)("span",{children:"Gas Fee Ceiling Setting"}),(0,o.jsx)(I.rIP,{content:"Input the maximum gas fee in either dollars or percentage of position. However, the actual gas ceiling will be based on the percentage not the dollar amount (e.g. if you choose $50 which is currently 1% of your total liquidity position then we will set a gas ceiling of 1%)."})]}),(0,o.jsx)(I.ft7,{color:"primary",width:280,amount:k.liquidity,percentage:P.gasCeiling,onChange:e=>{y({...P,gasCeiling:e})},onError:e=>(0,F.ob)(f,e,k.liquidity)})]}),eA&&(0,o.jsxs)(eo.WA,{children:[(0,o.jsx)(em,{children:"Expires In"}),(0,o.jsx)(I.ayo,{children:"".concat(N.AUTOMATION_EXPIRATION_IN_DAYS," Days")})]})]})]})};var eA=t(45020),eP=t(71321),ey=t(83364),eC=t(3552),eT=t(56301),eS=t(1127),eZ=t(76826);let eR=e=>{let{payload:n,onClose:t}=e,{mutate:i}=(0,h.w)(),{addSnackbar:r}=(0,u.D)(),{ifAuthorized:a}=(0,eS.I)(),{data:l}=(0,eZ.m)(),{position:c,trigger:s}=$(),{data:d,isLoading:p,mutate:m}=(0,eT.A)(c.positionId),[f,x]=(0,j.useState)(void 0),[v,k]=(0,j.useState)(void 0),[b,w]=(0,j.useState)(!1);return(0,j.useEffect)(()=>{v&&n&&(w(!0),s?(0,g.dq)(n,v).then(e=>{let n=(0,g.s2)(s);"Success"===e&&(m().then(()=>{i()}),r("You have successfully updated the ".concat(n.toLowerCase()," trigger for your ").concat(c.tokenA.ticker,"-").concat(c.tokenB.ticker," position rebalance."),"completed"),t(),w(!1))}).catch(e=>{r("Your automated rebalance update request has failed: "+e,"failed"),w(!1)}):(0,g.$y)(n,v,f).then(e=>{if("Success"===e){let e=(0,g.s2)(n);m().then(()=>{i()}),r("You have successfully set up a ".concat(e.toLowerCase(),"-based automated rebalance for your ").concat(c.tokenA.ticker,"-").concat(c.tokenB.ticker," position."),"completed"),t(),w(!1)}}).catch(e=>{r("Your automated rebalance request has failed: "+(0,g.cr)(e),"failed"),w(!1)}))},[v]),a||p||d||f?(0,o.jsx)(ey.Z,{text:"Confirm Automated Rebalance Intent",color:"secondary",isLoading:b,payload:n,setSignedPayload:k}):l?(0,o.jsx)(eP.Z,{text:"Approve on-chain",color:"secondary",tokenPair:"".concat(c.tokenA.ticker,"-").concat(c.tokenB.ticker),positionIdBN:c.positionIdBN,onApproved:m}):(0,o.jsx)(eC.Z,{color:"secondary",tokenPair:"".concat(c.tokenA.ticker,"-").concat(c.tokenB.ticker),positionId:c.positionIdBN,setPermitInfo:e=>x({signature:e.signature,deadline:String(e.deadline)})})};var eB=t(17510),eL=t(10996),eN=t(25590);let eM=e=>{let{navBack:n,onClose:t,color:i="primary"}=e,{address:a}=(0,P.m)(),{ammEnum:l,networkId:c,publicClient:s}=(0,r.L)(),[d,g]=(0,j.useState)(),{position:m,error:f,isSyncing:h,form:x,swapInfo:v,swapInfoError:k,selectedSolver:b,permitInfo:w,txForm:A,tokenPrice:y,setProjectedAmount:C,setGasEstimated:T,setError:S}=$(),{ready:Z,data:R,sendTransaction:B,error:L,isError:M,isPending:D,isSuccess:E}=(0,eN.i)(d),{addSnackbar:q}=(0,u.D)(),{addPositionSnackbar:O}=(0,eL.A)();return(0,j.useEffect)(()=>{M&&(q("Your rebalance request has failed.","failed"),console.log("Failed to rebalance",L))},[M]),(0,j.useEffect)(()=>{if(T(void 0),g(void 0),null==v?void 0:v[b]){var e,n,t;(0,p.rp)(l,m,a,x.priceRange,A,w,null==v?void 0:null===(e=v[b])||void 0===e?void 0:e.swapDataHex,null==v?void 0:null===(n=v[b])||void 0===n?void 0:n.liquidity,null==v?void 0:null===(t=v[b])||void 0===t?void 0:t.feeBips,s).then(e=>{var n,t,i,o;let{tx:r}=e;C({amount0:null===(n=v[b])||void 0===n?void 0:null===(t=n.finalAmount0)||void 0===t?void 0:t.toString(),amount1:null===(i=v[b])||void 0===i?void 0:null===(o=i.finalAmount1)||void 0===o?void 0:o.toString()}),(0,eB.Q)(r,c,s).then(e=>{let{totalGasCost:n,gasCost:t,l2GasAmount:i}=e;g({...r,gas:(0,F.yC)(i)}),T(null!=n?n:t)}).catch(e=>{(0,N.getLogger)().error("Failed to estimate gas on getRebalanceTx: ",{error:JSON.stringify(e.message)}),S(e.details)})}).catch(e=>{var n,t,i;(0,N.getLogger)().error("Failed to getRebalanceRequest: ",{ammEnum:l,networkId:m.chainId,address:a,positionId:m.positionId,priceRange:x.priceRange,txForm:A,swapDataHex:null==v?void 0:null===(n=v[b])||void 0===n?void 0:n.swapDataHex,liquidity:null==v?void 0:null===(t=v[b])||void 0===t?void 0:t.liquidity,feeBips:null==v?void 0:null===(i=v[b])||void 0===i?void 0:i.feeBips,error:JSON.stringify(e)}),S(e.reason)})}},[x.priceRange,A,w,v,b]),(0,j.useEffect)(()=>{if(E){var e,i,o,r,a,c,s,d,u;O({info:"Your rebalance request has been sent.",status:"completed",url:void 0,transaction:{hash:R,successMsg:"You have successfully rebalanced your ".concat(m.tokenA.ticker,"-").concat(m.tokenB.ticker," position.")}});let p=Math.floor(Number(null==v?void 0:null===(e=v[b])||void 0===e?void 0:e.feeBips)/1e14)/1e4,g={ammEnum:l,txHash:R,feePips:p,feeUSD:null==v?void 0:null===(i=v[b])||void 0===i?void 0:i.feeUSD,solver:null==v?void 0:null===(o=v[b])||void 0===o?void 0:null===(r=o.api)||void 0===r?void 0:r.solver,tokenA:m.tokenA.address,tokenB:m.tokenB.address,tokenPrice:y,finalAmount0:null==v?void 0:null===(a=v[b])||void 0===a?void 0:null===(c=a.finalAmount0)||void 0===c?void 0:c.toString(),finalAmount1:null==v?void 0:null===(s=v[b])||void 0===s?void 0:null===(d=s.finalAmount1)||void 0===d?void 0:d.toString(),swapData:null==v?void 0:null===(u=v[b])||void 0===u?void 0:u.swapData};p>.05?(0,N.getLogger)().warn("Rebalance Request Sent Success",g):(0,N.getLogger)().info("Rebalance Request Sent Success",g),n(),t()}},[E]),(0,o.jsx)(I.zxk,{onClick:()=>{(0,N.getLogger)().info("Rebalance.ClickConfirm.Start",{ammEnum:l}),null==B||B()},disabled:!d||!Z||!!f||D||E||h,variant:"contained",color:i,size:"lg",width:"100%",children:f||(D||h?(0,o.jsx)(I.$jN,{}):!k||(null==v?void 0:v[b])?"Confirm Rebalance":"Swap Info Unavailable")})},eD=e=>{let{navBack:n,onClose:t}=e,{position:i,permitInfo:r,setPermitInfo:a}=$(),{ifAuthorized:l}=(0,eS.I)(),{data:c}=(0,eZ.m)(),{data:s,isLoading:d,mutate:u}=(0,eT.A)(i.positionId);return(0,o.jsx)(o.Fragment,{children:l||c&&(d||s)||r?(0,o.jsx)(eM,{color:"secondary",navBack:n,onClose:t}):c?(0,o.jsx)(eP.Z,{text:"Approve on-chain",color:"secondary",tokenPair:"".concat(i.tokenA.ticker,"-").concat(i.tokenB.ticker),positionIdBN:i.positionIdBN,onApproved:u}):(0,o.jsx)(eC.Z,{color:"secondary",tokenPair:"".concat(i.tokenA.ticker,"-").concat(i.tokenB.ticker),positionId:i.positionIdBN,setPermitInfo:a})})};function eF(){let e=(0,i.Z)(["\n  height: 100%;\n  gap: ",";\n"]);return eF=function(){return e},e}function eE(){let e=(0,i.Z)(["\n  height: 40px;\n  max-width: ","px;\n  background: ",";\n"]);return eE=function(){return e},e}function eq(){let e=(0,i.Z)(["\n  width: ",";\n"]);return eq=function(){return e},e}function eO(){let e=(0,i.Z)(["\n  overflow-x: hidden;\n  overflow-y: auto;\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n  height: ",";\n"]);return eO=function(){return e},e}function ez(){let e=(0,i.Z)(["\n  padding-bottom: 24px;\n  display: flex;\n  align-items: center;\n  width: ",";\n  justify-content: flex-end;\n  box-sizing: border-box;\n  gap: 18px;\n"]);return ez=function(){return e},e}function e_(){let e=(0,i.Z)(["\n  margin-right: auto;\n"]);return e_=function(){return e},e}let eU=(0,A.ZP)(I.tuJ).withConfig({componentId:"sc-4740a8fe-0"})(eF(),e=>{let{theme:n}=e;return n.spacing["2xl"]}),eW=(0,A.ZP)(I.V28).withConfig({componentId:"sc-4740a8fe-1"})(eE(),e=>{let{maxWidth:n}=e;return n},e=>{let{theme:n}=e;return n.colors.global.background.BG3}),eY=A.ZP.div.withConfig({componentId:"sc-4740a8fe-2"})(eq(),I.mTC),eX=A.ZP.div.withConfig({componentId:"sc-4740a8fe-3"})(eO(),e=>{let{mode:n}=e;return"edit"===n?"calc(100% - 168px)":"calc(100% - 156px)"}),eG=A.ZP.div.withConfig({componentId:"sc-4740a8fe-4"})(ez(),I.mTC),eH=(0,A.ZP)(I.oVd).withConfig({componentId:"sc-4740a8fe-5"})(e_()),eV=e=>{let{mode:n,navBack:t,children:i,onClose:a,onModeChange:l}=e,{networkId:d}=(0,r.L)(),{globalSlippage:u,setGlobalSlippage:p}=(0,C.DK)(),{tab:g,position:m,form:f,txForm:h,setTxForm:x,error:v,swapInfo:b,isAutoBtnDisabled:w,isRebalanceChanged:j,isSyncing:A,automatedRebalancePayload:P,setTab:y,setProjectedAmount:T}=$(),{mutate:S}=(0,k.F)(),{stakePool:Z,staked:R,setStaked:B}=(0,s.i)(),L="preview"===n,N="edit"===n,M="Rebalance"===g,D=M?"Preview Rebalance":"Preview Automated Rebalance Intent";return(0,o.jsxs)(eU,{children:[(0,o.jsx)(eo.Dx,{children:(0,o.jsxs)(I.iIr,{onClick:()=>{N?a():l("edit")},isDrawer:!0,children:[L&&(0,o.jsx)(I.Bpc,{fontSize:16,textAlign:"end",children:D}),N&&(0,o.jsx)(I.Bpc,{fontSize:16,textAlign:"end",children:"Back to dashboard"})]})}),L?(0,o.jsx)(eo.eN,{children:D}):(0,o.jsx)(eo.eN,{children:"Rebalance"}),N&&(0,o.jsx)(eW,{maxWidth:315,containerPadding:"0px",menu:["Rebalance","Automated Rebalance"],selectWidth:[115,185],itemsWidth:[115,188],isPro:[!1,!0],defaultSelected:["Rebalance","Automated Rebalance"].indexOf(g),onSelect:e=>y(e)}),(0,o.jsx)(eX,{mode:n,children:(0,o.jsx)(eY,{children:i})}),!(!M&&(0,c.TN)(d))&&(0,o.jsxs)(eG,{children:[N&&(0,o.jsx)(eH,{defaultSlippage:F.wW,globalSlippage:u,settingsForm:h,dropdownPosition:"topRight",onFormChange:e=>x(e),buttonSize:"small",setGlobalSlippage:e=>p(n=>({...n,[d]:e}))}),(0,o.jsx)(I.zxk,{variant:"contained",color:"default",size:"lg",width:"100%",onClick:()=>{"edit"===n?a():l("edit"),M&&T({amount0:"0",amount1:"0"})},children:"Cancel"}),N&&(Z&&R?(0,o.jsx)(eA.B,{atStake:R,gaugeAddress:Z.gaugeAddress,positionId:m.positionIdBN,handleTxSuccess:()=>{B(!1),S()}},m.positionId):(0,o.jsx)(I.zxk,{variant:"contained",color:"secondary",size:"lg",width:"100%",disabled:!!v||!M&&w||M&&(A||!j||!b||0===b.length)||-1!==Y().compareTo(f.priceRange.min,f.priceRange.max),onClick:()=>{l("preview")},children:v||(M?"Rebalance Now":"Set Up Automated Rebalance")})),L&&(M?(0,o.jsx)(eD,{navBack:t,onClose:a}):(0,o.jsx)(eR,{payload:P,onClose:a}))]})]})};var eJ=t(54764),eK=t.n(eJ),e$=t(88176),eQ=t(14122);function e0(){let e=(0,i.Z)(["\n  box-sizing: border-box;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return e0=function(){return e},e}function e1(){let e=(0,i.Z)(["\n  position: relative;\n"]);return e1=function(){return e},e}function e2(){let e=(0,i.Z)(["\n  width: 100%;\n"]);return e2=function(){return e},e}function e4(){let e=(0,i.Z)(["\n  gap: ",";\n  margin-bottom: 12px;\n"]);return e4=function(){return e},e}function e8(){let e=(0,i.Z)(["\n  margin-bottom: 12px;\n"]);return e8=function(){return e},e}function e9(){let e=(0,i.Z)(["\n  color: ",";\n"]);return e9=function(){return e},e}function e3(){let e=(0,i.Z)(["\n  color: ",";\n"]);return e3=function(){return e},e}function e7(){let e=(0,i.Z)(["\n  color: ",";\n"]);return e7=function(){return e},e}let e5=A.ZP.div.withConfig({componentId:"sc-43b192e1-0"})(e0(),e=>{let{theme:n}=e;return n.spacing.xl}),e6=(0,A.ZP)(eo._r).withConfig({componentId:"sc-43b192e1-1"})(e1()),ne=(0,A.ZP)(eo._r).withConfig({componentId:"sc-43b192e1-2"})(e2()),nn=(0,A.ZP)(e$.tu).withConfig({componentId:"sc-43b192e1-3"})(e4(),e=>{let{theme:n}=e;return n.spacing.lg}),nt=(0,A.ZP)(em).withConfig({componentId:"sc-43b192e1-4"})(e8()),ni=(0,A.ZP)(eQ.T59).withConfig({componentId:"sc-43b192e1-5"})(e9(),e=>{let{theme:n}=e;return n.colors.global.text.T1});(0,A.ZP)(eQ.Bpc).withConfig({componentId:"sc-43b192e1-6"})(e3(),e=>{let{theme:n}=e;return n.colors.global.text.T1});let no=(0,A.ZP)(eo.X2).withConfig({componentId:"sc-43b192e1-7"})(e7(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),nr=()=>{var e,n,t,i,a,l,c,s,d,u;let{ammEnum:g,networkId:m}=(0,r.L)(),f=(0,A.Fg)(),{tab:h,position:x,trigger:v,positionDetails:k,tokenPrice:b,form:w,txForm:P,isSyncing:y,swapInfo:C,selectedSolver:T,suggestedSolver:S,gasEstimated:Z}=$(),R=[x.tokenA,x.tokenB],B=N.viem.getNativeCurrency(m),L=(0,j.useMemo)(()=>{var e,n,t,i;if((null==C?void 0:null===(e=C[T])||void 0===e?void 0:e.finalAmount0)!==void 0&&(null==C?void 0:null===(n=C[T])||void 0===n?void 0:n.finalAmount1)!==void 0&&k){let e=(0,er.b)(null==C?void 0:null===(t=C[T])||void 0===t?void 0:t.finalAmount0,k.token0.decimals),n=(0,er.b)(null==C?void 0:null===(i=C[T])||void 0===i?void 0:i.finalAmount1,k.token1.decimals);return{token0Amount:e,token1Amount:n,...(0,ee.zu)(e,n,b[0],b[1])}}if(!k)return{token0Amount:R[0].amount,token1Amount:R[1].amount,...(0,ee.zu)(x.tokenA.amount,x.tokenB.amount,b[0],b[1])};{let e=(0,p.UA)(m,x,k.position,w.priceRange.tickLower,w.priceRange.tickUpper,b,"Automated Rebalance"===h?w.trigger:void 0);return{token0Amount:e[0].amount,token1Amount:e[1].amount,token0Percent:e[0].percent,token1Percent:e[1].percent}}},[w.trigger,h,w.priceRange.tickLower,w.priceRange.tickUpper,C,T,b]),M=eK().tz.guess(),D=e=>{switch(e){case I.bso.MIN:return Y().compareTo(w.priceRange.swapMax,0)>0?(0,E.T4)(w.priceRange.min):"∞";case I.bso.MAX:return Y().compareTo(w.priceRange.swapMin,0)>0?(0,E.T4)(w.priceRange.max):"∞";case I.bso.SWAP_MIN:return Y().compareTo(w.priceRange.max,0)>0?(0,E.T4)(w.priceRange.swapMin):"∞";case I.bso.SWAP_MAX:return Y().compareTo(w.priceRange.min,0)>0?(0,E.T4)(w.priceRange.swapMax):"∞"}},q=e=>{if(w.futureSpotTab!==I.bR2.PERCENTAGES)return"-";switch(e){case I.bso.MIN:return"".concat(w.percentageRange.min,"%");case I.bso.MAX:return"".concat(w.percentageRange.max,"%");case I.bso.SWAP_MIN:return"".concat(w.percentageRange.swapMin,"%");case I.bso.SWAP_MAX:return"".concat(w.percentageRange.swapMax,"%")}},O="$".concat(F.NL," + ").concat(Y().multiply(F.In,100),"% of the swapped amount + ").concat(100*F.cO,"% of the reinvested amount.");return(0,o.jsxs)(e5,{children:["Automated Rebalance"===h&&(0,o.jsx)(I.R0C,{form:w.trigger,tokens:R}),(0,o.jsxs)(e6,{children:[(0,o.jsx)(nt,{children:"New Price Range"}),(0,o.jsx)(I.$15,{tabPosition:"left",buyToken:{ticker:R[0].ticker,max:w.useFutureSpot?q(I.bso.MAX):D(I.bso.MAX),min:w.useFutureSpot?q(I.bso.MIN):D(I.bso.MIN)},sellToken:{ticker:R[1].ticker,max:w.useFutureSpot?q(I.bso.SWAP_MAX):D(I.bso.SWAP_MAX),min:w.useFutureSpot?q(I.bso.SWAP_MIN):D(I.bso.SWAP_MIN)},futureSpotTab:w.useFutureSpot?w.futureSpotTab:void 0,style:{gap:16}})]}),("Rebalance"===h||!w.useFutureSpot)&&(0,o.jsxs)(ne,{children:[(0,o.jsxs)(nn,{children:[(0,o.jsx)(em,{children:"Projected Liquidity Position"}),(0,o.jsxs)("div",{children:[(0,o.jsx)(I.sXs,{Icon:R[0].Icon,ticker:R[0].ticker,address:R[0].address,native:R[0].native,decimals:R[0].decimals,amount:L.token0Amount,price:b[0],maxWidth:999,tag:"".concat(L.token0Percent,"%")},R[0].address),(0,o.jsx)(I.sXs,{Icon:R[1].Icon,ticker:R[1].ticker,address:R[1].address,native:R[1].native,decimals:R[1].decimals,amount:L.token1Amount,price:b[1],maxWidth:999,tag:"".concat(L.token1Percent,"%")},R[1].address)]})]}),(0,o.jsx)(I.Fgq,{text:"Any uncollected fees will be collected and reinvested into the new position after rebalance."})]}),(0,o.jsx)(eo.AX,{}),"Rebalance"===h&&(y||(null==C?void 0:null===(e=C[T])||void 0===e?void 0:null===(n=e.swapRoutes)||void 0===n?void 0:n.length)>0)&&(0,o.jsxs)(eo.rl,{children:[(0,o.jsx)(eo.Rw,{children:"Order Routing"}),(0,o.jsx)(I.Cy9,{maxWidth:571,loading:y||!C,priceImpact:null==C?void 0:null===(t=C[T])||void 0===t?void 0:t.priceImpact,api:null==C?void 0:null===(i=C[T])||void 0===i?void 0:i.api,fromToken:null==C?void 0:null===(a=C[T])||void 0===a?void 0:a.fromToken,routes:null!==(s=null==C?void 0:null===(l=C[T])||void 0===l?void 0:l.swapRoutes)&&void 0!==s?s:[],wBorder:!0,suggested:T===S})]}),(0,o.jsxs)(eo.rl,{gap:f.spacing.md,children:["Automated Rebalance"===h&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(no,{children:[(0,o.jsx)(eo.Wh,{children:"Gas Ceiling"}),(0,o.jsxs)(I.Bpc,{children:[Y().multiply(w.gasCeiling,100),"% of the position"]})]}),(0,o.jsxs)(I.tuJ,{gap:"md",children:[(0,o.jsxs)(no,{children:[(0,o.jsx)(eo.Wh,{children:"Trigger Expiration"}),(0,o.jsxs)(I.Bpc,{children:[V()().add(N.AUTOMATION_EXPIRATION_IN_DAYS,"days").format("MMM Do, YYYY")," ","(".concat(N.AUTOMATION_EXPIRATION_IN_DAYS," Days)")]})]}),(0,o.jsx)(eo.c_,{children:"".concat(M," (GMT").concat(eK().tz(M).format("Z"),")")})]})]}),("Rebalance"===h||!v)&&(0,o.jsxs)(o.Fragment,{children:["Rebalance"===h&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(I.kCb,{justifyContent:"space-between",children:[(0,o.jsx)(eo.Wh,{children:"Est. Total Gas Fee"}),(0,o.jsx)(ni,{children:"".concat(null!==(d=Z&&(0,er.b)(Z,B.decimals))&&void 0!==d?d:"-"," ").concat(B.symbol)})]}),(0,o.jsxs)(I.kCb,{justifyContent:"space-between",children:[(0,o.jsx)(eo.Wh,{children:"Slippage Setting"}),(0,o.jsxs)(ni,{children:[Math.floor(1e4*P.slippage)/100,"%"]})]})]}),(0,o.jsx)(I.oLF,{styles:{size:"lg"},amm:g,feeInfo:{fee:F.In,amount:(0,p.bp)(R[0].amount,R[1].amount,b[0],b[1]),feeUSD:"Rebalance"===h?"".concat((0,I.oSm)(null!==(u=null==C?void 0:null===(c=C[T])||void 0===c?void 0:c.feeUSD)&&void 0!==u?u:"-")):O,active:!0},hint:"Rebalance"===h?"Aperture charges ".concat(O):""})]})]})]})},na=e=>{let{details:n,goto:t,tabs:i,trigger:r,navBack:a}=e,[l,c]=(0,j.useState)("edit"),s=(0,j.useCallback)(()=>t.details(),[t]);return(0,o.jsx)(K,{tabs:i,position:n,trigger:r,children:(0,o.jsxs)(eV,{mode:l,onClose:s,navBack:a,onModeChange:e=>c(e),children:["edit"===l&&(0,o.jsx)(ej,{}),"preview"===l&&(0,o.jsx)(nr,{})]})})};var nl=t(66360),nc=t(42732);let ns=j.createContext(null),nd=e=>{var n,t,i,a;let{children:l,position:c,...s}=e,{ammEnum:d,networkId:u,publicClient:g}=(0,r.L)(),{address:m}=(0,P.m)(),[,h]=(0,j.useTransition)(),{currentTokenPrice:x}=(0,R.P)(u),{data:v}=(0,nc.u)(),{globalSlippage:k}=(0,C.DK)(),{data:b}=(0,L.GB)(),w=(0,nl.X)(c.positionId,c.chainId),[I,A]=(0,j.useState)(null),[y,S]=(0,j.useState)(null),Z=null!==(i=null==x?void 0:null===(n=x[c.tokenA.address])||void 0===n?void 0:n.price)&&void 0!==i?i:"0",M=null!==(a=null==x?void 0:null===(t=x[c.tokenB.address])||void 0===t?void 0:t.price)&&void 0!==a?a:"0",D=(0,j.useMemo)(()=>[Z,M],[Z,M]),E={tokenA:(0,ee.NO)(c.tokenA.address,c.chainId),tokenB:(0,ee.NO)(c.tokenB.address,c.chainId)},q=(0,j.useMemo)(()=>({poolTokens:[null==b?void 0:b["".concat(c.tokenA.address,"-false")],null==b?void 0:b["".concat(c.tokenB.address,"-false")]],poolTokensToNative:[null==b?void 0:b["".concat(c.tokenA.address,"-").concat(E.tokenA)],null==b?void 0:b["".concat(c.tokenB.address,"-").concat(E.tokenB)]]}),[b]),[O,_]=(0,j.useState)({tokenA:"",tokenB:"",useNative:E.tokenA||E.tokenB}),U=(0,z.Z)(O,{wait:500}),W=(0,j.useMemo)(()=>{var e,n,t,i;return b?O.useNative?q.poolTokensToNative:q.poolTokens:[{...c.tokenA,price:(null==x?void 0:null===(e=x[c.tokenA.address])||void 0===e?void 0:e.price)||"0",amount:(null==v?void 0:null===(n=v[c.tokenA.address])||void 0===n?void 0:n.balance)||"0"},{...c.tokenB,price:(null==x?void 0:null===(t=x[c.tokenB.address])||void 0===t?void 0:t.price)||"0",amount:(null==v?void 0:null===(i=v[c.tokenB.address])||void 0===i?void 0:i.balance)||"0"}]},[O.useNative,q]),X=(0,j.useMemo)(()=>{let e=Y().compareTo(U.tokenA,"0")>0,n=Y().compareTo(U.tokenB,"0")>0;return e||n},[U]),G=null===y&&X,H=(0,p.bp)(c.tokenA.amount,c.tokenB.amount,D[0],D[1]),V=(0,p.bp)(c.tokenA.collectableAmount,c.tokenB.collectableAmount,D[0],D[1]),[J,K]=(0,j.useState)({slippage:null!=k?k:F.zI,deadline:"30"}),[$,Q]=(0,j.useState)(void 0),[en,et]=(0,j.useState)(void 0),[ei,eo]=(0,j.useState)({amount0Min:"0",amount1Min:"0"}),[ea,el]=(0,j.useState)(void 0),ec="SLIPSTREAM"===d?c.tickSpacing:c.feeTier;(0,j.useEffect)(()=>{c.tokenA.address&&c.tokenB.address&&ec?N.viem.getPool(c.tokenA.address,c.tokenB.address,ec,c.chainId,d,g).then(e=>{A(e)}).catch(e=>{(0,N.getLogger)().error("AddLPV2.getPoolFailed: ",{ammEnum:d,networkId:c.chainId,tokenA:c.tokenA.address,tokenB:c.tokenB.address,poolKey:ec,error:JSON.stringify(e)}),S("Token pair not supported"),A(null)}):(S("Token pair not supported"),A(null))},[]),(0,T.o)(()=>{ek()});let{swapInfo:es,selectedSolver:ed,suggestedSolver:eu,setSelectedSolver:ep,noNeedSwap:eg}=(0,C.Dn)(),{isSyncing:em,setIsSyncing:ef,isSyncingTx:eh,setIsSyncingTx:ex,runSwapInfo:ev,cancelSwapInfo:ek,swapInfoError:eb}=(0,B.o)();(0,j.useEffect)(()=>{ef(!0);let e=[""!==O.tokenA?O.tokenA:"0",""!==O.tokenB?O.tokenB:"0"];if(0===Y().compareTo(e[0],0)&&0===Y().compareTo(e[1],0))ek();else{let n="".concat(d,"-").concat(u,"-").concat(m)+":".concat(c.positionId)+":".concat(J.slippage,"_").concat(J.deadline)+":[".concat(e[0],",").concat(e[1],"]");ev({type:"IncreaseLiquidity",positionId:c.positionId,slippage:J.slippage,tokenMap:b,fetchKey:n,options:{pool:I,deadline:Number(J.deadline),amounts:e}})}},[O.tokenA,O.tokenB,d,u,m,I,c,J,b,ef,ev,ek]);let ew=(0,f.$)(e=>{(0,eB.Q)(e,u,g).then(n=>{let{l2GasAmount:t,totalGasCost:i,gasCost:o}=n;el(null!=i?i:o),et({...e,gas:(0,F.yC)(t)}),Q(void 0)}).catch(e=>{(0,N.getLogger)().error("AddLPV2.getIncreaseLiquidityV3TxEstimateGasFailed: ",{ammEnum:d,networkId:u,address:m,positionId:c.positionId,pool:I,amounts:[O.tokenA,O.tokenB],slippage:J.slippage,deadline:J.deadline,error:e.message}),ek(),el(void 0),Q(e.details)}).finally(()=>ex(!1))}),eI=()=>{ex(!1),h(()=>{eo({amount0Min:"0",amount1Min:"0"}),el(void 0)})},ej=(0,j.useCallback)(async e=>{let n=Number(J.deadline||30);eg?null===y&&(0,p.$6)(d,u,c,I,J.slippage,n,[O.tokenA,O.tokenB],m,g,O.useNative).then(e=>{ew(e),Q(void 0)}).catch(e=>{(0,N.getLogger)().error("AddLPV2.getAddPositionRequestFailed: ",{ammEnum:d,networkId:u,position:c,pool:I,slippage:J.slippage,amounts:[O.tokenA,O.tokenB],address:m,useNative:O.useNative,error:JSON.stringify(e)}),Q("Failed to generate transaction"),ek()}).finally(()=>ef(!1)):e&&G?e&&(0,p.Zo)(d,u,m,c.positionId,I,J.slippage,n,[O.tokenA,O.tokenB],null==e?void 0:e.swapDataHex,null==e?void 0:e.liquidity,g,null==e?void 0:e.token0FeeAmount,null==e?void 0:e.token1FeeAmount,O.useNative).then(e=>{let{tx:n,amounts:t}=e;eo({amount0Min:(0,er.b)(BigInt(t.amount0Min),c.tokenA.decimals),amount1Min:(0,er.b)(BigInt(t.amount1Min),c.tokenB.decimals)}),ew(n)}).catch(n=>{(0,N.getLogger)().error("AddLPV2.getIncreaseLiquidityOptimalV3TxFailed: ",{ammEnum:d,networkId:u,address:m,positionId:c.positionId,pool:I,slippage:J.slippage,amounts:[O.tokenA,O.tokenB],swapDataHex:null==e?void 0:e.swapDataHex,liquidity:null==e?void 0:e.liquidity,useNative:O.useNative,error:JSON.stringify(n)}),Q("Failed to generate transaction"),ek()}):eI()},[O,J,y,G]);return(0,j.useEffect)(()=>{(null==es?void 0:es.length)?-1!==ed&&ej(es[ed]):eI()},[es,ed]),(0,o.jsx)(ns.Provider,{value:{tokenPairPrice:D,form:O,isTokenNonZero:X,showSwapPath:G,position:c,pool:I,liquidityInUS:H,collectableInUS:V,txnSetting:J,error:y,autoCompoundExists:!!w,isSyncing:em,setIsSyncing:ef,isSyncingTx:eh,swapInfo:es,swapInfoError:eb,runSwapInfo:ev,cancelSwapInfo:ek,suggestedSolver:eu,selectedSolver:ed,setSelectedSolver:ep,tokens:W,txErrorMsg:$,txRequest:en,minAmounts:ei,gasEstimated:ea,setForm:_,setTxnSetting:K,setError:S,...s},children:l})},nu=()=>j.useContext(ns);var np=t(89192);function ng(){let e=(0,i.Z)(["\n  padding: 0;\n  display: flex;\n  align-items: center;\n  color: ",";\n"]);return ng=function(){return e},e}let nm=(0,A.ZP)(I.nnA).withConfig({componentId:"sc-b8d4d7b-0"})(ng(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),nf=e=>{let{text:n,nativeChange:t,...i}=e,[a,l]=(0,j.useState)(!0),{networkId:c}=(0,r.L)(),s=N.viem.getNativeCurrency(c);return(0,o.jsxs)(nm,{...i,children:[(0,o.jsx)(I.mGS,{noText:!0,onChange:e=>{l(e),t(e)},onStatus:a}),n," any ",s.wrapped.symbol," as ",s.symbol]})};var nh=t(97163),nx=t(5685),nv=t(47983),nk=t(38547);function nb(){let e=(0,i.Z)(["\n  margin: 32px 0;\n  align-items: center;\n  gap: ",";\n"]);return nb=function(){return e},e}function nw(){let e=(0,i.Z)(["\n  color: ",";\n"]);return nw=function(){return e},e}let nI=(0,A.ZP)(nv.tu).withConfig({componentId:"sc-71e742a0-0"})(nb(),e=>{let{theme:n}=e;return n.spacing["3xl"]}),nj=(0,A.ZP)(nk.T2).withConfig({componentId:"sc-71e742a0-1"})(nw(),e=>{let{theme:n}=e;return n.colors.global.text.T3}),nA=e=>{var n,t;let{hide:i,keepDropdown:r}=e,a=(0,A.Fg)(),{staked:l}=(0,s.i)(),{form:c,isSyncing:d,isSyncingTx:u,swapInfoError:g}=nu(),{swapInfo:m,selectedSolver:f,suggestedSolver:h,noNeedSwap:x}=(0,C.Dn)(),{handleChangeAPI:v}=(0,Q.nK)(),k=null==m?void 0:m[f];return(d||u||k||g)&&!i?d||u||!x?(0,o.jsx)(I.oXX,{maxSwapRouteWidth:562,style:{marginTop:8},loading:d||u,priceImpact:null==k?void 0:k.priceImpact,api:null==k?void 0:k.api,fromToken:null==k?void 0:k.fromToken,swapData:null==k?void 0:k.swapData,swapRoutes:null==k?void 0:k.swapRoutes,showSwapRoutes:(null==k?void 0:null===(n=k.swapRoutes)||void 0===n?void 0:n.length)>0,errorMsg:(0,p._M)(m,g,null!==(t=c.netDepositUSDValue)&&void 0!==t?t:"0",l),onBtnClick:v,suggested:f===h,gasFeeUSD:null==k?void 0:k.gasFeeUSD,keepDropdown:r,feeUSD:null==k?void 0:k.feeUSD,feePercentage:100*F.IT,atStake:l}):(0,o.jsxs)(nI,{children:[(0,o.jsx)(w.J9,{fill:a.colors.global.text.T1}),(0,o.jsx)(nj,{children:"No need to swap"})]}):null};function nP(){let e=(0,i.Z)(["\n  cursor: ",";\n"]);return nP=function(){return e},e}function ny(){let e=(0,i.Z)(["\n  color: ",";\n"]);return ny=function(){return e},e}function nC(){let e=(0,i.Z)(["\n  margin-top: 4px;\n"]);return nC=function(){return e},e}function nT(){let e=(0,i.Z)(["\n  padding: 2px 12px;\n  border-radius: ",";\n  color: ",";\n  background: ",";\n"]);return nT=function(){return e},e}let nS=(0,A.ZP)(nx.kC).withConfig({componentId:"sc-daa1c000-0"})(nP(),e=>{let{disabled:n}=e;return n?"auto":"pointer"}),nZ=(0,A.ZP)(nx.OR).withConfig({componentId:"sc-daa1c000-1"})(ny(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),nR=A.ZP.div.withConfig({componentId:"sc-daa1c000-2"})(nC()),nB=(0,A.ZP)(nx.OR).withConfig({componentId:"sc-daa1c000-3"})(nT(),e=>{let{theme:n}=e;return n.radii.md},e=>{let{theme:n}=e;return n.colors.global.warning},e=>{let{theme:n}=e;return n.isDark?"rgba(237,156,0,0.1)":"rgba(202,109,0,0.2)"}),nL=e=>{let{setTokenAAmount:n,setTokenBAmount:t}=e,[i,r]=(0,j.useState)(!0),{staked:a}=(0,s.i)(),{position:l,pool:c,tokenPairPrice:d,form:u,setForm:g,isSyncing:m,isSyncingTx:f,swapInfoError:h,txErrorMsg:x}=nu(),{swapInfo:v}=(0,C.Dn)(),k=(0,j.useMemo)(()=>{var e;if(!m&&!f)return(0,p._M)(v,null!=h?h:x,null!==(e=u.netDepositUSDValue)&&void 0!==e?e:"0",a)},[u.netDepositUSDValue,m,f,a,v,h,x]),b=k===p.Vs,w=e=>{g(e)},A=(e,i)=>{let o="",r="";""!==e&&Number(e)>=0&&(i?(o=e,(null==c?void 0:c.tickCurrent)>l.tickLower&&(r=(0,p.ye)(l.tokenA.address,e,l.tickLower,l.tickUpper,c).toExact())):(r=e,(null==c?void 0:c.tickCurrent)<l.tickUpper&&(o=(0,p.ye)(l.tokenB.address,e,l.tickLower,l.tickUpper,c).toExact()))),n(o),t(r);let a=Y().add(Y().multiply(o,d[0]),Y().multiply(r,d[1]));w({...u,tokenA:o,tokenB:r,netDepositUSDValue:a})};return(0,o.jsxs)(nR,{children:[(0,o.jsxs)(nS,{width:"100%",justifyContent:"space-between",disabled:!!k,onClick:()=>!k&&r(!i),children:[(0,o.jsx)(nZ,{children:"Swap Details"}),(0,o.jsxs)(nx.kC,{alignItems:"center",gap:8,children:[i&&(m||f)&&(0,o.jsx)(nx.Dr,{width:16,height:16}),k&&(0,o.jsx)(nB,{children:k}),!k&&(0,o.jsx)(I._ME,{isShow:!i})]})]}),!k&&(0,o.jsx)(nA,{hide:i,keepDropdown:!0}),b&&(0,o.jsx)(nh.sw,{tokenA:l.tokenA.ticker,tokenB:l.tokenB.ticker,disableA:0>=Y().compareTo(u.tokenB,0),disableB:0>=Y().compareTo(u.tokenA,0),onAlignTokenA:()=>A(u.tokenB,!1),onAlignTokenB:()=>A(u.tokenA,!0),isAddLP:!0})]})};var nN=t(96266);function nM(){let e=(0,i.Z)(["\n  box-sizing: border-box;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return nM=function(){return e},e}function nD(){let e=(0,i.Z)(["\n  gap: ",";\n"]);return nD=function(){return e},e}function nF(){let e=(0,i.Z)(["\n  height: fit-content;\n  display: flex;\n  flex-direction: column;\n  white-space: nowrap;\n  color: ",";\n  gap: ",";\n  border: ",";\n  padding: ",";\n  ","\n  border-radius: ",";\n"]);return nF=function(){return e},e}function nE(){let e=(0,i.Z)(["\n  display: flex;\n  justify-content: space-between;\n  gap: ",";\n"]);return nE=function(){return e},e}function nq(){let e=(0,i.Z)(["\n  padding: 16px;\n  height: 116px;\n  min-width: 260px;\n  border: 1px solid ",";\n  border-radius: ",";\n"]);return nq=function(){return e},e}function nO(){let e=(0,i.Z)(["\n  font-size: 24px;\n  line-height: 28px;\n  color: ",";\n"]);return nO=function(){return e},e}function nz(){let e=(0,i.Z)(["\n  color: ",";\n  display: flex;\n  align-items: center;\n  span:first-child {\n    margin-right: 4px;\n    white-space: nowrap;\n    font-weight: 400;\n    line-height: 20px;\n  }\n  > div {\n    margin-left: auto;\n  }\n"]);return nz=function(){return e},e}function n_(){let e=(0,i.Z)(["\n  color: ",";\n"]);return n_=function(){return e},e}function nU(){let e=(0,i.Z)(["\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: ",";\n"]);return nU=function(){return e},e}function nW(){let e=(0,i.Z)(["\n  width: ",";\n"]);return nW=function(){return e},e}function nY(){let e=(0,i.Z)(["\n  margin-bottom: 35px;\n"]);return nY=function(){return e},e}function nX(){let e=(0,i.Z)(["\n  width: 220px;\n"]);return nX=function(){return e},e}function nG(){let e=(0,i.Z)(["\n  display: flex;\n  height: 38px;\n  justify-content: center;\n  align-items: center;\n  padding: 0 16px;\n  background: ",";\n  border-radius: ",";\n  cursor: pointer;\n"]);return nG=function(){return e},e}function nH(){let e=(0,i.Z)(["\n  width: 24px;\n  height: 24px;\n  line-height: 24px;\n  align-items: center;\n  text-align: center;\n  color: ",";\n"]);return nH=function(){return e},e}function nV(){let e=(0,i.Z)(["\n  width: calc(100% - 24px);\n  padding: 8px 12px 0;\n"]);return nV=function(){return e},e}function nJ(){let e=(0,i.Z)(["\n  display: flex;\n  gap: ",";\n"]);return nJ=function(){return e},e}function nK(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  padding: ",";\n\n  & > div:first-child {\n    padding-bottom: ",";\n    border-bottom: 1px solid ",";\n  }\n\n  & > div:last-child {\n    padding-top: ",";\n    border-bottom: none !important;\n  }\n"]);return nK=function(){return e},e}function n$(){let e=(0,i.Z)(["\n  display: flex;\n  justify-content: space-between;\n  gap: ",";\n"]);return n$=function(){return e},e}function nQ(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return nQ=function(){return e},e}function n0(){let e=(0,i.Z)(["\n  padding: 0;\n  border: 1px solid ",";\n  border-radius: ",";\n"]);return n0=function(){return e},e}let n1=A.ZP.div.withConfig({componentId:"sc-82aeb979-0"})(nM(),e=>{let{theme:n}=e;return n.spacing.xl}),n2=(0,A.ZP)(eo.X2).withConfig({componentId:"sc-82aeb979-1"})(nD(),e=>{let{theme:n}=e;return n.spacing.xl}),n4=(0,A.ZP)(eo._r).withConfig({componentId:"sc-82aeb979-2"})(nF(),e=>{let{theme:n}=e;return n.colors.global.text.T2},e=>{let{gap:n}=e;return n||"0px"},e=>{let{noBorder:n,theme:t}=e;return n?"none":"1px solid ".concat(t.colors.global.line.Line2)},e=>{let{theme:n,padding:t}=e;return t||n.spacing.xl},e=>{let{minWidth:n}=e;return n&&"min-width: ".concat(n,";")},e=>{let{theme:n}=e;return n.radii.md}),n8=(0,A.ZP)(eo._r).withConfig({componentId:"sc-82aeb979-3"})(nE(),e=>{let{theme:n}=e;return n.spacing.lg}),n9=A.ZP.div.withConfig({componentId:"sc-82aeb979-4"})(nq(),e=>{let{theme:n}=e;return n.colors.global.line.Line2},e=>{let{theme:n}=e;return n.radii.xl}),n3=(0,A.ZP)(I.ayo).withConfig({componentId:"sc-82aeb979-5"})(nO(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),n7=(0,A.ZP)(I.Bpc).withConfig({componentId:"sc-82aeb979-6"})(nz(),e=>{let{theme:n}=e;return n.colors.global.text.T2}),n5=(0,A.ZP)(I.T59).withConfig({componentId:"sc-82aeb979-7"})(n_(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),n6=(0,A.ZP)(I.ayo).withConfig({componentId:"sc-82aeb979-8"})(nU(),e=>{let{theme:n}=e;return n.colors.global.text.T1});(0,A.ZP)(eo._r).withConfig({componentId:"sc-82aeb979-9"})(nW(),e=>{let{tab:n}=e;return"Rebalance"===n?"100%":"463px"}),(0,A.ZP)(nN.i).withConfig({componentId:"sc-82aeb979-10"})(nY()),(0,A.ZP)(I.qmJ).withConfig({componentId:"sc-82aeb979-11"})(nX()),A.ZP.div.withConfig({componentId:"sc-82aeb979-12"})(nG(),e=>{let{theme:n}=e;return n.colors.primary.purple},e=>{let{theme:n}=e;return n.radii.round}),(0,A.ZP)(I.oD).withConfig({componentId:"sc-82aeb979-13"})(nH(),e=>{let{theme:n}=e;return n.colors.grey.white}),(0,A.ZP)(I.sXs).withConfig({componentId:"sc-82aeb979-14"})(nV());let te=A.ZP.div.withConfig({componentId:"sc-82aeb979-15"})(nJ(),e=>{let{theme:n}=e;return n.spacing.xl}),tn=A.ZP.div.withConfig({componentId:"sc-82aeb979-16"})(nK(),e=>{let{theme:n}=e;return n.spacing.xl},e=>{let{zapIn:n}=e;return n?"12px":"0"},e=>{let{theme:n}=e;return n.colors.global.line.Line2},e=>{let{zapIn:n}=e;return n?"12px":"0"}),tt=A.ZP.div.withConfig({componentId:"sc-82aeb979-17"})(n$(),e=>{let{theme:n}=e;return n.spacing.xl});A.ZP.div.withConfig({componentId:"sc-82aeb979-18"})(nQ(),e=>{let{theme:n}=e;return n.spacing.xl});let ti=(0,A.ZP)(I.nnA).withConfig({componentId:"sc-82aeb979-19"})(n0(),e=>{let{theme:n}=e;return n.colors.global.line.Line2},e=>{let{theme:n}=e;return n.radii.xl}),to=()=>{var e,n,t,i,a,l,c,s,d;let{position:u,autoCompoundExists:g,isTokenNonZero:m,form:f,tokenPairPrice:h,collectableInUS:x,liquidityInUS:v,tokens:k,txnSetting:b,setForm:w,setError:P}=nu(),{noNeedSwap:y}=(0,C.Dn)(),T=(0,A.Fg)(),{ammEnum:S,networkId:Z}=(0,r.L)(),[R,B]=j.useState(f.tokenA),[L,M]=j.useState(f.tokenB),[D,F]=(0,j.useState)(null!==(l=null===(e=u.tokenA)||void 0===e?void 0:e.native)&&void 0!==l&&l),[q,O]=(0,j.useState)(null!==(c=null===(n=u.tokenB)||void 0===n?void 0:n.native)&&void 0!==c&&c),z=(0,j.useRef)(null),_=(0,j.useMemo)(()=>{var e,n;return[Y().compareTo(R,null===(e=k[0])||void 0===e?void 0:e.amount)>0,Y().compareTo(L,null===(n=k[1])||void 0===n?void 0:n.amount)>0]},[R,L,k]),U=(0,j.useMemo)(()=>(!!f.tokenA||!!f.tokenB)&&(!f.tokenA||D)&&(!f.tokenB||q),[D,q,f.tokenA,f.tokenB]);(0,j.useEffect)(()=>{var e,n;_[0]?P("Insufficient ".concat(null===(e=k[0])||void 0===e?void 0:e.ticker," Balance")):_[1]?P("Insufficient ".concat(null===(n=k[1])||void 0===n?void 0:n.ticker," Balance")):U?P(null):P("")},[f,D,q,_,k,b]);let W=e=>{w(e)},X=(e,n)=>{let t=n?e:f.tokenA,i=n?f.tokenB:e;B(t),M(i);let o=Y().add(Y().multiply(t,h[0]),Y().multiply(i,h[1]));W({...f,tokenA:t,tokenB:i,netDepositUSDValue:o})};(0,j.useEffect)(()=>{z.current&&z.current.offsetHeight&&!(D&&q)&&z.current.scrollIntoView()},[null==z?void 0:null===(t=z.current)||void 0===t?void 0:t.offsetHeight,D,q]);let G=y?null===(i=(0,N.getChainInfo)(Z).amms[S])||void 0===i?void 0:i.nonfungiblePositionManager:null===(a=(0,N.getChainInfo)(Z).amms[S])||void 0===a?void 0:a.apertureAutomanV3;return(0,o.jsxs)(n1,{children:[(0,o.jsxs)(n2,{children:[(0,o.jsx)(n9,{children:(0,o.jsxs)(n4,{gap:T.spacing.lg,noBorder:!0,padding:"0",children:[(0,o.jsxs)(I.tuJ,{gap:"md",children:[(0,o.jsx)(n7,{fontWeight:400,fontSize:14,children:"Liquidity"}),(0,o.jsx)(n3,{children:(0,E.oS)(v)})]}),[u.tokenA,u.tokenB].map((e,n)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:e.ticker,address:e.address,native:e.native,decimals:e.decimals,amount:e.amount,maxWidth:999,marginBottom:0,price:h[n],tag:"-"===v||0===Y().compareTo(v,0)?"-":"".concat(Y().multiply(Y().divide(Y().multiply(e.amount,h[n]),v,2),100),"%")},"liquidity-".concat(n)))]})}),(0,o.jsx)(n9,{children:(0,o.jsxs)(n4,{padding:"0",gap:T.spacing.lg,noBorder:!0,children:[(0,o.jsxs)(I.tuJ,{gap:"md",children:[(0,o.jsxs)(n7,{fontWeight:400,fontSize:14,children:[(0,o.jsx)("span",{children:"Unclaimed Fees"}),g&&(0,o.jsx)(I.AgL,{autoCompound:!0})]}),(0,o.jsx)(n3,{children:(0,E.oS)(x)})]}),[u.tokenA,u.tokenB].map((e,n)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:e.ticker,address:e.address,decimals:e.decimals,native:e.native,amount:e.collectableAmount,maxWidth:999,marginBottom:0,price:h[n]},"unclaimed-fees-".concat(n)))]})})]}),(0,o.jsxs)(I.tuJ,{gap:"xl",children:[(0,o.jsx)(n5,{children:"Add Liquidity"}),(0,o.jsxs)(I.tuJ,{gap:"xl",children:[(0,o.jsx)(I.tuJ,{gap:"xl",children:(0,o.jsx)(n8,{children:k.map((e,n)=>(0,o.jsx)(I.ZFv,{placeholder:"0.00",defaultValue:0===n?R:L,subTitle:""===h[n]?"-":Y().multiply(0===n?R:L,h[n]),balance:null!==(s=e.amount)&&void 0!==s?s:"0",displayBalance:e.formatAmount,onChange:e=>{X(e,0===n)},onMaxClick:e=>{X(e,0===n)},warning:_[n]||!!(0===n?R:L)&&0>=Y().compareTo(0===n?R:L,"0")&&!(Y().compareTo(0===n?L:R,"0")>0),ticker:e.ticker},"zapIn-".concat(e.address)))})}),m&&(0,o.jsx)(nL,{setTokenAAmount:B,setTokenBAmount:M})]})]}),((0,ee.NO)(u.tokenA.address,Z)||(0,ee.NO)(u.tokenB.address,Z))&&(0,o.jsx)(nf,{text:"Deposit",nativeChange:e=>{W({...f,useNative:e})}}),(0,o.jsx)(eo.AX,{}),(0,o.jsxs)(I.tuJ,{gap:"lg",children:[(0,o.jsx)(n7,{fontSize:14,lineHeight:"16px",children:"Net Deposit Amount"}),(0,o.jsx)(n6,{fontSize:24,lineHeight:"28px",children:(0,E.oS)((0,p.bp)(R,L,h[0],h[1]))})]}),(0,o.jsx)(te,{ref:z,children:k.map((e,n)=>!!(0===n?R:L)&&(0,o.jsx)(np.B,{token:e,variant:"outlined",color:"secondary",contractAddress:G,amount:null!==(d=0===n?R:L)&&void 0!==d?d:"0",canBeZero:!!(0===n?R:L),approveOnChange:e=>0===n?F(e):O(e),useNative:null==e?void 0:e.native},"ApprovalStatus-".concat(null==e?void 0:e.address)))})]})};function tr(){let e=(0,i.Z)(["\n  background: ",";\n  color: ",";\n  min-width: 300px;\n\n  :hover {\n    background-color: ",";\n    ","\n  }\n"]);return tr=function(){return e},e}function ta(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  gap: ",";\n"]);return ta=function(){return e},e}function tl(){let e=(0,i.Z)(["\n  overflow-y: auto;\n  scrollbar-width: none;\n  height: ",";\n"]);return tl=function(){return e},e}function tc(){let e=(0,i.Z)(["\n  width: ",";\n"]);return tc=function(){return e},e}function ts(){let e=(0,i.Z)(["\n  padding-bottom: 24px;\n  display: flex;\n  align-items: center;\n  width: ",";\n  justify-content: flex-end;\n  box-sizing: border-box;\n  gap: ",";\n"]);return ts=function(){return e},e}function td(){let e=(0,i.Z)(["\n  margin: auto;\n"]);return td=function(){return e},e}t(9587),(0,A.ZP)(I.zxk).withConfig({componentId:"sc-d54b7c2e-0"})(tr(),e=>{let{theme:n}=e;return n.colors.global.primary},e=>{let{theme:n}=e;return n.colors.global.textAlt.T1},e=>{let{theme:n}=e;return n.colors.global.primary},e=>{let{disabled:n}=e;return!n&&"opacity: 0.8;"}),A.ZP.div.withConfig({componentId:"sc-11f6b938-0"})(ta(),e=>{let{theme:n}=e;return n.spacing["2xl"]}),A.ZP.div.withConfig({componentId:"sc-11f6b938-1"})(tl(),e=>{let{mode:n}=e;return"edit"===n?"calc(100% - 168px)":"calc(100% - 156px)"}),A.ZP.div.withConfig({componentId:"sc-11f6b938-2"})(tc(),I.mTC),A.ZP.div.withConfig({componentId:"sc-11f6b938-3"})(ts(),I.mTC,e=>{let{theme:n}=e;return n.spacing.xl});let tu=A.ZP.div.withConfig({componentId:"sc-11f6b938-4"})(td());function tp(){let e=(0,i.Z)(["\n  background: ",";\n  color: ",";\n  min-width: 300px;\n\n  :hover {\n    background-color: ",";\n    ","\n  }\n"]);return tp=function(){return e},e}let tg=(0,A.ZP)(I.zxk).withConfig({componentId:"sc-3134704a-0"})(tp(),e=>{let{theme:n}=e;return n.colors.global.primary},e=>{let{theme:n}=e;return n.colors.global.textAlt.T1},e=>{let{theme:n}=e;return n.colors.global.primary},e=>{let{disabled:n}=e;return!n&&"opacity: 0.8;"}),tm=e=>{let{onModeChange:n,onClose:t}=e,{addSnackbar:i}=(0,u.D)(),{addPositionSnackbar:a}=(0,eL.A)(),{address:l}=(0,P.m)(),{ammEnum:c,networkId:s}=(0,r.L)(),{position:d,showSwapPath:p,txRequest:g,txErrorMsg:m,isSyncing:f,isSyncingTx:h,swapInfo:x,cancelSwapInfo:v}=nu(),{ready:k,data:b,sendTransaction:w,isError:A,error:y,isPending:C,isSuccess:T}=(0,eN.i)(g);(0,j.useEffect)(()=>{A&&((0,N.getLogger)().error("AddLPV2.ConfirmAddLPFailed: ",{walletAddress:l,ammEnum:c,networkId:s,positionId:d.positionId,txRequest:g,swapInfo:x,hash:b,txErrorMsg:m,error:y}),i("Your add liquidity request has failed.","failed"),n("edit"))},[A]),(0,j.useEffect)(()=>{T&&((0,N.getLogger)().info("AddLPV2.ConfirmAddLPSuccess",{positionId:d.positionId,hash:b,txRequest:g}),a({info:"Your add liquidity request has been sent.",status:"completed",url:void 0,transaction:{hash:b,successMsg:"You have successfully added liquidity to your ".concat(d.tokenA.ticker,"-").concat(d.tokenB.ticker," position.")}}),v(),t())},[T]);let S=p&&(!x||0===x.length);return(0,o.jsx)(tg,{onClick:()=>null==w?void 0:w(),disabled:!g||!k||!!m||C||T||f||h||S,variant:"contained",color:"primary",size:"lg",children:C||f||h?(0,o.jsx)(tu,{children:(0,o.jsx)(I.$jN,{})}):m||(S?"Swap Info Unavailable":"Confirm Add Liquidity")})};function tf(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  gap: ",";\n"]);return tf=function(){return e},e}function th(){let e=(0,i.Z)(["\n  overflow-y: auto;\n  scrollbar-width: none;\n  height: ",";\n"]);return th=function(){return e},e}function tx(){let e=(0,i.Z)(["\n  width: ",";\n"]);return tx=function(){return e},e}function tv(){let e=(0,i.Z)(["\n  padding-bottom: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  box-sizing: border-box;\n  gap: ",";\n  width: ",";\n"]);return tv=function(){return e},e}function tk(){let e=(0,i.Z)(["\n  margin: auto;\n"]);return tk=function(){return e},e}let tb=A.ZP.div.withConfig({componentId:"sc-f878c7e2-0"})(tf(),e=>{let{theme:n}=e;return n.spacing["2xl"]}),tw=A.ZP.div.withConfig({componentId:"sc-f878c7e2-1"})(th(),e=>{let{mode:n}=e;return"edit"===n?"calc(100% - 168px)":"calc(100% - 156px)"}),tI=A.ZP.div.withConfig({componentId:"sc-f878c7e2-2"})(tx(),I.mTC),tj=A.ZP.div.withConfig({componentId:"sc-f878c7e2-3"})(tv(),e=>{let{theme:n}=e;return n.spacing.xl},I.mTC),tA=A.ZP.div.withConfig({componentId:"sc-f878c7e2-4"})(tk()),tP=e=>{let{mode:n,children:t,onClose:i,onModeChange:a}=e,{networkId:l}=(0,r.L)(),{globalSlippage:c,setGlobalSlippage:d}=(0,C.DK)(),{position:u,showSwapPath:p,txnSetting:g,setTxnSetting:m,error:f,isSyncing:h,isSyncingTx:x,swapInfo:v}=nu(),{mutate:b}=(0,k.F)(),{stakePool:w,staked:j,setStaked:A}=(0,s.i)();return(0,o.jsxs)(tb,{children:[(0,o.jsx)(eo.Dx,{onClick:()=>{"edit"===n?i():a("edit")},children:(0,o.jsx)(I.iIr,{isDrawer:!0,children:(0,o.jsx)(I.Bpc,{fontWeight:500,textAlign:"end",children:"Back to Dashboard"})})}),"preview"===n&&(0,o.jsx)(eo.eN,{children:"Preview Add Liquidity"}),"edit"===n&&(0,o.jsx)(eo.eN,{children:"Add Liquidity"}),(0,o.jsx)(tw,{mode:n,children:(0,o.jsx)(tI,{children:t})}),(0,o.jsxs)(tj,{children:[(0,o.jsx)(I.oVd,{defaultSlippage:F.zI,globalSlippage:c,warningSlippage:F.NX,settingsForm:g,dropdownPosition:"topRight",onFormChange:e=>m(e),buttonSize:"small",setGlobalSlippage:e=>d(n=>({...n,[l]:e}))}),(0,o.jsx)(I.zxk,{variant:"contained",color:"default",size:"lg",width:"100%",onClick:()=>{"edit"===n?i():a("edit")},children:"Cancel"}),"edit"===n&&(w&&j?(0,o.jsx)(eA.B,{atStake:j,gaugeAddress:w.gaugeAddress,positionId:u.positionIdBN,handleTxSuccess:()=>{A(!1),b()}},u.positionId):(0,o.jsx)(I.zxk,{variant:"contained",color:"secondary",size:"lg",width:"100%",disabled:"string"==typeof f||h||x||!p||p&&(!v||0===v.length),onClick:()=>{a("preview")},children:f||(h||x?(0,o.jsx)(tA,{children:(0,o.jsx)(I.$jN,{})}):"Add Liquidity")})),"preview"===n&&(0,o.jsx)(tm,{onModeChange:a,onClose:i})]})]})},ty=()=>{var e,n,t;let{networkId:i}=(0,r.L)(),{data:a}=(0,L.GB)(),{liquidityInUS:l,form:c,position:s,tokenPairPrice:d,swapInfo:u,selectedSolver:g,suggestedSolver:m,txnSetting:f,minAmounts:h,gasEstimated:x,isSyncing:v,isSyncingTx:k,setError:b}=nu(),{noNeedSwap:w}=(0,C.Dn)(),A=[s.tokenA,s.tokenB],P=N.viem.getNativeCurrency(i),y=Y().add(A[0].amount,w?c.tokenA:h.amount0Min),T=Y().add(A[1].amount,w?c.tokenB:h.amount1Min),S=(0,p.bp)(y,T,d[0],d[1]),Z=[{label:"Add Liquidity",values:[c.tokenA,c.tokenB],compareZero:!1,loading:!1},{label:"Token Deposited",values:[c.tokenA,c.tokenB],compareZero:!0,loading:!1},{label:"Min.Amounts Of Liquidity To Add",values:[h.amount0Min,h.amount1Min],compareZero:!1,loading:k}],R=[{label:"Current Liquidity Position",value:l,amounts:[A[0].amount,A[1].amount],loading:!1},{label:"New Liquidity Position",value:k?"-":S,amounts:[y,T],loading:k}];return(0,j.useEffect)(()=>{b(null)},[f]),(0,o.jsxs)(n1,{children:[(0,o.jsx)(ti,{flexDirection:"column",children:(0,o.jsx)(tn,{zapIn:!w,children:(w?Z.slice(0,1):Z.slice(1)).map(e=>{let{label:n,values:t,compareZero:r,loading:a}=e;return(0,o.jsxs)(I.tuJ,{gap:"lg",children:[(0,o.jsxs)(I.tuJ,{gap:"md",children:[(0,o.jsx)(n7,{children:n}),(0,o.jsx)(n3,{children:a||""===d[0]||""===d[1]?"$-":(0,E.oS)(Y().add(Y().multiply(t[0],d[0]),Y().multiply(t[1],d[1])))})]}),(0,o.jsx)("div",{children:A.map((e,n)=>(!r||Y().compareTo(t[n],0)>0)&&(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:(0,ee.yv)(e.ticker,i,c.useNative),address:e.address,native:e.native,decimals:e.decimals,amount:Y().multiply(t[n],1),price:d[n],loading:a,maxWidth:999},e.address))})]},n)})})}),(0,o.jsx)(tt,{children:R.map(e=>{let{label:n,value:t,amounts:i,loading:r}=e;return(0,o.jsxs)(n4,{gap:"12px",minWidth:"262px",children:[(0,o.jsxs)(I.tuJ,{gap:"md",children:[(0,o.jsx)(n7,{children:n}),(0,o.jsx)(n3,{children:(0,E.oS)(t)})]}),A.map((e,n)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:e.ticker,amount:i[n],address:e.address,native:e.native,decimals:e.decimals,price:d[n],loading:r,maxWidth:999,marginBottom:0,tag:"-"===t||0===Y().compareTo(0,t)?"-":"".concat(Y().multiply(Y().divide(Y().multiply(i[n],d[n]),t,2),100),"%")},e.address))]},n)})}),!w&&(0,o.jsxs)(o.Fragment,{children:[u&&a&&(null==u?void 0:null===(e=u[g])||void 0===e?void 0:null===(n=e.swapRoutes)||void 0===n?void 0:n.length)>0&&(0,o.jsx)(eo._r,{children:(0,o.jsxs)(I.tuJ,{gap:"xl",children:[(0,o.jsx)(eo.Rw,{children:"Order Routing"}),(0,o.jsx)(I.Cy9,{...null==u?void 0:u[g],loading:v,maxWidth:571,routes:null==u?void 0:null===(t=u[g])||void 0===t?void 0:t.swapRoutes,wBorder:!0,suggested:g===m})]})}),(0,o.jsx)(eo._r,{children:(0,o.jsxs)(I.tuJ,{gap:"md",children:[(0,o.jsxs)(eo.X2,{children:[(0,o.jsx)(eo.OA,{children:"Est. Total Gas Fee"}),(0,o.jsx)(eo.OA,{children:"".concat(x?(0,er.b)(x,P.decimals):"-"," ").concat(P.symbol)})]}),(0,o.jsxs)(eo.X2,{children:[(0,o.jsx)(eo.OA,{children:"Slippage Setting"}),(0,o.jsx)(eo.OA,{children:"".concat(Math.floor(1e4*f.slippage)/100,"%")})]})]})})]})]})},tC=e=>{let{details:n,goto:t}=e,[i,r]=(0,j.useState)("edit");return(0,o.jsx)(nd,{position:n,children:(0,o.jsxs)(tP,{mode:i,onClose:()=>{t.details()},onModeChange:e=>{r(e)},children:["edit"===i&&(0,o.jsx)(to,{}),"preview"===i&&(0,o.jsx)(ty,{})]})})};function tT(){let e=(0,i.Z)(["\n  box-sizing: border-box;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return tT=function(){return e},e}function tS(){let e=(0,i.Z)(["\n  gap: ",";\n"]);return tS=function(){return e},e}function tZ(){let e=(0,i.Z)(["\n  padding: 16px;\n  height: 112px;\n  min-width: calc(45% - 48px);\n  border: 1px solid ",";\n  border-radius: ",";\n"]);return tZ=function(){return e},e}function tR(){let e=(0,i.Z)(["\n  height: fit-content;\n  display: flex;\n  flex-direction: column;\n  white-space: nowrap;\n  color: ",";\n  gap: ",";\n  border: ",";\n  padding: ",";\n  ","\n"]);return tR=function(){return e},e}function tB(){let e=(0,i.Z)(["\n  font-size: 24px;\n  line-height: 28px;\n  color: ",";\n"]);return tB=function(){return e},e}function tL(){let e=(0,i.Z)(["\n  color: ",";\n  display: flex;\n  align-items: center;\n  span:first-child {\n    margin-right: 4px;\n    white-space: nowrap;\n    line-height: 20px;\n  }\n  > div {\n    margin-left: auto;\n    transform: translate(5px, 0);\n  }\n"]);return tL=function(){return e},e}function tN(){let e=(0,i.Z)(["\n  width: 100%;\n  margin-top: 8px;\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return tN=function(){return e},e}function tM(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n  width: ",";\n"]);return tM=function(){return e},e}function tD(){let e=(0,i.Z)(["\n  margin: 0 8px 16px;\n"]);return tD=function(){return e},e}function tF(){let e=(0,i.Z)(["\n  position: relative;\n  height: 20px;\n  width: 160px;\n  padding: 12px 16px;\n  font-size: 16px;\n  line-height: 20px;\n  background: ",";\n  border-radius: ",";\n"]);return tF=function(){return e},e}function tE(){let e=(0,i.Z)(["\n  position: absolute;\n  left: 141px;\n  top: 50%;\n  transform: translateY(-50%);\n  display: flex;\n  height: 44px;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n"]);return tE=function(){return e},e}function tq(){let e=(0,i.Z)(["\n  height: 24px;\n  line-height: 24px;\n  align-items: center;\n  text-align: center;\n  color: ",";\n"]);return tq=function(){return e},e}function tO(){let e=(0,i.Z)(["\n  font-size: 14px;\n  font-weight: 500;\n  color: ",";\n  display: flex;\n  align-items: center;\n  white-space: nowrap;\n  line-height: 1;\n  margin-top: 4px;\n  gap: 6px;\n  > svg {\n    flex-shrink: 0;\n    fill: ",";\n  }\n"]);return tO=function(){return e},e}function tz(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return tz=function(){return e},e}let t_=A.ZP.div.withConfig({componentId:"sc-4e358a7d-0"})(tT(),e=>{let{theme:n}=e;return n.spacing.xl}),tU=(0,A.ZP)(eo.X2).withConfig({componentId:"sc-4e358a7d-1"})(tS(),e=>{let{theme:n}=e;return n.spacing.xl}),tW=A.ZP.div.withConfig({componentId:"sc-4e358a7d-2"})(tZ(),e=>{let{theme:n}=e;return n.colors.global.line.Line2},e=>{let{theme:n}=e;return n.radii.xl}),tY=(0,A.ZP)(eo._r).withConfig({componentId:"sc-4e358a7d-3"})(tR(),e=>{let{theme:n}=e;return n.colors.global.text.T2},e=>{let{gap:n}=e;return n||"0px"},e=>{let{noBorder:n,theme:t}=e;return n?"none":"1px solid ".concat(t.colors.global.line.Line2)},e=>{let{theme:n,padding:t}=e;return t||n.spacing.xl},e=>{let{minWidth:n}=e;return n&&"min-width: ".concat(n,";")}),tX=(0,A.ZP)(I.ayo).withConfig({componentId:"sc-4e358a7d-4"})(tB(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),tG=(0,A.ZP)(I.Bpc).withConfig({componentId:"sc-4e358a7d-5"})(tL(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),tH=(0,A.ZP)(eo._r).withConfig({componentId:"sc-4e358a7d-6"})(tN(),e=>{let{theme:n}=e;return n.spacing.lg}),tV=(0,A.ZP)(eo._r).withConfig({componentId:"sc-4e358a7d-7"})(tM(),e=>{let{theme:n}=e;return n.spacing.lg},e=>{let{tab:n}=e;return"Rebalance"===n?"100%":"463px"}),tJ=(0,A.ZP)(nN.i).withConfig({componentId:"sc-4e358a7d-8"})(tD());(0,A.ZP)(I.qmJ).withConfig({componentId:"sc-4e358a7d-9"})(tF(),e=>{let{theme:n}=e;return n.colors.global.background.BG3},e=>{let{theme:n}=e;return n.radii.round}),A.ZP.div.withConfig({componentId:"sc-4e358a7d-10"})(tE()),(0,A.ZP)(I.oD).withConfig({componentId:"sc-4e358a7d-11"})(tq(),e=>{let{theme:n}=e;return n.colors.global.primary});let tK=A.ZP.div.withConfig({componentId:"sc-4e358a7d-12"})(tO(),e=>{let{theme:n}=e;return n.colors.global.warning},e=>{let{theme:n}=e;return n.colors.grey.mediumGrey}),t$=(0,A.ZP)(eo._r).withConfig({componentId:"sc-4e358a7d-13"})(tz(),e=>{let{theme:n}=e;return n.spacing.md}),tQ=e=>{var n,t;let{estimatedAmounts:i,autoCompound:a,maxTriggersCreated:l,form:s,liquidityAmount:d,tab:u,tokens:g,tokenPrices:m,unclaimedFees:f,updateForm:h}=e,x=(0,A.Fg)(),{networkId:v}=(0,r.L)(),[k,b]=j.useState((0,ee.NO)(g[0].address,v)||(0,ee.NO)(g[1].address,v));(0,j.useEffect)(()=>{h({...s,useNative:k})},[k]);let P=(0,p.bp)(i[0],i[1],m[0],m[1]);return"Prescheduled Position Close"===u&&(0,c.TN)(v)?(0,o.jsx)(eo.cs,{height:"320px",children:(0,o.jsx)(I.Bpc,{children:"Automation tool on ApertureSwap is coming soon!"})}):(0,o.jsxs)(t_,{children:[(0,o.jsxs)(tU,{children:[(0,o.jsx)(tW,{children:(0,o.jsxs)(tY,{noBorder:!0,gap:x.spacing.lg,padding:"0",children:[(0,o.jsxs)(I.tuJ,{gap:"md",children:[(0,o.jsx)(tG,{children:"Liquidity"}),(0,o.jsx)(tX,{children:(0,E.oS)(d)})]}),(0,o.jsx)("div",{children:g.map((e,t)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:e.ticker,address:e.address,native:e.native,decimals:e.decimals,amount:null!==(n=e.amount)&&void 0!==n?n:"0",price:m[t],maxWidth:999,tag:"-"===d||0===Y().compareTo(d,0)?"-":"".concat(Y().multiply(Y().divide(Y().multiply(e.amount,m[t]),d,2),100),"%")},e.address))})]})}),(0,o.jsx)(tW,{children:(0,o.jsxs)(tY,{noBorder:!0,gap:x.spacing.lg,padding:"0",children:[(0,o.jsxs)(I.tuJ,{gap:"md",children:[(0,o.jsxs)(tG,{children:[(0,o.jsx)("span",{children:"Unclaimed Fees"}),a&&(0,o.jsx)(I.AgL,{autoCompound:!0})]}),(0,o.jsx)(tX,{children:(0,E.oS)(f)})]}),(0,o.jsx)("div",{children:g.map((e,n)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:e.ticker,address:e.address,native:e.native,decimals:e.decimals,amount:null!==(t=e.collectableAmount)&&void 0!==t?t:"0",price:m[n],maxWidth:999},e.address))})]})})]}),"Prescheduled Position Close"===u&&(0,o.jsx)(I.T50,{errorMsg:l?"You have already set up the maximum number of triggers (".concat(F.u6,")."):void 0,showTimeBuffer:!1,tooltip:"Use triggers to automatically close your position (remove liquidity) based on asset prices, pool ratios, or time. Users can set up to 3 triggers for liquidity removal.",initForm:s.trigger,tokens:g,expireDays:N.AUTOMATION_EXPIRATION_IN_DAYS,onFormChange:e=>{h({...s,trigger:e})}}),"Remove Liquidity"===u&&(0,o.jsxs)(t$,{children:[(0,o.jsx)(tG,{lineHeight:"20px",children:"Remove Percentage of Position"}),(0,o.jsx)(tJ,{value:s.removePercentage,onChange:e=>{h({...s,removePercentage:e})}}),(0,o.jsx)(I.ti6,{color:"primary",width:280,amount:d,additionalAmount:f,percentage:s.removePercentage,onChange:e=>{h({...s,removePercentage:e})}})]}),"Remove Liquidity"===u&&((0,ee.NO)(g[0].address,v)||(0,ee.NO)(g[1].address,v))&&(0,o.jsx)(nf,{text:"Collect",nativeChange:e=>{b(e),h({...s,useNative:e})}}),"Remove Liquidity"===u&&(0,o.jsx)(eo.AX,{}),(0,o.jsxs)(tH,{children:["Remove Liquidity"===u?(0,o.jsx)(tG,{children:"Projected Amount To Receive"}):(0,o.jsxs)(tG,{children:[(0,o.jsx)("span",{children:"Current Value (If Closed Now)"}),(0,o.jsx)(I.rIP,{content:"Actual amount received will depend on future asset prices at the time of closure."})]}),(0,o.jsx)(tX,{children:(0,E.oS)("-"===d?"-":"Remove Liquidity"===u?Y().add(Y().multiply(d,s.removePercentage),"-"===f?"0":f):Y().add(P,"-"===f?"0":f))}),(0,o.jsx)("div",{children:g.map((e,n)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:(0,ee.yv)(e.ticker,v,s.useNative),address:e.address,native:e.native,decimals:e.decimals,maxWidth:999,amount:"Remove Liquidity"===u?Y().add(Y().multiply(e.amount,s.removePercentage),e.collectableAmount):Y().add(i[n],e.collectableAmount),price:m[n]},e.address))}),"Remove Liquidity"===u&&(0,o.jsxs)(tK,{children:[(0,o.jsx)(w.sz,{}),"All accrued fees will be collected when removing liquidity."]})]}),"Prescheduled Position Close"===u&&(0,o.jsxs)(I.kCb,{justifyContent:"space-between",children:[(0,o.jsxs)(tV,{tab:u,children:[(0,o.jsxs)(tG,{children:[(0,o.jsx)("span",{children:"Gas Fee Ceiling Setting"}),(0,o.jsx)(I.rIP,{content:"Input the maximum gas fee in either dollars or percentage of position. However, the actual gas ceiling will be based on the percentage not the dollar amount (e.g. if you choose $50 which is currently 1% of your total liquidity position then we will set a gas ceiling of 1%)."})]}),(0,o.jsx)(I.ft7,{color:"primary",width:280,amount:d,percentage:s.gasCeiling,onChange:e=>{h({...s,gasCeiling:e})},onError:e=>(0,F.ob)(v,e,d)})]}),(0,o.jsxs)(eo.WA,{children:[(0,o.jsx)(tG,{children:"Expires In"}),(0,o.jsx)(I.ayo,{children:"".concat(N.AUTOMATION_EXPIRATION_IN_DAYS," Days")})]})]})]})},t0=e=>{let{details:n,payload:t,triggerTask:i,onClose:r,color:a="primary"}=e,{addSnackbar:l}=(0,u.D)(),{mutate:c}=(0,h.w)(),{ifAuthorized:s}=(0,eS.I)(),{data:d}=(0,eZ.m)(),{data:p,isLoading:m,mutate:f}=(0,eT.A)(n.positionId),[x,v]=(0,j.useState)(void 0),[k,b]=(0,j.useState)(void 0),[w,I]=(0,j.useState)(!1);return(0,j.useEffect)(()=>{k&&t&&(I(!0),i?(0,g.dq)(t,k).then(e=>{if("Success"===e){let e=(0,g.s2)(i);f().then(()=>{c()}),l("You have successfully updated your ".concat(e.toLowerCase()," trigger for the ").concat(n.tokenA.ticker,"-").concat(n.tokenB.ticker," position closure."),"completed"),r(),I(!1)}}).catch(e=>{l("Your prescheduled close update request has failed: "+e,"failed"),I(!1)}):(0,g.$y)(t,k,x).then(e=>{if("Success"===e){let e=(0,g.s2)(t);f().then(()=>{c()}),l("You have successfully set up a ".concat(e.toLowerCase(),"-based trigger to close your ").concat(n.tokenA.ticker,"-").concat(n.tokenB.ticker," position."),"completed"),r(),I(!1)}}).catch(e=>{l("Your prescheduled close request has failed: "+(0,g.cr)(e),"failed"),I(!1)}))},[k]),s||m||p||x?(0,o.jsx)(ey.Z,{text:"Confirm Prescheduled Close Intent",color:"secondary",isLoading:w,payload:t,setSignedPayload:b}):d?(0,o.jsx)(eP.Z,{text:"Approve on-chain",color:"secondary",tokenPair:"".concat(n.tokenA.ticker,"-").concat(n.tokenB.ticker),positionIdBN:n.positionIdBN,onApproved:f}):(0,o.jsx)(eC.Z,{color:a,tokenPair:"".concat(n.tokenA.ticker,"-").concat(n.tokenB.ticker),positionId:n.positionIdBN,setPermitInfo:e=>v({signature:e.signature,deadline:String(e.deadline)})})};var t1=t(3821);function t2(){let e=(0,i.Z)(["\n  margin: auto;\n"]);return t2=function(){return e},e}let t4=A.ZP.div.withConfig({componentId:"sc-a9d0e290-0"})(t2()),t8=e=>{let{details:n,form:t,txForm:i,onClose:a,color:l="primary",width:c}=e,{address:s}=(0,P.m)(),{ammEnum:d,networkId:g,publicClient:m}=(0,r.L)(),[f,h]=(0,j.useState)(void 0),[x,v]=(0,j.useState)(void 0),{addSnackbar:k}=(0,u.D)(),{addPositionSnackbar:b}=(0,eL.A)();(0,j.useEffect)(()=>{v(void 0),(0,p.zY)(s,d,g,n.positionId,(0,t1.J)(t.removePercentage),(0,t1.J)(i.slippage),Number(i.deadline),m,t.useNative).then(e=>{m.estimateGas({...e,account:s}).then(n=>{h({...e,gas:(0,F.yC)(n)})}).catch(e=>{(0,N.getLogger)().error("RemoveLiquidity.RemoveLPBtn.RemoveLiquidityTx.EstimateGasError ",{error:e.message}),v(e.details)})}).catch(e=>{v(e.message.split(";")[0]),console.log(e),(0,N.getLogger)().error("RemoveLiquidity.RemoveLPBtn.getRemovePositionRequest.Error ",{ammEnum:d,networkId:g,walletAddress:s,positionId:n.positionId,removePercentage:t.removePercentage,slippage:i.slippage,useNative:t.useNative,error:null==e?void 0:e.message})})},[i]);let{ready:w,data:A,sendTransaction:y,isError:C,isPending:T,isSuccess:S}=(0,eN.i)(f);return(0,j.useEffect)(()=>{C&&k("Your remove liquidity request has failed.","failed")},[C]),(0,j.useEffect)(()=>{A&&S&&(b({info:"Your remove liquidity request has been sent.",status:"completed",url:void 0,transaction:{hash:A,successMsg:1===t.removePercentage?"You have successfully closed your ".concat(n.tokenA.ticker,"-").concat(n.tokenB.ticker," position."):"You have successfully removed liquidity from your ".concat(n.tokenA.ticker,"-").concat(n.tokenB.ticker," position.")}}),a())},[S]),(0,o.jsx)(I.zxk,{onClick:()=>null==y?void 0:y(),disabled:!f||!w||x||T||S,variant:"contained",color:l,size:"lg",width:c,children:x||(T?(0,o.jsx)(t4,{children:(0,o.jsx)(I.$jN,{})}):"Confirm Remove Liquidity")})};function t9(){let e=(0,i.Z)(["\n  height: 100%;\n  gap: ",";\n"]);return t9=function(){return e},e}function t3(){let e=(0,i.Z)(["\n  height: 40px;\n  max-width: ","px;\n"]);return t3=function(){return e},e}function t7(){let e=(0,i.Z)(["\n  overflow-x: hidden;\n  overflow-y: auto;\n  scrollbar-width: none;\n  height: ",";\n"]);return t7=function(){return e},e}function t5(){let e=(0,i.Z)(["\n  width: ",";\n"]);return t5=function(){return e},e}function t6(){let e=(0,i.Z)(["\n  padding-bottom: 24px;\n  display: flex;\n  align-items: center;\n  width: ",";\n  justify-content: flex-end;\n  box-sizing: border-box;\n  gap: 18px;\n"]);return t6=function(){return e},e}let ie=(0,A.ZP)(I.tuJ).withConfig({componentId:"sc-9b809454-0"})(t9(),e=>{let{theme:n}=e;return n.spacing["2xl"]}),it=(0,A.ZP)(I.V28).withConfig({componentId:"sc-9b809454-1"})(t3(),e=>{let{maxWidth:n}=e;return n}),ii=A.ZP.div.withConfig({componentId:"sc-9b809454-2"})(t7(),e=>{let{mode:n}=e;return"edit"===n?"calc(100% - 168px)":"calc(100% - 156px)"}),io=A.ZP.div.withConfig({componentId:"sc-9b809454-3"})(t5(),I.mTC),ir=A.ZP.div.withConfig({componentId:"sc-9b809454-4"})(t6(),I.mTC),ia=e=>{var n,t;let{details:i,maxTriggersCreated:a,form:l,mode:d,tab:u,triggerTask:p,children:g,onClose:m,onModeChange:f,onTabChange:h}=e,{address:x}=(0,P.m)(),{ammEnum:v,networkId:b}=(0,r.L)(),{globalSlippage:w,setGlobalSlippage:A}=(0,C.DK)(),[y,T]=(0,j.useState)({slippage:(null==p?void 0:null===(n=p.action)||void 0===n?void 0:n.type)!=="LimitOrderClose"&&(null==p?void 0:null===(t=p.action)||void 0===t?void 0:t.slippage)||(null!=w?w:F.zI),deadline:"30"}),[Z,R]=(0,j.useState)(""),[B,L]=(0,j.useState)(void 0),[M,D]=(0,j.useState)(!!p),{mutate:E}=(0,k.F)(),{stakePool:q,staked:O,setStaked:z}=(0,s.i)();(0,j.useEffect)(()=>{if("Prescheduled Position Close"===u){let{trigger:e}=l;a?R("Maximum number of triggers"):"Price"===e.type&&"0"===e.Price.amount?R("Price Amount Is Required"):"Time"!==e.type||l.trigger.Time.dateTime?"Time"===e.type&&V()(l.trigger.Time.dateTime).valueOf()<V()().valueOf()?R("Trigger Time Is Before Current Time"):R((0,F.le)(b,l.gasCeiling,"-"!==i.liquidity?i.liquidity:"0")):R("Trigger Time Is Required")}else R("")},[u,l,a]);let _=()=>{let{trigger:e}=l;switch(e.type){case"Time":return{type:"Time",timeAfterEpochSec:V()(e.Time.dateTime).unix()};case"Ratio":return{...N.viem.generatePriceConditionFromTokenValueProportion(i.tickLower,i.tickUpper,e.Ratio.token.address===i.tokenA.address?"Above"===e.Ratio.aboveOrBelow:"Below"===e.Ratio.aboveOrBelow,e.Ratio.token.address===i.tokenA.address?e.Ratio.percentage:1-e.Ratio.percentage),frontendType:"POSITION_VALUE_RATIO"};default:{let{token0:n,token1:t}=(0,ee.UZ)(i.tokenA,i.tokenB,b),o=new(U())(0),r=new(U())(0);if(0!==Y().compareTo(e.Price.amount,0)){let a=(0,N.parsePrice)(e.Price.token.address===i.tokenA.address?n:t,e.Price.token.address===i.tokenA.address?t:n,Y().multiply(e.Price.amount,"1.0"));o=new(U())(Y().divide(a.numerator.toString(),a.denominator.toString(),18)),r=new(U())(Y().divide(a.invert().numerator.toString(),a.invert().denominator.toString(),18))}let a="Above"===e.Price.aboveOrBelow&&e.Price.token.ticker===i.tokenB.ticker||"Below"===e.Price.aboveOrBelow&&e.Price.token.ticker===i.tokenA.ticker;return{type:"Price",frontendType:"RELATIVE_PRICE",[a?"lte":"gte"]:(e.Price.token.ticker===i.tokenA.ticker?o:r).toString()}}}};return(0,j.useEffect)(()=>{(()=>{let e={ownerAddr:x,chainId:b,action:{type:"Close",slippage:y.slippage,maxGasProportion:l.gasCeiling},condition:_(),expiration:(0,S.Ll)()};if(p){for(let n in e.taskId=p.taskId,e.condition)void 0===e.condition[n]&&delete e.condition[n];let n=G().cloneDeep(e);"Price"===n.condition.type&&"RELATIVE_PRICE"===n.condition.frontendType&&(n.condition.lte?n.condition.lte=(0,I.nOQ)(n.condition.lte,[i.tokenA,i.tokenB]):n.condition.gte&&(n.condition.gte=(0,I.nOQ)(n.condition.gte,[i.tokenA,i.tokenB])));let t=G().isEqual(e.action,p.action),o=G().isEqual(n.condition,p.condition);t&&(e.action=void 0),o&&(e.condition=void 0),D(t&&o)}else e.amm=v,e.nftId=i.positionId;L(e)})()},[l,y]),(0,o.jsxs)(ie,{children:[(0,o.jsx)(eo.Dx,{children:(0,o.jsx)(I.iIr,{onClick:()=>{"edit"===d?m():f("edit")},isDrawer:!0,children:(0,o.jsx)(I.Bpc,{fontWeight:500,textAlign:"end",children:"Back to Dashboard"})})}),"preview"===d&&(0,o.jsx)(eo.eN,{children:"Remove Liquidity"===u?"Preview Remove Liquidity":"Preview Prescheduled Close Intent"}),"edit"===d&&(0,o.jsx)(eo.eN,{children:"Remove Liquidity"}),"edit"===d&&(0,o.jsx)(it,{maxWidth:396,containerPadding:"2px",menu:["Remove Liquidity","Prescheduled Position Close"],isPro:[!1,!0],selectWidth:[150,225],itemsWidth:[156,228],defaultSelected:["Remove Liquidity","Prescheduled Position Close"].indexOf(u),onSelect:e=>{h(e)}}),(0,o.jsx)(ii,{mode:d,children:(0,o.jsx)(io,{children:g})}),!("Prescheduled Position Close"===u&&(0,c.TN)(b))&&(0,o.jsxs)(ir,{children:[(0,o.jsx)(I.oVd,{defaultSlippage:F.zI,globalSlippage:w,warningSlippage:F.NX,settingsForm:y,dropdownPosition:"topRight",onFormChange:e=>T(e),buttonSize:"small",setGlobalSlippage:e=>A(n=>({...n,[b]:e}))}),(0,o.jsx)(I.zxk,{variant:"contained",color:"default",size:"lg",width:"100%",onClick:()=>{"edit"===d?m():f("edit")},children:"Cancel"}),"edit"===d&&(q&&O?(0,o.jsx)(eA.B,{atStake:O,gaugeAddress:q.gaugeAddress,positionId:i.positionIdBN,handleTxSuccess:()=>{z(!1),E()}},i.positionId):(0,o.jsx)(I.zxk,{variant:"contained",color:"secondary",size:"lg",width:"100%",disabled:!!Z||M,onClick:()=>{f("preview")},children:Z||("Remove Liquidity"===u?"Remove Liquidity":"Preschedule Position Close")})),"preview"===d&&("Remove Liquidity"===u?(0,o.jsx)(t8,{color:"secondary",width:"100%",form:l,details:i,txForm:y,onClose:m}):(0,o.jsx)(t0,{color:"secondary",details:i,payload:B,triggerTask:p,onClose:m}))]})]})};function il(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return il=function(){return e},e}function ic(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: ","px;\n"]);return ic=function(){return e},e}let is=A.ZP.div.withConfig({componentId:"sc-8edd0f18-0"})(il(),e=>{let{theme:n}=e;return n.spacing.lg}),id=(0,A.ZP)(eo._r).withConfig({componentId:"sc-8edd0f18-1"})(ic(),e=>{let{gap:n}=e;return n}),iu=e=>{let{estimatedAmounts:n,form:t,liquidityAmount:i,tab:a,tokens:l,tokenPrices:c,unclaimedFees:s,isCreatingTrigger:d}=e,{ammEnum:u,networkId:g}=(0,r.L)(),m=eK().tz.guess(),f=(0,p.bp)(n[0],n[1],c[0],c[1]);return(0,o.jsxs)(eo.W2,{children:["Remove Liquidity"===a?(0,o.jsxs)(id,{gap:12,children:[(0,o.jsx)(tG,{children:"Remove Liquidity"}),(0,o.jsxs)(I.ayo,{fontSize:32,lineHeight:"37.5px",children:[Y().multiply(t.removePercentage,100),"%"]})]}):(0,o.jsx)(I.R0C,{form:t.trigger,tokens:l}),"Remove Liquidity"===a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eo.AX,{}),(0,o.jsxs)(id,{gap:12,children:[(0,o.jsx)(tG,{children:"Projected Amount To Receive"}),(0,o.jsx)(tX,{fontSize:32,lineHeight:"37.5px",marginBottom:0,children:(0,E.oS)("-"===i?"-":Y().add(Y().multiply(i,t.removePercentage),s))}),l.map((e,n)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:"Pooled ".concat((0,ee.yv)(e.ticker,g,t.useNative)),address:e.address,native:e.native,decimals:e.decimals,amount:Y().multiply(e.amount,t.removePercentage),price:c[n],marginBottom:0,maxWidth:999},e.address)),(0,o.jsxs)(is,{children:[l.map((e,n)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:"".concat((0,ee.yv)(e.ticker,g,t.useNative)," Fees Earned"),address:e.address,native:e.native,decimals:e.decimals,amount:e.collectableAmount,price:c[n],marginBottom:0,maxWidth:999},e.address)),"Remove Liquidity"===a&&(0,o.jsxs)(tK,{children:[(0,o.jsx)(w.sz,{}),"All accrued fees will be collected when removing liquidity."]})]})]})]}),"Prescheduled Position Close"===a&&(0,o.jsxs)(id,{gap:8,children:[(0,o.jsxs)(tG,{lineHeight:"20px",children:[(0,o.jsx)("span",{children:"Current Value (If Closed Now)"}),(0,o.jsx)(I.rIP,{content:"Actual amount received will depend on future asset prices at the time of closure."})]}),(0,o.jsx)(tX,{fontSize:32,lineHeight:"37.gpx",marginBottom:0,children:(0,E.oS)(Y().add(f,s))}),l.map((e,t)=>(0,o.jsx)(I.sXs,{Icon:e.Icon,ticker:e.ticker,address:e.address,native:e.native,decimals:e.decimals,amount:Y().add(n[t],e.collectableAmount),price:c[t],marginBottom:0,maxWidth:999},e.address))]}),"Prescheduled Position Close"===a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eo.AX,{}),(0,o.jsxs)(eo.rl,{children:[(0,o.jsxs)(eo.X2,{children:[(0,o.jsx)(eo.Wh,{lineHeight:"20px",children:"Gas Ceiling"}),(0,o.jsxs)(I.Bpc,{lineHeight:"20px",children:[Y().multiply(t.gasCeiling,100),"% of the position"]})]}),(0,o.jsxs)(I.tuJ,{gap:"xl",children:[(0,o.jsxs)(eo.X2,{children:[(0,o.jsx)(eo.Wh,{lineHeight:"20px",children:"Trigger Expiration"}),(0,o.jsxs)(I.Bpc,{lineHeight:"20px",children:[V()().add(N.AUTOMATION_EXPIRATION_IN_DAYS,"days").format("MMM Do, YYYY")," ","(".concat(N.AUTOMATION_EXPIRATION_IN_DAYS," Days)")]})]}),(0,o.jsx)(eo.c_,{children:"".concat(m," (GMT").concat(eK().tz(m).format("Z"),")")})]}),d&&(0,o.jsx)(I.oLF,{styles:{size:"lg"},amm:u,feeInfo:{fee:F.mH,amount:Y().add(i,s)},hint:"".concat(100*F.mH,"% of the closed position size.")})]})]})]})},ip=e=>{var n,t,i,a,l,c,s,d,u,m,f,x;let{details:v,goto:k,tabs:b,trigger:w}=e,{networkId:I}=(0,r.L)(),{currentTokenPrice:A}=(0,R.P)(I),{data:P}=(0,h.w)(),[y,C]=(0,j.useState)(0===b?"Remove Liquidity":"Prescheduled Position Close"),{data:T}=D(v.positionId),[S,Z]=(0,j.useState)("edit"),B=(0,g.nZ)(null==P?void 0:P[I],"Close",v.positionId).length,L=()=>w?(0,g.s2)(w):"Price",[M,E]=(0,j.useState)({gasCeiling:(null==w?void 0:null===(n=w.action)||void 0===n?void 0:n.maxGasProportion)||(0,F.yX)(I,v.liquidity),trigger:{type:L(),Price:{token:"Price"===L()&&(null==w?void 0:null===(t=w.condition)||void 0===t?void 0:t.singleToken)===1?v.tokenB:v.tokenA,aboveOrBelow:"Price"===L()&&(null==w?void 0:null===(i=w.condition)||void 0===i?void 0:i.lte)!==void 0?"Below":"Above",amount:"Price"===L()&&(null==w?void 0:null===(a=w.condition)||void 0===a?void 0:a.singleToken)===void 0&&((null==w?void 0:null===(l=w.condition)||void 0===l?void 0:l.gte)||(null==w?void 0:null===(c=w.condition)||void 0===c?void 0:c.lte))||"0"},Ratio:{token:v.tokenA,aboveOrBelow:"Ratio"===L()&&(null==w?void 0:null===(s=w.condition)||void 0===s?void 0:s.lte)!==void 0?"Above":"Below",percentage:"Ratio"===L()?(()=>{let e=new(U())(w.condition.lte||w.condition.gte||"0");try{let n=(0,N.getTokenValueProportionFromPriceRatio)(v.tickLower,v.tickUpper,e).toFixed(4);return parseFloat(n)}catch(e){return console.log(e),0}})():.5},Time:{dateTime:V()((null==w?void 0:null===(d=w.condition)||void 0===d?void 0:d.type)==="Time"?1e3*w.condition.timeAfterEpochSec:new Date().setDate(new Date().getDate()+7)).format("MMMM DD, yyyy hh:mm a")}},removePercentage:.5}),q=[null!==(f=null==A?void 0:null===(u=A[v.tokenA.address])||void 0===u?void 0:u.price)&&void 0!==f?f:"0",null!==(x=null==A?void 0:null===(m=A[v.tokenB.address])||void 0===m?void 0:m.price)&&void 0!==x?x:"0"],O=(0,j.useMemo)(()=>{if(T){let e=(0,p.UA)(I,v,T.position,T.tickLower,T.tickUpper,q,M.trigger);return[e[0].amount,e[1].amount]}return[v.tokenA.amount,v.tokenB.amount]},[M.trigger]);return(0,o.jsxs)(ia,{details:v,maxTriggersCreated:!w&&B>=F.u6,form:M,mode:S,tab:y,triggerTask:w,onClose:()=>{k.details()},onModeChange:e=>{Z(e)},onTabChange:e=>{C(e)},children:["edit"===S&&(0,o.jsx)(tQ,{estimatedAmounts:O,maxTriggersCreated:!w&&B>=F.u6,liquidityAmount:v.liquidity,unclaimedFees:v.feeAmount,autoCompound:v.autoCompound,form:M,tab:y,tokens:[v.tokenA,v.tokenB],tokenPrices:q,updateForm:e=>{E(e)}}),"preview"===S&&(0,o.jsx)(iu,{estimatedAmounts:O,liquidityAmount:v.liquidity,unclaimedFees:v.feeAmount,autoCompound:v.autoCompound,form:M,tab:y,tokens:[v.tokenA,v.tokenB],tokenPrices:q,isCreatingTrigger:!w})]})};function ig(){let e=(0,i.Z)(["\n  font-size: 16px;\n  line-height: 20px;\n"]);return ig=function(){return e},e}let im=(0,A.ZP)(I.zxk).withConfig({componentId:"sc-8670cb66-0"})(ig()),ih=e=>{let{total:n,tokenInfo:t,positionId:i,onClose:a,color:l="primary"}=e,{address:c}=(0,P.m)(),{ammEnum:s,networkId:d,publicClient:p}=(0,r.L)(),{addSnackbar:g}=(0,u.D)(),{addPositionSnackbar:m}=(0,eL.A)(),[f,h]=(0,j.useState)(void 0),[x,v]=(0,j.useState)(void 0);(0,j.useEffect)(()=>{v(void 0),N.viem.getCollectTx(i,c,d,s,p).then(e=>{p.estimateGas({...e,account:c}).then(n=>{h({...e,gas:(0,F.yC)(n)})}).catch(e=>{(0,N.getLogger)().error("Failed to estimate gas on CollectTx: ",{error:JSON.stringify(e.message)}),v(e.details)})}).catch(e=>{(0,N.getLogger)().error("Failed to getCollectTx: ",{ammEnum:s,networkId:d,address:c,positionId:i,error:JSON.stringify(e)}),v(e.message.split(";")[0])})},[d,c]);let{ready:k,data:b,sendTransaction:w,isError:A,isPending:y,isSuccess:C}=(0,eN.i)(f);return(0,j.useEffect)(()=>{A&&g("Your collect fee request has failed.","failed")},[A]),(0,j.useEffect)(()=>{C&&b&&(m({info:"Your collect fee request has been sent.",status:"completed",url:void 0,transaction:{hash:b,successMsg:"You have successfully collected ".concat((0,E.oS)(n)," fees from your ").concat(t[0].ticker,"-").concat(t[1].ticker," position.")}}),a())},[C]),(0,o.jsx)(im,{onClick:()=>null==w?void 0:w(),disabled:!f||!k||x||y||C,variant:"contained",color:l,size:"lg",width:"100%",children:x||(y?(0,o.jsx)(I.$jN,{}):"Collect")})};function ix(){let e=(0,i.Z)(["\n  display: flex;\n  margin-top: 16px;\n  gap: ",";\n"]);return ix=function(){return e},e}function iv(){let e=(0,i.Z)(["\n  font-size: 16px;\n  line-height: 20px;\n"]);return iv=function(){return e},e}let ik=A.ZP.div.withConfig({componentId:"sc-dd5af279-0"})(ix(),e=>{let{theme:n}=e;return n.spacing.md}),ib=(0,A.ZP)(I.zxk).withConfig({componentId:"sc-dd5af279-1"})(iv()),iw=e=>{let{total:n,tokenInfo:t,positionId:i,stakePool:r,staked:a,setStaked:l,onClose:c}=e,{mutate:s}=(0,k.F)(),[d,u]=(0,j.useState)(a);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I._48,{total:n,tokenInfo:t}),(0,o.jsxs)(ik,{children:[(0,o.jsx)(ib,{width:"100%",variant:"contained",color:"default",size:"lg",onClick:c,children:"Cancel"}),r&&a&&d?(0,o.jsx)(eA.B,{atStake:a,gaugeAddress:r.gaugeAddress,positionId:i,handleTxSuccess:()=>{l(!1),u(!1),s()}},i.toString()):(0,o.jsx)(ih,{color:"secondary",total:n,tokenInfo:t,positionId:i,onClose:c})]})]})};function iI(){let e=(0,i.Z)(["\n  font-size: 16px;\n  line-height: 20px;\n"]);return iI=function(){return e},e}let ij=(0,A.ZP)(I.zxk).withConfig({componentId:"sc-c4231250-0"})(iI()),iA=e=>{let{positionId:n,feeAmount:t,tokenPair:i,txForm:a,permitInfo:l,setProjectedAmount:c,onClose:s,color:d="primary"}=e,{address:p}=(0,P.m)(),{ammEnum:g,networkId:m,publicClient:f}=(0,r.L)(),{addSnackbar:h}=(0,u.D)(),[x,v]=(0,j.useState)(void 0),[k,b]=(0,j.useState)(void 0),{addPositionSnackbar:w}=(0,eL.A)();(0,j.useEffect)(()=>{b(void 0),N.viem.getReinvestTx(m,g,p,n,(0,t1.J)(a.slippage),BigInt((0,S.OK)(0===Number(a.deadline)||""===a.deadline?30:Number(a.deadline))),f,l).then(e=>{let{tx:n,amounts:t}=e;c({amount0:t.amount0.toString(),amount1:t.amount1.toString()}),f.estimateGas({...n,account:p}).then(e=>{v({...n,gas:(0,F.yC)(e)})}).catch(e=>{(0,N.getLogger)().error("Failed to estimate gas on ReinvestTx: ",{error:JSON.stringify(e.message)}),b(e.details)})}).catch(e=>{(0,N.getLogger)().error("Failed to getReinvestTx: ",{ammEnum:g,networkId:m,address:p,positionId:n,slippage:a.slippage,error:JSON.stringify(e)}),1>Y().compareTo("-"===t?"0":t,"0.01")?b("Amount to be reinvested is too small"):b(e.details)})},[a]);let{ready:A,data:y,sendTransaction:C,isError:T,isPending:Z,isSuccess:R}=(0,eN.i)(x);return(0,j.useEffect)(()=>{T&&h("Your reinvest unclaimed fees request has failed.","failed")},[T]),(0,j.useEffect)(()=>{R&&y&&(w({info:"Your reinvest unclaimed fees request has been sent.",status:"completed",url:void 0,transaction:{hash:y,successMsg:"You have successfully reinvested unclaimed fees to your ".concat(i," position.")}}),s())},[R]),(0,o.jsx)(ij,{onClick:()=>null==C?void 0:C(),disabled:!x||!A||k||Z||R,variant:"contained",color:d,size:"lg",width:"252px",children:k||(Z?(0,o.jsx)(I.$jN,{}):"Reinvest")})},iP=e=>{let{positionId:n,positionIdBN:t,feeAmount:i,tokenPair:r,txForm:a,setProjectedAmount:l,onClose:c,signPositionPermitBtnText:s="Sign Position Permit"}=e,{ifAuthorized:d}=(0,eS.I)(),{data:u}=(0,eZ.m)(),{data:p,isLoading:g,mutate:m}=(0,eT.A)(n),[f,h]=(0,j.useState)(void 0);return(0,o.jsx)(o.Fragment,{children:d||u&&(g||p)||f?(0,o.jsx)(iA,{color:"secondary",positionId:t,feeAmount:i,tokenPair:r,txForm:a,permitInfo:f,setProjectedAmount:l,onClose:c}):u?(0,o.jsx)(eP.Z,{text:"Approve on-chain",color:"secondary",tokenPair:r,positionIdBN:t,onApproved:m}):(0,o.jsx)(eC.Z,{color:"secondary",positionId:BigInt(n),tokenPair:r,setPermitInfo:h,children:s})})};function iy(){let e=(0,i.Z)(["\n  display: flex;\n  width: 100%;\n  padding-top: 24px;\n  align-items: center;\n  justify-content: flex-end;\n  gap: ",";\n"]);return iy=function(){return e},e}function iC(){let e=(0,i.Z)(["\n  font-size: 16px;\n  line-height: 20px;\n"]);return iC=function(){return e},e}let iT=A.ZP.div.withConfig({componentId:"sc-e037e66d-0"})(iy(),e=>{let{theme:n}=e;return n.spacing.md}),iS=(0,A.ZP)(I.zxk).withConfig({componentId:"sc-e037e66d-1"})(iC()),iZ=e=>{let{positionId:n,positionIdBN:t,liquidity:i,feeAmount:a,tokens:l,tokenPrices:c,tokenPercentages:s,stakePool:d,staked:u,setStaked:p,onClose:g}=e,{address:m}=(0,P.m)(),{ammEnum:f,networkId:h,publicClient:x}=(0,r.L)(),{globalSlippage:v,setGlobalSlippage:b}=(0,C.DK)(),{mutate:w}=(0,k.F)(),[A,y]=(0,j.useState)({slippage:null!=v?v:F.zI,deadline:"30"}),[S,Z]=(0,j.useState)({amount0:"0",amount1:"0"}),[R,B]=(0,j.useState)(u),L=(0,j.useMemo)(()=>[Y().add(l[0].amount,(0,er.b)(BigInt(S.amount0),l[0].decimals)),Y().add(l[1].amount,(0,er.b)(BigInt(S.amount1),l[1].decimals))],[l,S]),M=(0,j.useMemo)(()=>(0,ee.zu)(L[0],L[1],c[0],c[1]),[c,L]),D=(0,j.useMemo)(()=>Y().add(Y().multiply(L[0],c[0]),Y().multiply(L[1],c[1])),[c,L]);return(0,T.o)(()=>{g()}),(0,j.useEffect)(()=>{N.viem.getReinvestedPosition(h,f,BigInt(n),x).then(e=>{let[,n,t]=e;Z({amount0:n.toString(),amount1:t.toString()})}).catch(e=>{(0,N.getLogger)().error("Failed to getReinvestedPosition: ",{ammEnum:f,networkId:h,address:m,positionId:n,error:JSON.stringify(e)})})},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I.T9m,{amm:f,liquidity:i,feeAmount:a,tokens:[{Icon:l[0].Icon,ticker:l[0].ticker,amount:l[0].amount,price:c[0],address:l[0].address,native:l[0].native,decimals:l[0].decimals,tag:s[0]},{Icon:l[1].Icon,ticker:l[1].ticker,amount:l[1].amount,price:c[1],address:l[1].address,native:l[1].native,decimals:l[1].decimals,tag:s[1]}],unClaimedFees:[l[0].collectableAmount,l[1].collectableAmount],predictedLiquidity:D,predictedProjection:[{amount:L[0],percent:M.token0Percent},{amount:L[1],percent:M.token1Percent}],fee:F.cO}),(0,o.jsxs)(iT,{children:[(0,o.jsx)(I.oVd,{defaultSlippage:F.zI,globalSlippage:v,settingsForm:A,dropdownPosition:"topRight",onFormChange:e=>{y(e)},buttonSize:"small",setGlobalSlippage:e=>b(n=>({...n,[h]:e}))}),(0,o.jsx)(iS,{width:"252px",variant:"contained",color:"default",size:"lg",onClick:g,children:"Cancel"}),d&&u&&R?(0,o.jsx)(eA.B,{atStake:u,gaugeAddress:d.gaugeAddress,positionId:t,handleTxSuccess:()=>{p(!1),B(!1),w()}},n):(0,o.jsx)(iP,{positionId:n,positionIdBN:t,feeAmount:a,tokenPair:"".concat(l[0].ticker,"-").concat(l[1].ticker),txForm:A,setProjectedAmount:Z,onClose:g})]})]})};function iR(){let e=(0,i.Z)(["\n  display: flex;\n  margin-top: 16px;\n  gap: ",";\n"]);return iR=function(){return e},e}function iB(){let e=(0,i.Z)(["\n  font-size: 16px;\n  line-height: 20px;\n"]);return iB=function(){return e},e}let iL=A.ZP.div.withConfig({componentId:"sc-28cc6421-0"})(iR(),e=>{let{theme:n}=e;return n.spacing.md}),iN=(0,A.ZP)(I.zxk).withConfig({componentId:"sc-28cc6421-1"})(iB()),iM=()=>{let{setModalState:e}=(0,nx.dd)(),{networkId:n}=(0,r.L)(),{mutate:t}=(0,k.F)(),{positionId:i,stakePool:a,staked:l,setStaked:c}=(0,s.i)(),d=()=>{e(nx.yI.STAKE_POSITION_MODAL,!1)},u={atStake:l,gaugeAddress:a.gaugeAddress,positionId:i,handleTxSuccess:()=>{c(!l),t(),d()}};return(0,o.jsxs)(nx.tu,{gap:"lg",children:[(0,o.jsx)(nx.zL,{amm:(0,F.op)(n),atStake:l}),(0,o.jsxs)(iL,{children:[(0,o.jsx)(iN,{width:"100%",variant:"contained",color:"default",size:"lg",onClick:d,children:"Cancel"}),l?(0,o.jsx)(eA.B,{...u},"".concat(i.toString(),"-unstake")):(0,o.jsx)(eA.n,{...u},"".concat(i.toString(),"-stake"))]})]})};var iD=t(64953),iF=t(6100),iE=t(98793),iq=t(14566),iO=t(83165),iz=t(65391),i_=t(93271),iU=t(5632),iW=t(83492),iY=t(78545);function iX(){let e=(0,i.Z)(["\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  padding: 16px;\n  gap: ",";\n  border: ",";\n  border-radius: ",";\n  background-color: ",";\n  ","\n"]);return iX=function(){return e},e}function iG(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return iG=function(){return e},e}function iH(){let e=(0,i.Z)(["\n  width: 100%;\n  height: calc(100vh - 216px);\n  overflow-x: hidden;\n  overflow-y: auto;\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n"]);return iH=function(){return e},e}function iV(){let e=(0,i.Z)(["\n  width: ",";\n"]);return iV=function(){return e},e}function iJ(){let e=(0,i.Z)(["\n  width: ",";\n  gap: ",";\n"]);return iJ=function(){return e},e}function iK(){let e=(0,i.Z)(["\n  box-sizing: border-box;\n  display: flex;\n  width: 100%;\n  gap: ",";\n"]);return iK=function(){return e},e}function i$(){let e=(0,i.Z)(["\n  display: flex;\n  align-items: start;\n  width: 176px;\n  height: 308px;\n  img {\n    width: 176px;\n    height: 308px;\n  }\n"]);return i$=function(){return e},e}function iQ(){let e=(0,i.Z)(["\n  flex: 1;\n  width: 100%;\n  box-sizing: border-box;\n  display: flex;\n  min-width: 395px;\n  flex-direction: column;\n  gap: ",";\n"]);return iQ=function(){return e},e}function i0(){let e=(0,i.Z)(["\n  line-height: 16px;\n  color: ",";\n"]);return i0=function(){return e},e}function i1(){let e=(0,i.Z)(["\n  font-weight: 500;\n"]);return i1=function(){return e},e}function i2(){let e=(0,i.Z)(["\n  line-height: 28px;\n  color: ",";\n"]);return i2=function(){return e},e}function i4(){let e=(0,i.Z)(["\n  margin-left: auto;\n"]);return i4=function(){return e},e}function i8(){let e=(0,i.Z)(["\n  margin-top: ",";\n"]);return i8=function(){return e},e}function i9(){let e=(0,i.Z)(["\n  width: 215px;\n"]);return i9=function(){return e},e}function i3(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  align-items: flex-end;\n  gap: ",";\n"]);return i3=function(){return e},e}function i7(){let e=(0,i.Z)(["\n  padding: 4px;\n  line-height: 14px;\n"]);return i7=function(){return e},e}function i5(){let e=(0,i.Z)(["\n  padding: 0;\n  width: 130px;\n  height: 20px;\n  border-radius: ",";\n"]);return i5=function(){return e},e}function i6(){let e=(0,i.Z)(["\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n  gap: ",";\n"]);return i6=function(){return e},e}function oe(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: end;\n"]);return oe=function(){return e},e}function on(){let e=(0,i.Z)(["\n  width: 94px;\n  height: 30px;\n  font-size: 14px;\n  padding: 8px;\n  background: ",";\n  &:hover {\n    background: ",";\n    opacity: 0.8;\n  }\n"]);return on=function(){return e},e}function ot(){let e=(0,i.Z)(["\n  width: 94px;\n  height: 30px;\n  font-size: 14px;\n  padding: 8px;\n  background: ",";\n  &:hover {\n    background: ",";\n    opacity: 0.8;\n  }\n"]);return ot=function(){return e},e}function oi(){let e=(0,i.Z)(["\n  display: flex;\n  align-items: start;\n  flex-direction: column;\n  line-height: 20px;\n  color: ",";\n"]);return oi=function(){return e},e}function oo(){let e=(0,i.Z)(["\n  display: flex;\n  line-height: 20px;\n  gap: ",";\n  color: ",";\n"]);return oo=function(){return e},e}function or(){let e=(0,i.Z)(["\n  padding: 0;\n  flex-direction: column;\n  gap: ",";\n"]);return or=function(){return e},e}function oa(){let e=(0,i.Z)(["\n  width: 100%;\n  align-items: center;\n  gap: ",";\n"]);return oa=function(){return e},e}function ol(){let e=(0,i.Z)(["\n  margin-left: ",";\n  margin-right: auto;\n"]);return ol=function(){return e},e}function oc(){let e=(0,i.Z)(["\n  font-weight: 400;\n  color: ",";\n"]);return oc=function(){return e},e}function os(){let e=(0,i.Z)(["\n  padding: 0;\n  flex-direction: column;\n  gap: ",";\n"]);return os=function(){return e},e}let od=A.ZP.div.withConfig({componentId:"sc-d43d547e-0"})(iX(),e=>{let{theme:n}=e;return n.spacing.xl},e=>{let{theme:n,noBorder:t}=e;return t?"none":"1px solid ".concat(n.colors.global.line.Line2)},e=>{let{theme:n}=e;return n.radii.xl},e=>{let{theme:n}=e;return n.colors.global.background.BG2},(0,iY.qC)(iY.GQ,iY.eC,iY.bK,iY.Dh)),ou=A.ZP.div.withConfig({componentId:"sc-d43d547e-1"})(iG(),e=>{let{theme:n}=e;return n.spacing["2xl"]}),op=A.ZP.div.withConfig({componentId:"sc-d43d547e-2"})(iH()),og=A.ZP.div.withConfig({componentId:"sc-d43d547e-3"})(iV(),I.mTC),om=(0,A.ZP)(I.tuJ).withConfig({componentId:"sc-d43d547e-4"})(iJ(),I.mTC,e=>{let{theme:n}=e;return n.spacing.xl}),of=A.ZP.div.withConfig({componentId:"sc-d43d547e-5"})(iK(),e=>{let{theme:n}=e;return n.spacing.xl}),oh=A.ZP.div.withConfig({componentId:"sc-d43d547e-6"})(i$()),ox=A.ZP.div.withConfig({componentId:"sc-d43d547e-7"})(iQ(),e=>{let{theme:n}=e;return n.spacing.xl}),ov=(0,A.ZP)(I.mI).withConfig({componentId:"sc-d43d547e-8"})(i0(),e=>{let{theme:n}=e;return n.colors.global.text.T2}),ok=(0,A.ZP)(I.huw).withConfig({componentId:"sc-d43d547e-9"})(i1()),ob=(0,A.ZP)(I.ayo).withConfig({componentId:"sc-d43d547e-10"})(i2(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),ow=A.ZP.div.withConfig({componentId:"sc-d43d547e-11"})(i4()),oI=A.ZP.div.withConfig({componentId:"sc-d43d547e-12"})(i8(),e=>{let{theme:n}=e;return n.spacing.md}),oj=A.ZP.div.withConfig({componentId:"sc-d43d547e-13"})(i9()),oA=A.ZP.div.withConfig({componentId:"sc-d43d547e-14"})(i3(),e=>{let{theme:n}=e;return n.spacing.md}),oP=(0,A.ZP)(I.pNS).withConfig({componentId:"sc-d43d547e-15"})(i7()),oy=(0,A.ZP)(I.zxk).withConfig({componentId:"sc-d43d547e-16"})(i5(),e=>{let{theme:n}=e;return n.radii.round}),oC=A.ZP.div.withConfig({componentId:"sc-d43d547e-17"})(i6(),e=>{let{theme:n}=e;return n.spacing.lg}),oT=A.ZP.div.withConfig({componentId:"sc-d43d547e-18"})(oe()),oS=(0,A.ZP)(eP.Z).withConfig({componentId:"sc-d43d547e-19"})(on(),e=>{let{theme:n}=e;return n.colors.global.warning},e=>{let{theme:n}=e;return n.colors.global.warning}),oZ=(0,A.ZP)(eC.Z).withConfig({componentId:"sc-d43d547e-20"})(ot(),e=>{let{theme:n}=e;return n.colors.global.warning},e=>{let{theme:n}=e;return n.colors.global.warning}),oR=(0,A.ZP)(I.mI).withConfig({componentId:"sc-d43d547e-21"})(oi(),e=>{let{theme:n}=e;return n.colors.global.text.T3}),oB=(0,A.ZP)(I.mI).withConfig({componentId:"sc-d43d547e-22"})(oo(),e=>{let{theme:n}=e;return n.spacing.md},e=>{let{theme:n}=e;return n.colors.global.text.T1}),oL=(0,A.ZP)(od).withConfig({componentId:"sc-d43d547e-23"})(or(),e=>{let{theme:n}=e;return n.spacing.lg}),oN=(0,A.ZP)(I.kCb).withConfig({componentId:"sc-d43d547e-24"})(oa(),e=>{let{theme:n}=e;return n.spacing.xl}),oM=(0,A.ZP)(I.UE9).withConfig({componentId:"sc-d43d547e-25"})(ol(),e=>{let{theme:n}=e;return n.spacing.md}),oD=A.ZP.div.withConfig({componentId:"sc-d43d547e-26"})(oc(),e=>{let{theme:n}=e;return n.colors.global.text.T3}),oF=(0,A.ZP)(od).withConfig({componentId:"sc-d43d547e-27"})(os(),e=>{let{theme:n}=e;return n.spacing.md}),oE=e=>{let{details:n}=e,{addSnackbar:t}=(0,u.D)(),{ammEnum:i,networkId:a}=(0,r.L)(),{ifAuthorized:l,isAOStatusLoading:c}=(0,C._Y)(),{data:s}=(0,eZ.m)(),{data:d,isLoading:g,mutate:m}=(0,eT.A)(n.positionId),f=e=>{t("Re-enable position authorization in progress.","completed"),(0,p.ir)(i,a,n.positionId,{signature:e.signature,deadline:String(e.deadline)}).then(e=>{m(),t("Re-enable position authorization succeeded!","completed")}).catch(e=>{t("Re-enable position authorization has failed: "+e,"failed")})};return(0,o.jsxs)(o.Fragment,{children:[!(0,F.H0)()&&(0,o.jsxs)("div",{children:[" ","PositionId: ",n.positionId," tickLower: ",n.tickLower," ","tickUpper: ",n.tickUpper,(0,o.jsx)("br",{}),"AO: ",String(l)," ",(0,o.jsx)("br",{}),"AO loading: ",String(c)," ",(0,o.jsx)("br",{}),"PositionPermit: ",String(d)]}),!(l||g||d)&&(n.autoCompound||n.rebalanced||n.prescheduled)&&(0,o.jsx)(I.P_k,{variant:"warning",text:"Single position authorization permit expired or Authorized Operator status has been revoked. All triggers have become invalid. You can re-enable the singe position authorization to activate the triggers or go to Dashboard > Authorize Operator to grant operator status for all positions.",button:s?(0,o.jsx)(oS,{text:"Re-enable",color:"secondary",positionIdBN:n.positionIdBN,tokenPair:"".concat(n.tokenA.ticker,"-").concat(n.tokenB.ticker),onApproved:m}):(0,o.jsx)(oZ,{color:"secondary",positionId:n.positionIdBN,tokenPair:"".concat(n.tokenA.ticker,"-").concat(n.tokenB.ticker),setPermitInfo:e=>f(e),children:"Re-enable"}),showClose:!1})]})};var oq=t(24262),oO=t(30824),oz=t(76571),o_=t(22117),oU=t.n(o_),oW=t(8768);let oY=e=>{let{details:n,positionDetails:t,tokenPrices:i,triggers:a,strategyDetail:c,autoCompoundOn:s,goto:m}=e,f=n.tokenA,x=n.tokenB,{networkId:v}=(0,r.L)(),k=(0,j.useCallback)(e=>{let{token0:t,token1:i}=(0,ee.UZ)(f,x,n.chainId);return(0,q.tickToPrice)(t,i,e).toFixed(t.decimals)},[n.chainId,f,x]),b=(0,j.useCallback)(e=>t?(0,p.UA)(v,n,t.position,e.action.tickLower,e.action.tickUpper,i,void 0,e):[{amount:"0",percent:"0"},{amount:"0",percent:"0"}],[n,t,i]),{address:w,chain:A}=(0,P.m)(),{mutate:y}=(0,h.w)(),{data:C,error:T,isSuccess:S,signMessage:R,isError:B}=(0,oW.Q)(),{ifAuthorized:L}=(0,eS.I)(),{data:N,isLoading:M}=(0,eT.A)(n.positionId),{addSnackbar:D}=(0,u.D)(),[F,E]=(0,j.useState)(void 0),{showModal:O,hideModal:z}=(0,I.ddY)(),_=(0,iU.useRouter)(),{setStrategyPage:U}=(0,d.q)(),W=(0,j.useCallback)(e=>{_.push({pathname:"/recurring-rebalance",query:{[l.EM.STRATEGY_ID]:e.action.strategyId}})},[_]),Y=(0,j.useCallback)(e=>{U("details"),W(e)},[m]),X=(0,j.useCallback)(e=>{"Close"===e.action.type?m.removeLP(1,e):"Rebalance"===e.action.type?m.rebalance(1,e):iF.w.includes(e.action.type)&&(U("edit"),W(e))},[m]),H=e=>{let t=a.find(n=>n.taskId===e),i=t.action,o="RecurringPrice"===i.type||"RecurringPercentage"===i.type||"RecurringRatio"===i.type||"RecurringDualAction"===i.type;if(o){let{rebalancesExecuted:e,...i}=(0,oz.Dc)(n,t,c);O(oq.K,{...i,taskId:t.taskId,onClose:()=>z()})}else V(e)},V=(0,j.useCallback)(e=>{let n={ownerAddr:w,chainId:A.id,taskId:e};E(n);let t=oU()(n);R({account:w,message:t})},[w,A,R]);(0,j.useEffect)(()=>{if(S&&F&&C){let e=a.find(e=>e.taskId===F.taskId),n="Close"===e.action.type?"Closure":e.action.type,t=(0,g.s2)(e);(0,g.ZW)(F,C).then(e=>{D("Your ".concat(t.toLowerCase()," trigger for the ").concat(f.ticker,"-").concat(x.ticker," position ").concat(n.toLowerCase()," has been deleted."),"completed"),z(),y()}).catch(e=>{D("Your delete trigger request has failed: "+e.message,"failed")})}},[S]),(0,j.useEffect)(()=>{B&&D("Failed: "+T.message,"failed")},[B]);let J=(0,j.useCallback)(()=>(0,o.jsx)(oO.w,{chainId:n.chainId,positionId:n.positionId}),[n.positionId]),K=G().groupBy(a,e=>e.action.type),$=(0,j.useCallback)(e=>!L||e.lastFailedMessage?"Rebalance Failed":"",[L]);return(0,o.jsx)(I.tuJ,{gap:"xl",children:oX.map(e=>(0,o.jsx)(I.pZE,{getErrorTag:$,getPrice:k,getPercentage:Z.jw,projectLP:b,tickRange:[n.tickLower,n.tickUpper],tokens:[f,x],chainId:n.chainId,triggers:K[e],enableEdit:L||M||!!N,onEdit:X,onDelete:H,onClickGoTo:Y,executedTimes:null==c?void 0:c.executed,autoCompoundOn:s,renderNotification:J},e))})},oX=["Close","Rebalance","RecurringPercentage","RecurringPrice","RecurringRatio","RecurringDualAction"],oG=e=>{var n,t,i,a,u,m,f,x,k;let{navBack:b,details:w,goto:A}=e,{showModal:y}=(0,I.ddY)(),{address:C}=(0,P.m)(),{state:T,setModalState:S}=(0,nx.dd)(),{isOpen:Z}=T[i_.yI.STAKE_POSITION_MODAL],{ammEnum:B,network:L,networkId:M}=(0,r.L)(),q="SLIPSTREAM"===B?w.tickSpacing:w.feeTier,{data:O,isLoading:z,mutate:_}=(0,et.m)(w.tokenA.address,w.tokenB.address,[q]),{data:U}=(0,v.b)(C),{data:W}=D(w.positionId),{data:G}=(0,iE.M)(w.positionId),{currentTokenPrice:H}=(0,R.P)(M),{data:V,isLoading:J}=(0,iz.i)(w.positionId),[K,$]=(0,j.useState)(w.tokenB.ticker),Q=(0,iU.useRouter)(),{setPosition:en,setStrategyPage:ei}=(0,d.q)(),{isLoading:eo,data:er}=(0,iO.B)(C),ea=(0,iD.mP)(),el=(0,j.useMemo)(()=>{if(!U||!H)return;let e=(0,X.keyBy)(U[w.chainId],"positionId");if((null==G?void 0:G.length)>0){let n=G[G.length-1];return e[n.tokenId]}},[U,H,w.chainId,G]),ec=(0,j.useMemo)(()=>{var e,n;return(0,ee.zu)(w.tokenA.amount,w.tokenB.amount,(null==H?void 0:null===(e=H[w.tokenA.address])||void 0===e?void 0:e.price)||"0",(null==H?void 0:null===(n=H[w.tokenB.address])||void 0===n?void 0:n.price)||"0")},[w.tokenA.amount,w.tokenA.address,w.tokenB.amount,w.tokenB.address,H]),{stakePool:es,staked:ed,setStaked:eu}=(0,s.i)();(0,j.useEffect)(()=>{z||(null==O?void 0:O[q])||_()},[z]);let ep=(null==O?void 0:O[q])?(0,E.gg)(O[q][K===w.tokenA.ticker?"tokenA":"tokenB"]):"0",{data:eg}=(0,h.w)(),em=w.closed?[]:(0,g.nZ)(null==eg?void 0:eg[w.chainId],[N.ActionTypeEnum.Values.Close,N.ActionTypeEnum.Values.Rebalance,...iF.w],w.positionId),ef=w.closed?void 0:(0,g.nZ)(null==eg?void 0:eg[w.chainId],"Reinvest",w.positionId)[0],eh=em.find(e=>iF.w.includes(e.action.type)),ex=null===(n=null==eh?void 0:eh.action)||void 0===n?void 0:n.strategyId,{data:ev}=(0,iq.T)(ex),ek=(0,j.useCallback)(()=>{let e=[{Icon:w.tokenA.Icon,ticker:w.tokenA.ticker,amount:w.tokenA.collectableAmount,address:w.tokenA.address},{Icon:w.tokenB.Icon,ticker:w.tokenB.ticker,amount:w.tokenB.collectableAmount,address:w.tokenB.address}];y(iw,{total:w.feeAmount,tokenInfo:e,positionId:w.positionIdBN,stakePool:es,staked:ed,setStaked:eu})},[w,es,ed,y]),eb=(0,j.useCallback)(()=>{var e,n;y(iZ,{positionId:w.positionId,positionIdBN:w.positionIdBN,liquidity:w.liquidity,feeAmount:w.feeAmount,feeTier:w.feeTier,tokens:[w.tokenA,w.tokenB],tokenPrices:[(null==H?void 0:null===(e=H[w.tokenA.address])||void 0===e?void 0:e.price)||"0",(null==H?void 0:null===(n=H[w.tokenB.address])||void 0===n?void 0:n.price)||"0"],tokenPercentages:[ec.token0Percent,ec.token1Percent],stakePool:es,staked:ed,setStaked:eu})},[w,ec,H,es,ed,y]),ew=(0,j.useCallback)(()=>{ex?(ei("edit"),Q.push({pathname:"/recurring-rebalance",query:{[l.EM.STRATEGY_ID]:ex}})):(en(w),Q.push({pathname:"/recurring-rebalance/create",query:{[l.EM.PID]:"".concat(w.chainId,"-").concat(w.positionId)}}))},[w,ex]),eI=(0,j.useMemo)(()=>[{label:"Add Liquidity",onClick:()=>A.addLP()},{label:"Remove Liquidity",onClick:()=>A.removeLP(0),disabled:w.closed},{label:"Collect Fees",onClick:ek,disabled:0>=Y().compareTo(w.tokenA.collectableAmount,0)&&0>=Y().compareTo(w.tokenB.collectableAmount,0)},{label:"Rebalance",onClick:()=>A.rebalance(0),disabled:w.closed},{label:"Recurring Rebalance",onClick:ew,disabled:(0,c.TN)(L)||w.closed},{label:"Automated Rebalance",onClick:()=>A.rebalance(1),disabled:(0,c.TN)(L)||w.closed},{label:"Prescheduled Position Close",onClick:()=>A.removeLP(1),disabled:(0,c.TN)(L)||w.closed}],[w.closed,w.feeAmount,A,ek]),ej=e=>{S(i_.yI.STAKE_POSITION_MODAL,e)},eA=(0,j.useCallback)(e=>{Q.push({pathname:"/liquidity-management",query:{[l.EM.PID]:e}})},[Q]);return(0,o.jsxs)(ou,{children:[(0,o.jsx)(I.iIr,{onClick:b,isDrawer:!0,children:(0,o.jsx)(I.Bpc,{fontWeight:500,textAlign:"end",children:"Back to Dashboard"})}),(0,o.jsx)(og,{children:(0,o.jsx)(I.TFc,{actions:eI,isInRange:w.inRange,atStake:ed,tokens:[w.tokenA,w.tokenB],tag:"".concat(w.feeTier/I.m3W,"%"),closed:w.closed})}),(0,o.jsx)(op,{children:(0,o.jsxs)(om,{children:[(0,o.jsxs)(of,{children:["UNISWAP_V3"===B&&(0,o.jsx)(oh,{children:J?(0,o.jsx)(I.jxZ,{size:"100%",height:"308px",radius:"25px"}):V&&(0,o.jsx)(nx.qR,{NFTStr:V})}),(0,o.jsxs)(ox,{children:[(0,o.jsxs)(od,{justifyContent:"space-between",children:[(0,o.jsxs)(oj,{children:[(0,o.jsx)(ov,{mb:"8px",children:"Liquidity"}),(0,o.jsx)(ob,{children:(0,E.oS)(w.liquidity)}),(0,o.jsxs)(oI,{children:[(0,o.jsx)(I.sXs,{marginBottom:12,Icon:w.tokenA.Icon,ticker:w.tokenA.ticker,address:w.tokenA.address,native:w.tokenA.native,decimals:w.tokenA.decimals,amount:w.tokenA.amount,maxWidth:118,price:(null==H?void 0:null===(t=H[w.tokenA.address])||void 0===t?void 0:t.price)||"0",tag:"".concat(ec.token0Percent,"%")},w.tokenA.address),(0,o.jsx)(I.sXs,{Icon:w.tokenB.Icon,ticker:w.tokenB.ticker,address:w.tokenB.address,native:w.tokenB.native,decimals:w.tokenB.decimals,amount:w.tokenB.amount,maxWidth:118,price:(null==H?void 0:null===(i=H[w.tokenB.address])||void 0===i?void 0:i.price)||"0",tag:"".concat(ec.token1Percent,"%")},w.tokenB.address)]})]}),(0,o.jsxs)(oA,{children:[(0,o.jsx)(oy,{variant:"contained",color:"secondary",size:"xs",onClick:()=>A.addLP(),children:(0,o.jsx)(oP,{children:"Add Liquidity"})}),(0,o.jsx)(oy,{variant:"contained",color:"default",size:"xs",disabled:w.closed,onClick:()=>A.removeLP(0),children:(0,o.jsx)(oP,{children:"Remove Liquidity"})})]})]}),(0,o.jsx)(od,{flexDirection:"column",children:(0,o.jsxs)(oC,{children:[(0,o.jsxs)(oj,{children:[(0,o.jsx)(ov,{mb:"8px",children:"Unclaimed Fees"}),(0,o.jsx)(ob,{lineHeight:"38px",children:(0,E.oS)(w.feeAmount)}),(0,o.jsxs)(oI,{children:[(0,o.jsx)(I.sXs,{marginBottom:12,Icon:w.tokenA.Icon,ticker:w.tokenA.ticker,address:w.tokenA.address,native:w.tokenA.native,decimals:w.tokenA.decimals,amount:w.tokenA.collectableAmount,maxWidth:118,price:(null==H?void 0:null===(a=H[w.tokenA.address])||void 0===a?void 0:a.price)||"0"},w.tokenA.address),(0,o.jsx)(I.sXs,{Icon:w.tokenB.Icon,ticker:w.tokenB.ticker,address:w.tokenB.address,native:w.tokenB.native,decimals:w.tokenB.decimals,amount:w.tokenB.collectableAmount,maxWidth:118,price:(null==H?void 0:null===(u=H[w.tokenB.address])||void 0===u?void 0:u.price)||"0"},w.tokenB.address)]})]}),(0,o.jsxs)(oT,{children:[!(0,c.TN)(L)&&(0,o.jsx)(iW.O,{details:w,autoCompound:ef}),(0,o.jsxs)(oA,{children:[(0,o.jsx)(oy,{variant:"contained",color:"secondary",size:"xs",width:"130px",onClick:eb,disabled:0>=Y().compareTo(w.tokenA.collectableAmount,0)&&0>=Y().compareTo(w.tokenB.collectableAmount,0),children:(0,o.jsx)(oP,{children:"Reinvest"})}),(0,o.jsx)(oy,{variant:"contained",color:"secondary",size:"xs",width:"130px",onClick:ek,disabled:0>=Y().compareTo(w.tokenA.collectableAmount,0)&&0>=Y().compareTo(w.tokenB.collectableAmount,0),children:(0,o.jsx)(oP,{children:"Collect Fees"})})]})]})]})})]})]}),(null==w?void 0:w.autoCompound)&&(null==ef?void 0:ef.lastFailedMessage)&&(0,o.jsx)(I.P_k,{variant:"warning",text:ef.lastFailedMessage,showClose:!0}),(0,o.jsx)(oE,{details:w}),(0,o.jsxs)(oL,{noBorder:!0,children:[(0,o.jsxs)(oN,{children:[(0,o.jsx)(ok,{children:"Price Range"}),!w.closed&&(0,o.jsx)(oM,{closed:w.closed,inRange:w.inRange}),(0,o.jsx)(ow,{children:(0,o.jsx)(oy,{variant:"contained",color:"secondary",size:"xs",width:"130px",disabled:w.closed,onClick:()=>A.rebalance(0),children:(0,o.jsx)(oP,{children:"Rebalance"})})})]}),(0,o.jsx)(I.$15,{buyToken:{ticker:w.tokenA.ticker,min:Y().compareTo(w.minPrice,0)>0&&0===Y().compareTo(Y().divide(1,w.minPrice,18),0)?"∞":(0,E.T4)(w.minPrice),max:Y().compareTo(w.maxPrice,0)>0&&0===Y().compareTo(Y().divide(1,w.maxPrice,18),0)?"∞":(0,E.T4)(w.maxPrice)},sellToken:{ticker:w.tokenB.ticker,min:0===Y().compareTo(w.maxPrice,0)?"∞":(0,E.T4)(Y().divide(1,w.maxPrice,18)),max:0===Y().compareTo(w.minPrice,0)?"∞":(0,E.T4)(Y().divide(1,w.minPrice,18))},title:(0,o.jsxs)(oR,{children:["Market Price:",(0,o.jsxs)(oB,{children:[ep,(0,o.jsx)(oD,{children:K===w.tokenA.ticker?"".concat(w.tokenB.ticker," per ").concat(w.tokenA.ticker):"".concat(w.tokenA.ticker," per ").concat(w.tokenB.ticker)})]})]}),setSelected:e=>$(e)})]}),em&&em.length>0&&(0,o.jsx)(oY,{details:w,positionDetails:W,tokenPrices:[(null==H?void 0:null===(m=H[w.tokenA.address])||void 0===m?void 0:m.price)||"0",(null==H?void 0:null===(f=H[w.tokenB.address])||void 0===f?void 0:f.price)||"0"],triggers:em,goto:A,strategyDetail:ev,autoCompoundOn:!!ef}),(0,o.jsxs)(oF,{noBorder:!0,children:[(0,o.jsx)(ok,{children:"Liquidity Intents Tools"}),(0,o.jsxs)(nx.kC,{gap:"xl",children:[(0,o.jsx)(I.tl8,{title:"Recurring Rebalance",subTitle:"We will allow users to define a new recurring range around a future spot price triggered by price percentages, absolute token terms, or token ratios.",disabled:w.closed,nextClick:ew,comingSoon:(0,c.TN)(L),width:"224.5px"}),(0,o.jsx)(I.tl8,{title:"Automated Rebalance",subTitle:"Create a trigger for a pre-set rebalance based on pricing signals or time based logic.",disabled:w.closed,nextClick:()=>A.rebalance(1),comingSoon:(0,c.TN)(L),width:"224.5px"})]}),(0,o.jsx)(I.tl8,{title:"Prescheduled Position Close",subTitle:"Create a trigger for a position closure based on pricing signals or time based logic.",disabled:w.closed,nextClick:()=>A.removeLP(1),comingSoon:(0,c.TN)(L)})]}),"SLIPSTREAM"===B&&F.YN.includes(M)&&(0,o.jsxs)(oF,{noBorder:!0,flexDirection:"column",children:[(0,o.jsx)(ok,{children:"Liquidity Position Stake"}),(0,o.jsx)(I.tl8,{title:"".concat((0,F.op)(M)," Position Stake"),nextClick:()=>ej(!0)}),(0,o.jsx)(i_.u_,{disableBackgroundOnClose:!0,isModalOpen:Z,onClose:()=>ej(!1),padding:24,children:(0,o.jsx)(iM,{})})]}),ea&&!eo&&(null==er?void 0:null===(x=er[w.chainId])||void 0===x?void 0:x[w.positionId])&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nx.qc,{...(0,p.Pu)(w,null==er?void 0:null===(k=er[w.chainId])||void 0===k?void 0:k[w.positionId])}),!!w&&(null==G?void 0:G.length)>0&&(0,o.jsx)(nx.C0,{...(0,p.fo)(w,el,G,H,M,eA)})]})]})})]})},oH=e=>{let{navBack:n,details:t,navToPage:i}=e,{resetSolver:r}=(0,C.Dn)(),[a,l]=(0,j.useState)(null!=i?i:"details"),[c,s]=(0,j.useState)(0),[d,u]=(0,j.useState)(void 0),p=(0,j.useMemo)(()=>({details:()=>l("details"),addLP:()=>l("addLP"),removeLP:(e,n)=>{l("removeLP"),s(e),u(n)},rebalance:(e,n)=>{l("rebalance"),s(e),u(n)}}),[l,s,u]);return(0,j.useEffect)(()=>{r(),l(null!=i?i:"details")},[t.positionId]),(0,T.o)(()=>{n(),l("details")}),(0,o.jsxs)(o.Fragment,{children:["details"===a&&(0,o.jsx)(oG,{navBack:n,details:t,goto:p}),"addLP"===a&&(0,o.jsx)(tC,{details:t,goto:p}),"removeLP"===a&&(0,o.jsx)(ip,{details:t,goto:p,tabs:c,trigger:d}),"rebalance"===a&&(0,o.jsx)(na,{details:t,amount:"0",trigger:d,tokens:[t.tokenA,t.tokenB],feeTier:t.feeTier,goto:p,tabs:c,navBack:n})]})};var oV=t(92285);function oJ(){let e=(0,i.Z)(["\n  margin-bottom: 16px;\n"]);return oJ=function(){return e},e}function oK(){let e=(0,i.Z)(["\n  border: none;\n  color: ",';\n  text-align: center;\n  font-family: "Roboto Flex";\n  font-size: 16px;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 20px;\n']);return oK=function(){return e},e}let o$=A.ZP.div.withConfig({componentId:"sc-3f397e83-0"})(oJ()),oQ=(0,A.ZP)(eo.cs).withConfig({componentId:"sc-3f397e83-1"})(oK(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),o0=e=>{let{searchKeyword:n,showAll:t,currentChainId:i}=e,{networkId:A}=(0,r.L)(),{address:C}=(0,P.m)(),{data:T,isLoading:S}=(0,v.b)(C),{data:Z}=(0,x.y)(t,C),{data:R}=(0,k.F)(),{data:B}=(0,h.w)(),{data:L}=(0,h.w)(!0),{isReady:N}=(0,m.O)(),{positionPage:M}=(0,d.q)(),[D,F]=(0,j.useState)(null!=M?M:"details"),{selected:E,setSelected:q}=(0,a.v)(l.EM.PID),{Drawer:O,showDrawer:z,hideDrawer:_,hideIntentDrawer:U}=(0,I.yT4)(),{addSnackbar:W}=(0,u.D)(),{switchChain:Y,isError:X,error:G}=(0,y.o)(),H=(0,j.useMemo)(()=>{let e=Object.keys(null!=L?L:{}).map(Number),n={};return e.map(async e=>{var t;let i=(null==L?void 0:null===(t=L[e])||void 0===t?void 0:t.triggers).reduce((e,n)=>(n.status!==g.ht.DELETED&&e.push(n.nftId),e),[]);n[e]=i}),n},[L]),V=(0,j.useMemo)(()=>{let e=(0,c.I5)(),n=T?Object.entries(T).reduce((n,t)=>{let[o,r]=t;return"ALL_CHAINS"===i?e.includes(parseInt(o))&&n.push(r):parseInt(o)===(0,c.$D)(i)&&n.push(r),n},[]).flat():[];return(0,p.A5)(n)},[T,i]),J=(0,f.$)(e=>{E&&e!==A&&(null==Y||Y({chainId:e}))});(0,j.useEffect)(()=>{X&&(console.log("Failed to switch network",G),W("Your switch network request has failed","failed"),q(void 0))},[X]);let K=(0,j.useMemo)(()=>E?null==V?void 0:V.find(e=>"".concat(e.chainId,"-").concat(e.positionId)===E):void 0,[E,V]);(0,b.D)(V,()=>{if(E){if(!K){q(void 0);return}setTimeout(()=>{var e;null===(e=document.getElementById("Position-".concat((0,p.xi)(K))))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),F("details")},300)}}),(0,j.useEffect)(()=>{if(K){let e=K.chainId===A;e?(U(),z()):setTimeout(()=>{J(K.chainId)},300)}else _()},[K,A]);let $=(0,j.useMemo)(()=>{let e=V?t?V:V.filter(e=>!e.closed):[];return(0,p.ep)(n,e,null!=R?R:[])},[V,n,t,R]);return(0,o.jsxs)(o.Fragment,{children:[N?S?(0,o.jsx)(I.KTm,{size:"100%",height:"85px"}):(null==$?void 0:$.length)?(0,o.jsx)(oV.m,{walletAddress:C,positions:$,stakePositionIds:{[A]:R},triggerObj:B,limitOrders:H,closedPositionResults:Z}):(0,o.jsx)(eo.cs,{children:"Your active positions will appear here."}):(0,o.jsxs)(oQ,{children:[(0,o.jsx)(o$,{children:(0,o.jsx)(w.jY,{})}),"Connect wallet and select correct network."]}),(0,o.jsx)(O,{children:K&&A===K.chainId&&(0,o.jsx)(s.c,{positionId:K.positionIdBN,token0Address:K.tokenA.address,token1Address:K.tokenB.address,feeTier:K.feeTier,children:(0,o.jsx)(oH,{navBack:()=>q(void 0),details:K,navToPage:D})})})]})};function o1(){let e=(0,i.Z)(["\n  max-width: 840px;\n  margin-top: 0px;\n  align-items: ",";\n"]);return o1=function(){return e},e}function o2(){let e=(0,i.Z)(["\n  width: 100%;\n  gap: 0;\n  max-width: ",";\n"]);return o2=function(){return e},e}function o4(){let e=(0,i.Z)(["\n  width: 100%;\n  margin-bottom: ",";\n  flex-wrap: wrap;\n  row-gap: ",";\n"]);return o4=function(){return e},e}function o8(){let e=(0,i.Z)(['\n  display: inline-flex;\n  height: 40px;\n  min-width: 224px;\n  padding: 12px 20px;\n  justify-content: center;\n  align-items: center;\n  gap: 4px;\n  flex-shrink: 0;\n  font-family: "Roboto Flex";\n  font-weight: 500;\n  line-height: 16px;\n  text-transform: capitalize;\n\n  color: ',";\n  background: ",";\n\n  :hover {\n    background: ",";\n    opacity: 0.8;\n  }\n"]);return o8=function(){return e},e}function o9(){let e=(0,i.Z)(["\n  width: 12px;\n  height: 12px;\n  stroke: ",";\n"]);return o9=function(){return e},e}function o3(){let e=(0,i.Z)(["\n  min-width: 158px;\n  height: 42px;\n  gap: ",";\n  color: ",";\n  background: ",";\n  &:hover {\n    background: ",";\n    opacity: 0.8;\n  }\n  &:disabled {\n    background: ",";\n    opacity: 1;\n  }\n"]);return o3=function(){return e},e}function o7(){let e=(0,i.Z)(["\n  width: 100%;\n  margin: 20px 0;\n  gap: ",";\n  flex-direction: ",";\n  justify-content: space-between;\n"]);return o7=function(){return e},e}function o5(){let e=(0,i.Z)(["\n  color: ",';\n  font-family: "Dunbar Tall";\n  font-style: normal;\n  transform: none;\n  backface-visibility: hidden;\n']);return o5=function(){return e},e}function o6(){let e=(0,i.Z)(["\n  margin: auto 0;\n  gap: ",";\n"]);return o6=function(){return e},e}function re(){let e=(0,i.Z)(["\n  width: 100%;\n"]);return re=function(){return e},e}function rn(){let e=(0,i.Z)(["\n  align-items: center;\n  gap: ",";\n"]);return rn=function(){return e},e}function rt(){let e=(0,i.Z)(["\n  width: 100%;\n  justify-content: space-between;\n  margin-top: -8px;\n  margin-bottom: 12px;\n  gap: ",";\n"]);return rt=function(){return e},e}function ri(){let e=(0,i.Z)(["\n  align-items: center;\n  gap: ",";\n"]);return ri=function(){return e},e}function ro(){let e=(0,i.Z)(['\n  font-family: "Roboto Flex";\n  font-size: 16px;\n  font-weight: 400;\n  line-height: 20px;\n  color: ',";\n"]);return ro=function(){return e},e}function rr(){let e=(0,i.Z)(['\n  margin-right: 8px;\n  text-decoration-line: none;\n  font-family: "Roboto Flex";\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 16px;\n  text-transform: capitalize;\n  color: ',";\n  :hover {\n    color: ",";\n  }\n"]);return rr=function(){return e},e}function ra(){let e=(0,i.Z)(["\n  align-self: flex-start;\n  margin-top: auto;\n  margin-bottom: auto;\n"]);return ra=function(){return e},e}let rl=(0,A.ZP)(eo._z).withConfig({componentId:"sc-927c9814-0"})(o1(),e=>{let{drawerOpen:n}=e;return n?"flex-end":"center"}),rc=(0,A.ZP)(I.tuJ).withConfig({componentId:"sc-927c9814-1"})(o2(),e=>{let{drawerOpen:n}=e;return n?I.FsO:"100%"}),rs=(0,A.ZP)(I.kCb).withConfig({componentId:"sc-927c9814-2"})(o4(),e=>{let{theme:n}=e;return n.spacing.xl},e=>{let{theme:n}=e;return n.spacing.xl}),rd=(0,A.ZP)(I.Yd2).withConfig({componentId:"sc-927c9814-3"})(o8(),e=>{let{theme:n}=e;return n.colors.global.text.T1},e=>{let{theme:n}=e;return n.colors.global.background.BG2},e=>{let{theme:n}=e;return n.colors.global.background.BG2}),ru=(0,A.ZP)(w.$D).withConfig({componentId:"sc-927c9814-4"})(o9(),e=>{let{theme:n}=e;return n.colors.global.primary}),rp=(0,A.ZP)(I.Yd2).withConfig({componentId:"sc-927c9814-5"})(o3(),e=>{let{theme:n}=e;return n.spacing.md},e=>{let{theme:n}=e;return n.colors.global.textAlt.T1},e=>{let{theme:n}=e;return n.colors.global.primary},e=>{let{theme:n}=e;return n.colors.global.primary},e=>{let{theme:n}=e;return n.colors.primary.lightPurple}),rg=(0,A.ZP)(I.kCb).withConfig({componentId:"sc-927c9814-6"})(o7(),e=>{let{theme:n,drawerOpen:t}=e;return t?n.spacing.xl:0},e=>{let{drawerOpen:n}=e;return n?"column":"row"}),rm=(0,A.ZP)(I.iHY).withConfig({componentId:"sc-927c9814-7"})(o5(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),rf=(0,A.ZP)(I.kCb).withConfig({componentId:"sc-927c9814-8"})(o6(),e=>{let{theme:n}=e;return n.spacing.lg}),rh=A.ZP.div.withConfig({componentId:"sc-927c9814-9"})(re()),rx=(0,A.ZP)(I.kCb).withConfig({componentId:"sc-927c9814-10"})(rn(),e=>{let{theme:n}=e;return n.spacing.md}),rv=(0,A.ZP)(I.kCb).withConfig({componentId:"sc-927c9814-11"})(rt(),e=>{let{theme:n}=e;return n.spacing.md}),rk=(0,A.ZP)(I.kCb).withConfig({componentId:"sc-927c9814-12"})(ri(),e=>{let{theme:n}=e;return n.spacing.xl}),rb=A.ZP.div.withConfig({componentId:"sc-927c9814-13"})(ro(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),rw=(0,A.ZP)(I.zxk).withConfig({componentId:"sc-927c9814-14"})(rr(),e=>{let{theme:n}=e;return n.colors.global.text.T1},e=>{let{theme:n}=e;return n.colors.global.text.T1}),rI=(0,A.ZP)(I.VOW).withConfig({componentId:"sc-927c9814-15"})(ra()),rj=()=>{let{amm:e,network:n}=(0,r.L)(),t=(0,iU.useRouter)(),i=(0,A.Fg)(),[s,d]=(0,j.useState)(""),[u,p]=(0,j.useState)(!1),{drawerOpen:g,intentDrawerOpen:m}=(0,I.yT4)(),[f,h]=(0,j.useState)(n),{selected:x,setSelected:v}=(0,a.v)(l.EM.PID),k="ALL_CHAINS"===f,b=g||m,P=(0,j.useMemo)(()=>{switch(e.name){case"Uniswap":return"Uniswap V3";case"PancakeSwap":return"PancakeSwap V3";case"ApertureSwap":return"Aperture"}},[e]);return(0,j.useEffect)(()=>{"ALL_CHAINS"!==f&&f!==n&&h(n),x&&(parseInt(x.split("-")[0])===(0,c.$D)(n)?v(x):v(void 0))},[n]),(0,o.jsx)(rl,{drawerOpen:b,children:(0,o.jsxs)(rc,{drawerOpen:b,children:[(0,o.jsxs)(rg,{drawerOpen:b,children:[(0,o.jsxs)(rm,{fontWeight:500,children:[P," ",(0,o.jsx)("br",{}),"Liquidity Positions"]}),(0,o.jsxs)(rf,{children:[(0,o.jsx)(I.MjL,{width:192,placeholder:"Search Position",onChange:e=>d(e.trim())}),(0,o.jsxs)(rp,{onClick:()=>t.push("/new-position"),children:[(0,o.jsx)(w.dt,{width:16,height:16,fill:i.colors.global.textAlt.T1}),(0,o.jsx)(I.Bpc,{fontSize:"14px",children:"New Position"})]})]})]}),!g&&(0,c.TN)(n)&&(0,o.jsx)(rv,{children:(0,o.jsxs)(rk,{children:[(0,o.jsxs)(rd,{onClick:e=>{e.stopPropagation(),window.open("https://info.aperture.finance/","_blank")},children:[(0,o.jsx)(I.oD,{padding:"0 4px",fontSize:14,lineHeight:"46px",height:"46px",children:"ApertureSwap Top Pools"}),(0,o.jsx)(ru,{})]}),(0,o.jsxs)(rd,{onClick:e=>{e.stopPropagation(),window.open("https://pacific-bridge.manta.network/","_blank")},children:[(0,o.jsx)(I.oD,{padding:"0 4px",fontSize:14,lineHeight:"46px",height:"46px",children:"Bridge assets to Manta Pacific"}),(0,o.jsx)(ru,{})]})]})}),(0,o.jsxs)(rs,{justifyContent:"space-between",children:[(0,o.jsx)(rI,{amm:e,chainId:n}),(0,o.jsxs)(I.kCb,{gap:"md",alignItems:"center",children:[(0,o.jsx)(I.mGS,{noText:!0,onStatus:k,onChange:()=>h(k?n:"ALL_CHAINS")}),(0,o.jsx)(rb,{children:"Show All Chains"}),(0,o.jsx)(I.OXH,{sm:!0,overlapRight:!0})]})]}),(0,o.jsx)(rh,{children:(0,o.jsxs)(I.tuJ,{children:[(0,o.jsx)(eo.s0,{lineHeight:"20px",children:(0,o.jsxs)(rx,{children:[(0,o.jsx)("span",{children:"Active Positions"}),(0,o.jsx)(I.mGS,{initTop:2,initLeft:2,marginLeft:8,noText:!0,onStatus:u,onChange:()=>p(!u)}),(0,o.jsxs)(rw,{variant:"text",color:"default",size:"xs",onClick:()=>p(!u),children:[u?"Hide":"Show"," Closed Positions"]})]})}),(0,o.jsx)(o0,{searchKeyword:s,showAll:u,currentChainId:f})]})})]})})};var rA=rj}},function(e){e.O(0,[9458,2467,7883,2089,7183,1615,4965,1625,9103,2888,179],function(){return e(e.s=83833)}),_N_E=e.O()}]);
//# sourceMappingURL=liquidity-management-ba492e2b57bb3201.js.map