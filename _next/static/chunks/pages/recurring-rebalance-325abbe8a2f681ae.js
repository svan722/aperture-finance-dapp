(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2670],{66563:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/recurring-rebalance",function(){return t(44026)}])},44026:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eP}});var i=t(92228),o=t(79570),r=t(69987),l=t(16405),s=t(24002);let d=()=>{let{ifAuthorized:e,toggleAOStatusAsync:n,isAOStatusLoading:t}=(0,s._Y)(),[i,d]=(0,l.useState)(e),c=(0,l.useCallback)(e=>{d(e),n().catch(()=>{d(e=>!e)})},[n]);return(0,l.useEffect)(()=>{d(e)},[e]),(0,o.jsx)(r.SM3,{onStatus:i,isLoading:t,onChange:c,disabled:t||void 0===e})};var c=t(62942),u=t(13321),a=t(11141),f=t(76793),p=t(65195),h=t.n(p),g=t(92321),m=t(23609),x=t(4250),w=t(64928);let v=()=>{let{networkId:e}=(0,c.L)(),{address:n}=(0,g.m)(),{data:t,isLoading:i,...o}=(0,x.t)(),{positionList:r}=(0,m.d)(n),{data:s,isLoading:d}=(0,w.w)(!1),u=(0,l.useMemo)(()=>r&&s&&h().keyBy(r.filter(e=>!e.closed).map(n=>({...n,autoCompound:(0,f.nZ)(s[e],"Reinvest",n.positionId).length>0})),"positionId"),[s,e,r]),a=(0,l.useMemo)(()=>t&&u&&t.map(e=>{var n;return{strategy:e,position:u[null===(n=e.current[0])||void 0===n?void 0:n.nftId]}}).filter(e=>e.position),[u,t]);return{data:a,isLoading:i||d||!r,...o}};var C=t(2656),j=t(78714),k=t(1127),b=t(31900),I=t(85464),y=t(64252),T=t(17625),Z=t(44850),P=t.n(Z),A=t(58694),_=t(80631),S=t(30990),B=t(41738),E=t(44455),L=t(24262),O=t(30824),M=t(76571),D=t(87076),V=t(66360),Y=t(14566),N=t(61029),R=t(83492);function U(){let e=(0,i.Z)(["\n  gap: ",";\n  height: 100%;\n"]);return U=function(){return e},e}function z(){let e=(0,i.Z)(["\n  overflow-x: hidden;\n  height: calc(100vh - 136px);\n  overflow-y: auto;\n  scrollbar-width: none;\n"]);return z=function(){return e},e}function W(){let e=(0,i.Z)(["\n  width: ",";\n  gap: ",";\n"]);return W=function(){return e},e}function F(){let e=(0,i.Z)(["\n  gap: ",";\n  justify-content: flex-start;\n  align-items: flex-start;\n  margin-bottom: ",";\n"]);return F=function(){return e},e}function q(){let e=(0,i.Z)(['\n  font-weight: 500;\n  font-family: "Dunbar Tall";\n  color: ',";\n"]);return q=function(){return e},e}function J(){let e=(0,i.Z)(["\n  width: 100%;\n  border: 0.5px solid ",";\n"]);return J=function(){return e},e}let H=(0,A.ZP)(r.tuJ).withConfig({componentId:"sc-20cb2700-0"})(U(),e=>{let{theme:n}=e;return n.spacing["2xl"]}),K=(0,A.ZP)(r.tuJ).withConfig({componentId:"sc-20cb2700-1"})(z()),X=(0,A.ZP)(r.tuJ).withConfig({componentId:"sc-20cb2700-2"})(W(),r.mTC,e=>{let{theme:n}=e;return n.spacing.xl});(0,A.ZP)(r.kCb).withConfig({componentId:"sc-20cb2700-3"})(F(),e=>{let{theme:n}=e;return n.spacing.lg},e=>{let{theme:n}=e;return n.spacing["3xl"]});let G=(0,A.ZP)(r.iHY).withConfig({componentId:"sc-20cb2700-4"})(q(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),Q=A.ZP.div.withConfig({componentId:"sc-20cb2700-5"})(J(),e=>{let{theme:n}=e;return n.colors.global.line.Line2}),$=e=>{var n;let{navBack:t,goto:i,refresh:s}=e,{networkId:d}=(0,c.L)(),{address:u}=(0,g.m)(),{positionMap:a}=(0,m.d)(u),{position:f}=(0,E.gC)(),{showModal:p,hideModal:h}=(0,r.ddY)(),{currentTokenPrice:x}=(0,D.P)(d),w=(0,V.X)(f.positionId,f.chainId),v=(0,V.V)(f.positionId,f.chainId),C=null==v?void 0:v.action,{data:j}=(0,Y.T)(null==C?void 0:C.strategyId),k=(0,l.useMemo)(()=>{var e,n;return(0,M.Dc)(f,v,j,[(null==x?void 0:null===(e=x[f.tokenA.address])||void 0===e?void 0:e.price)||"0",(null==x?void 0:null===(n=x[f.tokenB.address])||void 0===n?void 0:n.price)||"0"])},[f,j,v]),b=(0,l.useMemo)(()=>null!==(n=null==j?void 0:j.history)&&void 0!==n?n:[],[null==j?void 0:j.history]),I=(0,l.useMemo)(()=>{if(!a)return;if(b.length<1)return[];let e=b.map(e=>({...e,position:a[e.nftId]}));return e.filter(e=>e.position).sort((e,n)=>n.creation-e.creation).map(e=>{let n=e.position,t=[n.tokenA,n.tokenB],i=e.status.charAt(0).toUpperCase()+e.status.slice(1).toLowerCase(),o=e.feeCollectedToken0UsdValue+e.feeCollectedToken1UsdValue,l=e.gas_fee_value;return{time:e.completion?(0,r.nAb)(e.completion).time:"-",date:e.completion?(0,r.nAb)(e.completion).date:"-",status:i,position:{tokens:t,feeTier:n.feeTier,priceRange:(0,y._)(n.minPrice,n.maxPrice),id:n.positionId,earned:{total:(0,N.cv)(o),token0:{amount:n.tokenA.amount,usdAmount:e.feeCollectedToken0UsdValue.toString()},token1:{amount:n.tokenB.amount,usdAmount:e.feeCollectedToken1UsdValue.toString()}},liquidity:(0,N.cv)(e.positionUsdValueWhenCompleted),fees:(0,N.cv)(l),duration:e.creation&&e.completion?(0,r.g9Y)(e.creation,e.completion):"-"}}})},[b,a]),T=(0,l.useCallback)(()=>(0,o.jsx)(O.w,{positionId:f.positionId,chainId:f.chainId}),[f.positionId]);return(0,o.jsxs)(H,{children:[(0,o.jsx)(r.iIr,{onClick:t,isDrawer:!0,children:(0,o.jsx)(r.Bpc,{fontWeight:500,textAlign:"end",children:"Back to Dashboard"})}),(0,o.jsx)(K,{children:(0,o.jsxs)(X,{children:[(0,o.jsx)(G,{children:"Strategy Detail"}),(0,o.jsx)(r.eAs,{onEdit:()=>i.edit(),onDelete:()=>{let{rebalancesExecuted:e,...n}=k;p(L.K,{...n,onClose:()=>h(),onDelete:()=>{t(),s()},taskId:v.taskId})},autoCompoundBtn:(0,o.jsx)(R.O,{details:f,autoCompound:w}),...k,renderNotification:T}),(0,o.jsx)(Q,{}),(0,o.jsx)(E.LO,{}),(0,o.jsx)(Q,{}),I&&I.length>0&&(0,o.jsx)(r.BAI,{positions:I})]})})]})},ee=e=>{let{goto:n,navBack:t}=e,{showModal:i,hideModal:s}=(0,r.ddY)(),d=(0,l.useCallback)(()=>{i(r.VxM,{type:r.okG.Cancel_Strategy_Edit,onCancel:()=>s(),onConfirm:()=>{s(),n.details(),t()},padding:16})},[s,i]);return(0,o.jsxs)(H,{children:[(0,o.jsx)(r.iIr,{onClick:()=>n.details(),isDrawer:!0,children:(0,o.jsx)(r.Bpc,{fontWeight:500,textAlign:"end",children:"Back to Dashboard"})}),(0,o.jsx)(G,{children:"Edit Strategy"}),(0,o.jsx)(E.z6,{isCreate:!1,onSave:()=>n.details(),onCancel:d,navBack:t})]})},en=e=>{let{navBack:n,navToPage:t,position:i,refresh:r}=e,[s,d]=(0,l.useState)(null!=t?t:"details");(0,l.useEffect)(()=>{d(null!=t?t:"details")},[i.positionId]);let c={navBack:n,goto:{details:()=>d("details"),edit:()=>d("edit")}};return(0,B.o)(()=>{n()}),(0,o.jsx)(E.TH,{position:i,children:(0,o.jsxs)(S.c,{positionId:i.positionIdBN,token0Address:i.tokenA.address,token1Address:i.tokenB.address,feeTier:i.feeTier,children:["details"===s&&(0,o.jsx)($,{refresh:r,...c}),"edit"===s&&(0,o.jsx)(ee,{...c})]})})};function et(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  gap: ",";\n  width: 100%;\n  min-height: 435px;\n  overflow-x: auto;\n  overflow-y: auto;\n  scrollbar-width: none;\n"]);return et=function(){return e},e}function ei(){let e=(0,i.Z)(["\n  margin-top: 132px;\n  margin-bottom: 16px;\n"]);return ei=function(){return e},e}function eo(){let e=(0,i.Z)(["\n  border: none;\n"]);return eo=function(){return e},e}function er(){let e=(0,i.Z)(["\n  color: ",';\n  text-align: center;\n  font-family: "Roboto Flex";\n  font-size: 16px;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 20px;\n']);return er=function(){return e},e}let el=A.ZP.div.withConfig({componentId:"sc-13b1943c-0"})(et(),e=>{let{theme:n}=e;return n.spacing.md}),es=A.ZP.div.withConfig({componentId:"sc-13b1943c-1"})(ei()),ed=(0,A.ZP)(_.cs).withConfig({componentId:"sc-13b1943c-2"})(eo()),ec=(0,A.ZP)(r.T59).withConfig({componentId:"sc-13b1943c-3"})(er(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),eu=e=>{let{searchKeyword:n}=e,{data:t,mutate:i,isLoading:s}=v(),{isLoading:d}=(0,j.p)(),{isReady:c}=(0,a.O)(),{Drawer:f,drawerOpen:p,showDrawer:h,hideDrawer:g}=(0,r.yT4)(),{selected:m,setSelected:x}=(0,C.v)(I.EM.STRATEGY_ID),{strategyPage:w}=(0,u.q)(),{ifAuthorized:y}=(0,k.I)(),[Z,P]=(0,l.useState)(null!=w?w:"details"),A=(0,l.useMemo)(()=>t?t.map(e=>ea(e,y)):[],[y,t]),S=(0,l.useMemo)(()=>{let e=n.toLowerCase();return e?A.filter(n=>{var t,i,o;return n.index.includes(e)||n.position.positionId.includes(e)||"auto-compound auto compound".includes(e)&&n.autoCompound||(null===(t=n.tokens[0].ticker)||void 0===t?void 0:t.toLowerCase().includes(e))||(null===(i=n.tokens[1].ticker)||void 0===i?void 0:i.toLowerCase().includes(e))||(n.feeTier/r.m3W+"%").startsWith(e)||(null===(o=n.statusTags)||void 0===o?void 0:o.some(n=>n.toLowerCase().includes(e.split(" ").join(""))))}):A},[A,n]),B=(0,l.useMemo)(()=>m&&(null==S?void 0:S.find(e=>e.index===m)),[S,m]);return(0,l.useEffect)(()=>{B?h():g()},[g,B,h]),(0,b.D)(t,()=>{if(m){if(!B){x(void 0);return}setTimeout(()=>{var e;null===(e=document.getElementById("Strategy-".concat(m)))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),P("details")},300)}}),(0,o.jsxs)(o.Fragment,{children:[c?s||d?(0,o.jsx)(r.KTm,{size:"100%",height:"137px"}):S.length?(0,o.jsx)(el,{drawerOpen:p,children:S.map(e=>{let{position:n,...t}=e;return(0,l.createElement)(r.Biw,{...t,onClick:()=>{x(t.index)},selected:t.index===m,key:t.index})})}):(0,o.jsx)(_.cs,{children:"Your active strategies will appear here."}):(0,o.jsxs)(ed,{children:[(0,o.jsx)(es,{children:(0,o.jsx)(T.jY,{})}),(0,o.jsx)(ec,{children:"Connect wallet and select correct network."})]}),(0,o.jsx)(f,{children:B&&(0,o.jsx)(en,{navBack:()=>{x(void 0)},refresh:()=>i(),position:B.position,navToPage:Z})})]})},ea=(e,n)=>{let{position:t,strategy:i}=e,o=(null==i?void 0:i.history[0])||(null==i?void 0:i.current[0]),r=(null==i?void 0:i.current[0])||(null==i?void 0:i.executed)>0&&(null==i?void 0:i.history[i.executed-1]),l=null==r?void 0:r.action,s=[t.tokenA,t.tokenB],{feeCollectedToken0UsdValue:d=0,feeCollectedToken1UsdValue:c=0}=(null==i?void 0:i.feeCollected)||{},u=P().add("-"===t.feeAmount?"0":t.feeAmount,d+c),a=(0,y._)(t.minPrice,t.maxPrice);return{index:null==l?void 0:l.strategyId,tokens:s,feeTier:t.feeTier,rebalancesExecuted:null==i?void 0:i.executed,revenueEarned:u,createdTime:o.creation,priceRange:a,liquidity:t.liquidity,fees:t.feeAmount,autoCompound:t.autoCompound,statusTags:!n||r.lastFailedMessage?["rebalanceFailed"]:[],position:t}};var ef=t(5632);function ep(){let e=(0,i.Z)(["\n  max-width: 1080px;\n  margin-top: 20px;\n  align-items: ",";\n"]);return ep=function(){return e},e}function eh(){let e=(0,i.Z)(["\n  width: 100%;\n  gap: ",";\n  max-width: ",";\n"]);return eh=function(){return e},e}function eg(){let e=(0,i.Z)(['\n  font-family: "Dunbar Tall";\n  display: flex;\n  align-items: center;\n  font-weight: 500;\n  margin-bottom: 0;\n  color: ',";\n"]);return eg=function(){return e},e}function em(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: ",";\n  gap: ",";\n  justify-content: space-between;\n"]);return em=function(){return e},e}function ex(){let e=(0,i.Z)(["\n  display: flex;\n  width: ",";\n  margin: auto 0;\n  gap: ",";\n"]);return ex=function(){return e},e}function ew(){let e=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  gap: ",";\n"]);return ew=function(){return e},e}function ev(){let e=(0,i.Z)(["\n  min-width: 158px;\n  height: 42px;\n  gap: ",";\n  color: ",";\n"]);return ev=function(){return e},e}let eC=(0,A.ZP)(_._z).withConfig({componentId:"sc-85897102-0"})(ep(),e=>{let{drawerOpen:n}=e;return n?"flex-end":"center"}),ej=(0,A.ZP)(r.tuJ).withConfig({componentId:"sc-85897102-1"})(eh(),e=>{let{theme:n}=e;return n.spacing.xl},e=>{let{drawerOpen:n}=e;return n?r.FsO:"100%"}),ek=(0,A.ZP)(r.iHY).withConfig({componentId:"sc-85897102-2"})(eg(),e=>{let{theme:n}=e;return n.colors.global.text.T1}),eb=A.ZP.div.withConfig({componentId:"sc-85897102-3"})(em(),e=>{let{drawerOpen:n}=e;return n?"column":"row"},e=>{let{theme:n,drawerOpen:t}=e;return t?n.spacing.xl:0}),eI=A.ZP.div.withConfig({componentId:"sc-85897102-4"})(ex(),e=>{let{drawerOpen:n}=e;return n?"100%":"auto"},e=>{let{theme:n}=e;return n.spacing.lg}),ey=A.ZP.div.withConfig({componentId:"sc-85897102-5"})(ew(),e=>{let{theme:n}=e;return n.spacing.md}),eT=(0,A.ZP)(r.Yd2).withConfig({componentId:"sc-85897102-6"})(ev(),e=>{let{theme:n}=e;return n.spacing.md},e=>{let{theme:n}=e;return n.colors.global.textAlt.T1}),eZ=()=>{let e=(0,A.Fg)(),{setPosition:n}=(0,u.q)(),{drawerOpen:t}=(0,r.yT4)(),{amm:i,network:s}=(0,c.L)(),{isReady:f}=(0,a.O)(),p=(0,ef.useRouter)(),[h,g]=(0,l.useState)(""),{ref:m,sm:x}=function(e){let{drawerOpen:n,intentDrawerOpen:t}=(0,r.yT4)(),i=(0,l.useRef)(null),[o,s]=(0,l.useState)(!1);return(0,r.YBt)(()=>{function e(){i.current&&s(i.current.offsetWidth<775)}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[n,t]),{ref:i,sm:o}}(0);return(0,o.jsx)(eC,{drawerOpen:t,children:(0,o.jsxs)(ej,{drawerOpen:t,children:[(0,o.jsxs)(eb,{ref:m,sm:x,drawerOpen:t,children:[(0,o.jsx)(eI,{drawerOpen:t,children:(0,o.jsxs)(ek,{children:["Recurring Rebalance ",(0,o.jsx)("br",{}),"Strategies"]})}),(0,o.jsxs)(eI,{drawerOpen:t,children:[(0,o.jsx)(r.MjL,{width:192,placeholder:"Search Strategy",onChange:e=>g(e.trim())}),(0,o.jsxs)(eT,{color:"primary",onClick:()=>{n(null),p.push("/recurring-rebalance/create")},disabled:!f,children:[(0,o.jsx)(T.dt,{width:16,height:16,fill:e.colors.global.textAlt.T1}),(0,o.jsx)(r.Bpc,{fontSize:"14px",children:"New Strategy"})]})]})]}),(0,o.jsxs)(ey,{children:[f?(0,o.jsxs)(_.s0,{children:[(0,o.jsx)(r.VOW,{amm:i,chainId:s}),(0,o.jsx)(d,{})]}):null,(0,o.jsx)(eu,{searchKeyword:h})]})]})})};var eP=eZ}},function(e){e.O(0,[9458,2467,2089,7183,4965,4455,1625,2888,179],function(){return e(e.s=66563)}),_N_E=e.O()}]);
//# sourceMappingURL=recurring-rebalance-325abbe8a2f681ae.js.map